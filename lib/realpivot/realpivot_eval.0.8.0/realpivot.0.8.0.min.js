/*!
* RealPivot Product v0.8.0.1057
* Copyright (C) 2013-20015 WooriTech Inc.
* All Rights Reserved.
*/
var RealPivotClass=function(a){function b(){$&&$.apply(Z,arguments)}function c(){X&&$&&$.apply(Z,arguments)}function d(){return(new Date).getTime()-_}function e(a){this.message=Y?a:"[RealPivot Assert error] "+a}function f(a){return a!==va&&null!==a}function g(a){return null===a?!1:"object"==typeof a}function h(a){return"string"==typeof a}function j(a){return a=parseInt(a),isNaN(a)?0:a}function k(a){return Array.isArray?Array.isArray(a):"[object Array]"===toString.call(a)}function m(a){return k(a)&&a.length>0}function n(a,b){if(!k(a)||!k(b))return!1;var c=a.length;if(b.length!=c)return!1;for(var d=0;c>d;d++)if("object"==typeof a[d]&&"object"==typeof b[d]){if(!o(a[d],b[d]))return!1}else if(a[d]!=b[d])return!1;return!0}function o(a,b){for(attr in a){if(!b||!b.hasOwnProperty(attr))return!1;if(a[attr]!==b[attr])return!1}for(attr in b){if(!a||!a.hasOwnProperty(attr))return!1;if(b[attr]!==a[attr])return!1}return!0}function p(a,b,c){for(attr in a)if(attr!=c){if(!b.hasOwnProperty(attr))return!1;if(a[attr]!==b[attr])return!1}for(attr in b)if(attr!=c){if(!a.hasOwnProperty(attr))return!1;if(b[attr]!==a[attr])return!1}return!0}function q(a,b,c){for(var d=0,e=a.length;e>d;d++)if(a[d][b]===c)return d;return-1}function s(a,b,c){return b=Math.max(b||2,1),c=c||0,new Array(b-String(a).length+1).join(c)+a}function t(a,b,c){b=Math.max(b||2,1),c=c||0;var d=a.toString(16);return new Array(b-d.toString(16).length+1).join(c)+d}function u(a,b){return a!==va&&null!==a?parseInt(a,b||10):0}function v(a){return a&&"[object Date]"===Object.prototype.toString.call(a)}function w(a){return k(a)?a:defined(a)?[a]:null}function z(a){return/\s/.test(a)}function A(a){return a?a.trim():null}function B(a){a.preventDefault?(a.preventDefault(),a.stopPropagation()):a.returnValue=!1}function C(a){return a.charAt(0).toUpperCase()+a.substr(1)}function D(a){var b=new a.constructor;for(var c in a)b[c]=a[c];return b}function E(a){a=a||{};for(var b=1,c=arguments.length;c>b;b++){var d=arguments[b];if(d)for(var e in d)a[e]=d[e]}return a}function F(a){var b=null;try{b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a)}catch(c){if(b)throw c;b=(new DOMParser).parseFromString(a,"text/xml")}return b}function G(a){if(a)try{return(new XMLSerializer).serializeToString(a)}catch(b){return a.xml}}function H(a,b,c){a.setAttribute(b,c)}function I(a,b,c,d,e){var f=a.createElement(c);return d&&f.setAttribute(d,e),b.appendChild(f),f}function J(a,b){return a==b?!0:0===a.indexOf("*")?(a=a.substr(1,a.length-1),b.substr(b.indexOf(a),a.length)==a):!1}function K(a,b){var c=[];c=a.split(",");for(var d=0,e=c.length;e>d;d++)if(J(c[d],b))return!0;return!1}function L(a){for(var b="",c=0,d=a.length;d>c;c++)b+=String.fromCharCode(a[c]>>1);return b}function M(a){for(var b=blowfish.decrypt(a,me+L([202,218,204,100]),{outputType:0,cipherMode:0}),c={},d=b.split(";"),e=0,f=d.length;f>e;e++){var g=d[e].split("="),h=g[0],i=g[1];i&&i.length>0&&(c[h]=i)}return c}function N(){throw new Error("Not supported Function.caller")}function O(a){if(k(a)){for(var b=[],c=0,d=a.length;d>c;c++)b.push(O(a[c]));return b}return"function"==typeof a.proxy?a.proxy():a}function P(a){return Object.freeze?Object.freeze(a):a}function Q(a,b){this.message=a,this.tokenPos=b}function R(a){this.message=a}function S(a){var b=(""+a).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return b?Math.max(0,(b[1]?b[1].length:0)-(b[2]?+b[2]:0)):0}var T=a||window,U=a&&a.document||document,V="0.8.0.1057",W=function(){return V},X=!1,Y=!1,Z=window.console,$=Z&&"function"==typeof Z.log?Function.prototype.bind.call(Z.log,Z):va,_=(new Date).getTime(),aa=c;e.prototype=new Error,e.prototype.constructor=e;var ba=function(a,b){if(!a)throw new e(b)};Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e}),String.prototype.trim||!function(){var a=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(a,"")}}(),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c;if(null==this)throw new TypeError('"this" is null or not defined');var d=Object(this),e=d.length>>>0;if(0===e)return-1;var f=+b||0;if(Math.abs(f)===1/0&&(f=0),f>=e)return-1;for(c=Math.max(f>=0?f:e-Math.abs(f),0);e>c;){if(c in d&&d[c]===a)return c;c++}return-1}),Array.prototype.filter||(Array.prototype.filter=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments.length>=2?arguments[1]:void 0,f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),function(){var a=0;window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f})}();var ca=function(){this._values={},this._keys={}};ca.prototype={constructor:ca,containsKey:function(a){return a&&this._values.hasOwnProperty(a.$_hash)},isEmpty:function(){for(var a in this._values)return!1;return!0},set:function(a,b){if(!a||!a.$_hash)throw"Invalid key";this._values[a.$_hash]=b,this._keys[a.$_hash]=a},unset:function(a){return a&&this._values.hasOwnProperty(a.$_hash)?(delete this._values[a.$_hash],delete this._keys[a.$_hash],!0):!1},clear:function(){this._values={},this._keys={}},get:function(a){return a?this._values[a.$_hash]:void 0},keys:function(){var a=[];for(var b in this._values)a.push(this._keys[b]);return a},values:function(){var a=[];for(var b in this._values)a.push(this._values[b]);return a},each:function(a){for(var b in this._values)a.call(null,this._keys[b],this._values[b])},checkTrue:function(a){for(var b in this._values)if(a.call(null,this._keys[b],this._values[b]))return!0;return!1},checkFalse:function(a){for(var b in this._values)if(!a.call(null,this._keys[b],this._values[b]))return!0;return!1}};var da=Math.pow(2,53)-1,ea=k,fa=s,ga=(window.RG_CONST&&window.RG_CONST.WEEKDAYS?window.RG_CONST.WEEKDAYS:["일","월","화","수","목","금","토"],w),ha=A,ia=Math.floor,ja=Math.floor,ka=Math.round,la=(Math.ceil,Math.min),ma=Math.max,na=Math.abs,oa=navigator.platform.toUpperCase().indexOf("MAC")>=0,pa=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,qa="undefined"!=typeof InstallTrigger,ra=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,sa=(!!window.chrome&&!pa,!!document.documentMode,navigator.userAgent.toLowerCase().indexOf("edge/")>=0,function(){for(var a,b=3,c=document.createElement("div"),d=c.getElementsByTagName("i");c.innerHTML="<!--[if gt IE "+ ++b+"]><i></i><![endif]-->",d[0];);return b>4?b:a}()),ta=void 0!==sa&&9>=sa,ua=!1;-1!==navigator.appVersion.indexOf("MSIE 10"),-1!==navigator.appVersion.indexOf("MSIE 9");!function(){var a,b=document.createElement("div"),c=!1;try{a=b.getBoundingClientRect()}catch(d){c=!0}c||isNaN(a.width)?Element.prototype.getBoundingClientRect2=function(){var a=Element.prototype.getBoundingClientRect.call(this);return{left:a.left,right:a.right,width:a.right-a.left,top:a.top,bottom:a.bottom,height:a.bottom-a.top}}:Element.prototype.getBoundingClientRect2=Element.prototype.getBoundingClientRect;try{b.style.background="rgba(0, 0, 0, 1)"}catch(d){ua=!0}}(),Object.defineProperty&&Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(Element.prototype,"textContent")&&!Object.getOwnPropertyDescriptor(Element.prototype,"textContent").get&&!function(){var a=Object.getOwnPropertyDescriptor(Element.prototype,"innerText");Object.defineProperty(Element.prototype,"textContent",{get:function(){return a.get.call(this)},set:function(b){return a.set.call(this,b)}})}();var va,wa=function(a,b,c){return b==c?0:b>c?1:-1},xa={freeAndNull:function(a){a&&(a.destroy(),a=null)},sortLabels:function(a,b,c,d,e,f){var g,h,i,j,k,l;do{g=e,h=f,i=ia((e+f)/2),j=i;do{if(c){for(;h>=g&&(k=g,l=d(b,a[j]._value,a[k]._value),0==l&&(l=j-k),!(0>=l));)g++;for(;h>=g&&(k=h,l=d(b,a[j]._value,a[k]._value),0==l&&(l=j-k),!(l>=0));)h--}else{for(;h>=g&&(k=g,l=d(b,a[j]._value,a[k]._value),0==l&&(l=k-j),!(l>=0));)g++;for(;h>=g&&(k=h,l=d(b,a[j]._value,a[k]._value),0==l&&(l=k-j),!(0>=l));)h--}if(h>=g){if(g!=h){var m=a[g];a[g]=a[h],a[h]=m}g++,h--}}while(h>=g);h>e&&this.sortLabels(a,b,c,d,e,h),e=g}while(f>e)},sortValues:function(a,b,c,d,e,f){var g,h,i,j,k,l;do{g=e,h=f,i=ia((e+f)/2),j=i;do{if(c){for(;h>=g&&(k=g,l=d(b,a[j]._value.value,a[k]._value.value),0==l&&(l=j-k),!(0>=l));)g++;for(;h>=g&&(k=h,l=d(b,a[j]._value.value,a[k]._value.value),0==l&&(l=j-k),!(l>=0));)h--}else{for(;h>=g&&(k=g,l=d(b,a[j]._value.value,a[k]._value.value),0==l&&(l=k-j),!(l>=0));)g++;for(;h>=g&&(k=h,l=d(b,a[j]._value.value,a[k]._value.value),0==l&&(l=k-j),!(0>=l));)h--}if(h>=g){if(g!=h){var m=a[g];a[g]=a[h],a[h]=m}g++,h--}}while(h>=g);h>e&&this.sortValues(a,b,c,d,e,h),e=g}while(f>e)},asyncLoop:function(a,b,c,d,e,f){for(var g=a;b>=g&&!(g>=a+c);g++)e(g);b>g&&(f(g-a),setTimeout(function(){xa.asyncLoop(g,b,c,d,e,f)}.bind(d)))},splitEscape:function(a,b){if(a){var c=[],d=!1,e="";b=b||",";for(var f=0;f<a.length;f++){var g=a[f];g!=b||d?(" "!=g||d)&&(e+=g):(c.push(e),e=""),"("==g&&(d=!0),")"==g&&(d=!1)}return e&&c.push(e),c}return null},removeTags:function(a){return a?a.replace(/<\/?[^>]+(>|$)/g,""):a}},ya=/\r|\n|\r\n/,da=(Math.PI,2*Math.PI,Math.pow(2,53)-1),za=-1,Aa="px",Ba={PRODUCT:"RealPivot",TYPE:"Enterprise",VERSION:"v1.0",toString:function(){return this.PRODUCT+" "+this.VERSION+" "+this.TYPE}},Ca=function(){var a,b=location.hostname;try{a=realPivotLic}catch(c){return!1}if(!a)return!1;var d=M(a);if(d.name!=Ba.PRODUCT)return!1;var e=d.vender?d.vender:null,f=Ba.VENDOR?Ba.VENDOR:null;if(e!=f)return!1;var g=d.server.toLowerCase();if("Developer"!=Ba.TYPE&&!K(g,b.toLowerCase()))return!1;if(licType=d.lic.toLowerCase(),"limited"!=licType&&d.lic!=Ba.TYPE)return!1;if("evaluation"==licType||"asp"==licType||"limited"==licType){var h=d.expire.split("."),i=new Date(h[0],h[1],h[2],23,59,59,999);if(new Date>i)return!1}return!0},Da=function(a){this.defaultValue=a},Ea=(new Da(0),{}),Fa=function(){};Fa.$_hash=0;var Ga=function(a,b,c,d,e){if(null!==b&&"function"!=typeof b)throw"Base class is not a function";var f,g,h,i,j,k,l=function(){arguments[0]!==Ea&&(this.$inited=!1,this.init&&this.init.apply(this,arguments),this.$inited=!0)},m=l.prototype=b?new b(Ea):new Fa(Ea),n=null;if(m.constructor=l,m.$base=b?b.prototype:Fa.prototype,m.$name=a,c){var o={},p=l.$inits={};for(n in c)f=c[n],"function"==typeof f?(f.$name=n,f.$owner=m,m[n]=f):(f&&f.init&&(f=f.init),o[n]=f);l.$attrs={};for(n in o)f=c[n],a=C(n),g="boolean"==typeof f?"is"+a:n,i="set"+a,k=n+"PropChanged",j=null,h=n+"_",m.hasOwnProperty(h)?(j=m[h],delete m[h]):f&&f.get?j=f.get:m.hasOwnProperty(g)||(j=function(a){return function(){return this["_"+a]}}(n)),j&&(j.$name=g,j.$owner=m,m[g]=j),j=null,f&&f.set?j=f.set:m.hasOwnProperty(i)||(j=f instanceof Da?function(a,b){return function(c){var d;return c=parseInt(c),!isNaN(c)&&m[b]&&(d=m[b].call(this))!=c&&(this["_"+a]=c,this.$inited&&(this[k]?this[k].call(this,a,d,c):this.propertyChanged(a,d,c))),this}}(n,g):function(a,b){return function(c){var d;return m[b]&&(d=m[b].call(this))!=c&&(this["_"+a]=c,this.$inited&&(this[k]?this[k].call(this,a,d,c):this.propertyChanged(a,d,c))),this}}(n,g)),j&&(j.$name=i,j.$owner=m,m[i]=j),f&&(f instanceof Da?o[n]=f.defaultValue:"function"==typeof f.init?p[n]=f.init:f.hasOwnProperty("value")&&(o[n]=f.value)),l.$attrs[n]={field:"_"+n,value:o[n],get:m[g],set:m[i]}}if(d)for(n in d)l[n]=d[n];return"function"==typeof e&&e.call(l,l),l};Fa.prototype.constructor=Fa,Fa.prototype.init=function(a){!a&&(this.$_hash=String(++Fa.$_hash));for(var b=this.constructor;b;){var c=b.$inits,d=b.$attrs;if(d)for(var e in d){var f=c[e],g=d[e];f=f?f.call(this):g.value,this[g.field]=f}b=b.prototype.$base&&b.prototype.$base.constructor}};Fa.prototype;Fa.prototype._super=function(){var a,b=this._super.caller;if(b){if(a=b.$owner.$base[b.$name])return a.apply(this,arguments)}else N()},Fa.prototype._inherit=function(a){this.constructor.prototype.$base[a].apply(this,Array.prototype.slice.call(arguments,1))},Fa.prototype.className=function(){return this.constructor.prototype.$name},Fa.prototype.baseClass=function(){return this.constructor.prototype.$base},Fa.prototype.baseClassName=function(){var a=this.constructor.prototype.$base;return a&&a.$name},Fa.prototype.clone=function(){var a,b=this.constructor,c=new b,d=b.$attrs;for(var e in d)a=d[e],c[a.field]=this[a.field];return c},Fa.prototype.propertyChanged=function(a,b,c){},Fa.prototype.getAttr=function(a){for(var b=this.constructor;b;){var c=b.$attrs;if(c&&a in c)return c[a];b=b.prototype.$base&&b.prototype.$base.constructor}return null},Fa.prototype.getProperty=function(a){var b=this.getAttr(a),c=b?b.get?b.get.call(this):b:va;return c},Fa.prototype.setProperty=function(a,b){var c=this.getAttr(a);c&&c.set&&c.set.call(this,b)},Fa.prototype._initProps=function(a){if(a)for(var b in a){var c="_"+b;this.hasOwnProperty(c)&&(this[c]=a[b])}},Fa.prototype.assign=function(a){if(a instanceof Fa){if(a!==this)for(var b=a.constructor;b;){var c=b.$attrs;for(var d in c){var e=this.getAttr(d);if(e&&e.set&&(h=c[d],h.get)){var f=h.get.call(a);e.set.call(this,f)}}b=b.prototype.$base&&b.prototype.$base.constructor}}else if(g(a)){if(a!==this)for(var d in a)if(a[d]!==va){var h=this.getAttr(d);h&&h.set&&h.set.call(this,a[d])}}else this.assignSimple(a)},Fa.prototype.assignSimple=function(a){},Fa.prototype.assignProps=function(a,b){if(a&&a!==this&&b)for(var c=0,d=b.length;d>c;c++){var e=b[c];if(a.hasOwnProperty(e)){var f=this.getAttr(e);f&&f.set&&f.set.call(this,a[e])}}},Fa.prototype.proxy=function(){for(var a,b,c,d={},e=this.constructor;e;){a=e.$attrs;for(var f in a)b=a[f],b.get&&(c=b.get.call(this),c&&c.noProxy||(c&&(c=O(c)),d[f]=c));e=e.prototype.$base&&e.prototype.$base.constructor}return d.$_hash=this.$_hash,d},Fa.prototype.as=function(a){return this instanceof a?this:null};var Ha=function(){var a=arguments.callee.caller;throw Errors.NOT_YET_IMPLEMENTED+": "+a.$owner.$name+"::"+a.$name},Ia=Ha,Ja=function(a,b){return a instanceof b?a:null},Ka=Ga(null,null,{init:function(a){this._super(a),this._listeners=[]},destroy:function(){for(var a=this._listeners.length;a--;)this._listeners[a]=null;this._listeners=null},addListener:function(a,b){return a&&this._listeners.indexOf(a)<0&&(void 0!=b&&b>za?this._listeners.splice(b,0,a):this._listeners.push(a)),this},removeListener:function(a){var b;return a&&(b=this._listeners.indexOf(a))>za&&this._listeners.splice(b,1),this},fireEvent:function(a){var b,c,d,e=this._listeners.length,f=Array.prototype.slice.call(arguments,0);for(f[0]=this,b=0;e>b;b++)c=this._listeners[b],d=c[a],d&&d.apply(c,f)},fireConfirmEvent:function(a){var b,c,d,e=this._listeners.length,f=Array.prototype.slice.call(arguments,0);for(f[0]=this,b=0;e>b;b++)if(c=this._listeners[b],d=c[a]){var g=d.apply(c,f);if("boolean"==typeof g&&!g)return!1}return!0},fireMessageEvent:function(a){var b,c,d,e=this._listeners.length,f=Array.prototype.slice.call(arguments,0);for(f[0]=this,b=0;e>b;b++)if(c=this._listeners[b],d=c[a]){var g=d.apply(c,f);if("string"==typeof g&&g)return g}return null},fireObjectEvent:function(a){var b,c,d,e=this._listeners.length,f=Array.prototype.slice.call(arguments,0);for(f[0]=this,b=0;e>b;b++)if(c=this._listeners[b],d=c[a]){var g=d.apply(c,f);if(g)return g}return null}}),La=(Ka.prototype,Ga("VisualElement",Ka,{init:function(){this._super(),this._parent=null,this._parentElement=null,this._container=null,this._childs=[],this._dirty=!1,this._mouseEnabled=!0,this._isContainer=!1,this._hovered=!1,this._mask=null,this._spaceWidth=0,this._spaceHeight=0,this._childFixed=!1,this._element=U.createElement("div"),this._css=this._element.style},destroy:function(){for(var a=this._childs.length;a--;)xa.freeAndNull(this._childs[a]);this._childs=null,this._mask&&this._mask.destroy(),this._mask=null,this._parent=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null,this._super()},left:-1,top:-1,width:0,height:0,visible:!0,cssClass:function(){return this._element.className},setCssClass:function(a){a!=this._element.className&&(this._element.className=a)},setLeft:function(a){a!=this._left&&(this._left=a,this._css.left=a+Aa)},setTop:function(a){a!=this._top&&(this._top=a,this._css.top=a+Aa)},setWidth:function(a){a=Math.max(0,a),a!=this._width&&(this._width=a,this._css.width=a-this._spaceWidth+Aa)},setHeight:function(a){a=Math.max(0,a),a!=this._height&&(this._height=a,this._css.height=a-this._spaceHeight+Aa)},setSpace:function(a,b){this._spaceWidth=a,this._spaceHeight=b},setVisible:function(a){a!=this._visible&&(this._visible=a,a?this._css.removeProperty("display"):this._css.display="none")},container:function(){return this._parent&&this._parent.container()},parent:function(){return this._parent},setParent:function(a){this._parent=a,a&&a._container&&(this._container=a._container)},childCount:function(){return this._childs?this._childs.length:0},isSingleton:function(){return 1==this._parent.childCount()},mouseX:function(){var a=this._container;if(a){for(var b=a._currentX,c=this;c&&c!==va;)b-=c._left,c=c._parent;return b}return NaN},mouseY:function(){var a=this._container;if(a){for(var b=a._currentY,c=this;c&&c!==va;)b-=c._top,c=c._parent;return b}return NaN},mask:function(){return this._mask},setMask:function(a){this._mask=a?a.clone():null},isLayer:function(){return!1},isClickable:function(){return!1},setMouseEnabled:function(a){this._mouseEnabled=a},canHover:function(){return!0},isHovered:function(){return this._hovered},setHovered:function(a){a!=this._hovered&&(this._hovered=a)},getChildren:function(){return this._childs&&this._childs.concat()},getChild:function(a){return this._childs?this._childs[a]:null},getChildIndex:function(a){return this._childs?this._childs.indexOf(a):-1},contains:function(a){return this._childs?this._childs.indexOf(a)>za:!1},_calcOuterSpace:function(a){var a=getComputedStyle(this._element,null);this._spaceWidth=j(a.getPropertyValue("border-left-width"))+j(a.getPropertyValue("border-right-width"))+j(a.getPropertyValue("padding-left"))+j(a.getPropertyValue("padding-right"))+j(a.getPropertyValue("margin-left"))+j(a.getPropertyValue("margin-right")),this._spaceHeight=j(a.getPropertyValue("border-top-width"))+j(a.getPropertyValue("border-bottom-width"))+j(a.getPropertyValue("padding-top"))+j(a.getPropertyValue("padding-bottom"))+j(a.getPropertyValue("margin-top"))+j(a.getPropertyValue("margin-bottom"))},setParentElement:function(a){this._parentElement=a},addChild:function(a,b){a instanceof La&&!this.contains(a)&&(this._childs||(this._childs=[]),b?b.appendChild(a._element):this._element&&this._element.appendChild(a._element),this._childs.push(a),a.setParentElement(b||this._element),a.setParent(this))},insertChildAt:function(a,b){b<this._childs.length?a instanceof La&&!this.contains(a)&&(this._childs||(this._childs=[]),this._element.insertBefore(a._element,this._childs[b]._element),this._childs.splice(2,0,a)):this.addChild(a)},moveChildTo:function(a,b){if(b>=-1&&b<this._childs.length){var c=this._childs.indexOf(a);if(c!=b){if(this._element.removeChild(a._element),-1==b)this._element.appendChild(a._element);else{var d=this._childs[b]._element;this._element.insertBefore(a._element,d)}this._childs.splice(b,0,this._childs.splice(c,1)[0])}}},removeChild:function(a){if(a&&this._childs){var b=this._childs.indexOf(a);if(b>za)return this.removeChildAt(b)}return null},removeChildAt:function(a){if(a>za&&a<this.childCount()){var b=this._childs[a];this._element&&b._element&&this._element.removeChild(b._element),b._parnet=null,this._childs.splice(a,1)}},clear:function(){var a,b=this._childs,c=b?b.length:0;if(!this._childFixed&&c>0){for(a=0;c>a;a++)b[a].destroy();this._childs=[]}},right:function(){return this._left+this._width},bottom:function(){return this._top+this._height},position:function(){return{x:this._left,y:this._top}},bounds:function(){return new Sb(this._left,this._top,this._width,this._height)},clientRect:function(){return new Sb(0,0,this._width,this._height)},getBounds:function(a){return a?a.set(this._left,this._top,this._width,this._height):new Sb(this._left,this._top,this._width,this._height)},getClientRect:function(a){return a?a.set(0,0,this._width,this._height):new Sb(0,0,this._width,this._height)},containsInBounds:function(a,b){return a>=this._left&&a<this.right()&&b>=this._top&&b<this.bottom()},containsInClient:function(a,b){return a>za&&a<this._width&&b>za&&b<this._height},translateBy:function(a,b){var c=a;for(b||(b=new Sb(0,0,this._width,this._height));c&&c!==this;)b.x-=c._left,b.y-=c._top,c=c._parent;return b},topBy:function(a,b){for(var c=this._top+b,d=this._parent;d&&d!==a;)c+=d._top,d=d._parent;return c},boundsBy:function(a,b){var c=this._left,d=this._top,e=this._parent;for(b&&(c+=b.x,d+=b.y);e&&e!==a;)c+=e._left,d+=e._top,e=e._parent;return b?new Sb(c,d,b.width,b.height):new Sb(c,d,this._width,this._height)},boundsByContainer:function(a){var b=this._left,c=this._top;a&&(b+=a.x,c+=a.y);for(var d=this._parent;d&&d._left!==va;)b+=d._left,c+=d._top,d=d._parent;return a?new Sb(b,c,a.width,a.height):new Sb(b,c,this._width,this._height)},boundsByScreen:function(a){return a=this.boundsByContainer(a),a=this.container().toScreen(a)},move:function(a,b){this.setLeft(a),this.setTop(b)},offset:function(a,b){this.setLeft(this._left+a),this.setTop(this._top+b)},inflate:function(a,b){0!=a&&this.setWidth(this.width()+a),0!=b&&this.setHeight(this.height()+b)},shift:function(a,b){a&&(this.setLeft(this._left+a),this.setWidth(this._width-a)),b&&(this.setTop(this._top+b),this.setHeight(this._height-b))},resize:function(a,b){this.setWidth(a),this.setHeight(b)},setSize:function(a,b){this.setWidth(a),this.setHeight(b)},setPosition:function(a,b){this.setLeft(a),this.setTop(b)},setBounds:function(a,b,c,d,e,f){arguments.length>4&&(this._spaceWidth=e,this._spaceHeight=f),this.setLeft(a),this.setTop(b),this.setWidth(c),this.setHeight(d)},setBoundsI:function(a,b,c,d){this.setLeft(a>>0),this.setTop(b>>0),this.setWidth(c>>0),this.setHeight(d>>0)},setRect:function(a){this.setLeft(a.x),this.setTop(a.y),this.setWidth(a.width),this.setHeight(a.height)},setRectI:function(a){this.setLeft(ia(a.x)),this.setTop(ia(a.y)),this.setWidth(ia(a.width)),this.setHeight(ia(a.height))},layoutContent:function(a){this._doLayoutContent(a)},draw:function(){this._doDraw()},_doLayoutContent:function(a){},_doDraw:function(){this._doRender(this.clientRect())},_doRender:function(){},hitTest:function(a,b){return a>za&&b>za&&a<this._width&&b<this._height},clientToContainer:function(a,b){for(var c=this;c;)a+=c._left,b+=c._top,c=c._parent;return{x:a,y:b}},containerToClient:function(a,b){for(var c=this;c;)a-=c._left,b-=c._top,c=c._parent;return{x:a,y:b}},findChildAt:function(a,b,c){var d,e,f,g=this._childs,h=g?g.length:0;if(h>0)for(d=h-1;d>=0;d--)if(e=g[d],e.isVisible()&&(c||e._mouseEnabled)){var i,j,k=e._left,l=e._top;if("absolute"!=e._css.position){var m=e._element.getBoundingClientRect(),n=this._element.getBoundingClientRect();k=m.left-n.left,l=m.top-n.top,i=m.width,j=m.height}if(cx=a-k,cy=b-l,e.isLayer()||cx<i&&cy<j||e.hitTest(cx,cy)){if(f=e.findChildAt(cx,cy,c))return f;if(!e.isLayer()&&e._mouseEnabled&&!e._isContainer)return e}}return null},$_prepareSpan:function(){return this._span||(this._span=document.createElement("span"),this._span.className=this.cssClass(),this._element.appendChild(this._span)),this._span}})),Ma=(La.prototype,Ga("OverflowContainer",La,{init:function(){this._super(),this._isContainer=!0,this._css.position="absolute",this._css.overflow="hidden",this._css.pointerEvents="none",this._css.zIndex=-1,this._css.whiteSpace="nowrap"},destroy:function(){this._super()}})),Na=Ga("PivotElement",La,{init:function(a,b){this._super(),this._css.position="absolute",this._drawRect=new Sb,this._grid=a,this._options=a.tmpDisplayOptions(),this._cellSpaceWidth=this._options.cellSpaceWidth(),this._cellSpaceHeight=this._options.cellSpaceHeight(),this.setCssClass(b)},destroy:function(){this._drawRect=null,this._grid=null,this._super()},grid:function(){return this._grid},_doDraw:function(){this.getClientRect(this._drawRect),this._doRender(this._drawRect)},_doLayoutContent:function(a){this._layoutCells(a)},_layoutCells:function(a){this._clearCells()},_doRender:function(a){},_clearCells:function(){for(var a=this._childs.length;a--;)this._childs[a].destroy(),delete this._childs[a];this._childs=[]}}),Oa=Ga("ClickableElement",Na,{init:function(a,b){this._super(a,b),this._request=null,this._tracker=null},destroy:function(){xa.freeAndNull(this._request),xa.freeAndNull(this._tracker),this._super()},enabled:!0,clickable:!0,rightClickable:!1,draggable:!1,click:function(a,b){this._enabled&&this._clickable&&this._doClick(a,b)},rightClick:function(){this._enabled&&this._rightClickable&&this._doRightClick(x,y)},getRequest:function(){return null},getTracker:function(){return null},_doClick:function(a,b){},_doRightClick:function(a,b){}}),Pa=Ga("CellIndex",null,{init:function(a,b,c,d){this._super(),this._grid=a,this._columns=b,this._rows=c,this._valueField=d},destroy:function(){this._grid=null,this._columns=null,this._rows=null,this._super()},valueField:null,grid:function(){return this._grid},columns:function(){return this._columns},rows:function(){return this._rows},setColumns:function(a){a?this._columns=D(a):this._columns=null},setRows:function(a){a?this._rows=D(a):this._rows=null}},{ATTR_ISSUM:"__sum",ATTR_VFIELD:"$valueField",$_temp:null,temp:function(a,b,c,d){return Pa.$_temp._grid=a,Pa.$_temp._columns=column,Pa.$_temp._rows=c,Pa.$_temp._valueField=d,Pa.$_temp},areEquals:function(a,b){return a&&b&&a._grid===b._grid&&a._valueField==b._valueField&&o(a._columns,b._columns)&&o(a._rows,b._column)}},function(a){a.$_temp=new a});Q.prototype=new Error,Q.prototype.constructor=Q,R.prototype=new Error,R.prototype.constructor=R;var Qa=function(){for(var a=[],b=0;b<arguments.length;b++)a[arguments[b]]=!0;return a},Ra={Unknown:0,Add:1,Slash:2,Star:3,Minus:4,Plus:5,Identifier:10,And:11,In:12,Not:13,Div:14,Mod:15,Shl:16,Shr:17,Or:18,Xor:19,ToStr:20,ToNum:21,ToBool:23,Length:24,LengthBin:25,Is:26,IsNot:27,BraceClose:30,BraceOpen:31,Comma:32,CRLF:33,Null:34,Defined:35,Empty:36,NaN:37,Equal:40,Greater:41,GreaterEqual:42,Lower:43,LowerEqual:44,NotEqual:45,Like:46,NotLike:47,ILike:48,NotILike:49,Match:50,NotMatch:51,IMatch:52,NotIMatch:53,String:60,StringLiteral:61,Ascii:62,FloatLiteral:63,IntegerLiteral:64,Point:65,RoundOpen:66,RoundClose:67,DotDot:68,BracketOpen:69,BracketClose:70,Space:71,Symbol:80,ToDateStr:90,ToYear:91,ToMonth:92,ToDay:93,ToHour:94};Ra.IS_CHECK=Qa(Ra.Is,Ra.IsNot),Ra.IS_RELATIVE=Qa(Ra.Equal,Ra.NotEqual,Ra.Like,Ra.NotLike,Ra.ILike,Ra.NotILike,Ra.Match,Ra.NotMatch,Ra.IMatch,Ra.NotIMatch,Ra.Greater,Ra.GreaterEqual,Ra.Lower,Ra.LowerEqual),Ra.IS_ADDITIVE=Qa(Ra.Minus,Ra.Plus,Ra.Or,Ra.Xor),Ra.IS_MULTIPLICATIVE=Qa(Ra.And,Ra.Star,Ra.Slash,Ra.Div,Ra.Mod,Ra.Shl,Ra.Shr);var Sa=function(){function a(){var a=L.charCodeAt(O);U=O,256>a?K[a]():j()}function b(){N=Ra.Symbol,O++}function c(){N=Ra.Comma,O++}function d(){N=Ra.CRLF,10==L.charCodeAt(O+1)?O+=2:O++,S++,T=O}function e(){N=Ra.CRLF,O++,S++,T=O}function f(){N=Ra.Equal,O++}function g(){"="==L.charAt(O+1)?(N=Ra.GreaterEqual,O+=2):(N=Ra.Greater,O++)}function h(){"="==L.charAt(O+1)?(N=Ra.LowerEqual,O+=2):">"==L.charAt(O+1)?(N=Ra.NotEqual,O+=2):(N=Ra.Lower,O++)}function i(){for(var a=O;M>a&&!A[L.charCodeAt(a)];)a++;for(var b=a;M>a&&A[L.charCodeAt(a)];)a++;return a>b?(R=a,L.substr(b,a-b).toLowerCase()):null}function j(){for(var a=O;M>O&&(A[L.charCodeAt(O)]||L.charCodeAt(O)>255);)O++;var b=L.substr(a,O-a).toLowerCase();if(I.hasOwnProperty(b))switch(N=I[b]){case Ra.Not:if(b=i())switch(b){case"like":N=Ra.NotLike,O=R;break;case"ilike":N=Ra.NotILike,O=R;break;case"match":N=Ra.NotMatch,O=R;break;case"imatch":N=Ra.NotIMatch,O=R}break;case Ra.Is:b=i(),"not"==b&&(N=Ra.IsNot,O=R)}else N=Ra.Identifier}function k(){for(N=Ra.IntegerLiteral,O++;M>O&&B[L.charCodeAt(O)];)O++}function l(){for(N=Ra.IntegerLiteral,O++;M>O&&C[L.charCodeAt(O)];){if("."==L.charAt(O)){if("."==L.charAt(O+1))break;N=Ra.FloatLiteral}O++}}function m(){N=Ra.Minus,O++}function n(){N=Ra.Plus,O++}function o(){var a=L.charAt(O+1);"."==a?(N=Ra.DotDot,O+=2):(N=Ra.Point,O++)}function p(){N=Ra.RoundOpen,O++}function q(){N=Ra.RoundClose,O++}function r(){N=Ra.Slash,O++}function s(){for(N=Ra.Space,O++;M>O&&D[L.charCodeAt(O)];)O++}function t(){N=Ra.BracketOpen,O++}function u(){N=Ra.BracketClose,O++}function v(){N=Ra.Star,O++}function w(){N=Ra.Mod,O++}function x(){N=Ra.StringLiteral;do{var a=L.charCodeAt(O);if(E[a])throw new Q("Untermintated string",a);a==H&&O++,O++}while(M>O&&L.charCodeAt(O)!=F);O++}function y(){N=Ra.StringLiteral;do{var a=L.charCodeAt(O);if(E[a])throw new Q("Untermintated string",a);a==H&&O++,O++}while(M>O&&L.charCodeAt(O)!=G);O++}function z(){var a;for(K=[],a=1;255>=a;a++)K[a]=b;for(a=1;32>=a;a++)K[a]=s;for(K[10]=e,K[13]=d,K["$".charCodeAt()]=k,K[F]=x,K[G]=y,a=0;9>=a;a++)K["0".charCodeAt()+a]=l;for(a="A".charCodeAt();a<="Z".charCodeAt();a++)K[a]=j;for(a="a".charCodeAt();a<="z".charCodeAt();a++)K[a]=j;K["_".charCodeAt()]=j,K["(".charCodeAt()]=p,K[")".charCodeAt()]=q,K["*".charCodeAt()]=v,K["+".charCodeAt()]=n,K[",".charCodeAt()]=c,K["-".charCodeAt()]=m,K[".".charCodeAt()]=o,K["/".charCodeAt()]=r,K["%".charCodeAt()]=w,K["<".charCodeAt()]=h,K["=".charCodeAt()]=f,K[">".charCodeAt()]=g,K["[".charCodeAt()]=t,K["]".charCodeAt()]=u}for(var A=[],B=[],C=[],D=[],E=[],F=0,G=0,H=0,I={},J=0;256>J;J++)A[J]=J=="_".charCodeAt()||J>="0".charCodeAt()&&J<="9".charCodeAt()||J>="a".charCodeAt()&&J<="z".charCodeAt()||J>="A".charCodeAt()&&J<="Z".charCodeAt(),B[J]=J>="0".charCodeAt()&&J<="9".charCodeAt()||J>="a".charCodeAt()&&J<="f".charCodeAt()||J>="A".charCodeAt()&&J<="F".charCodeAt(),C[J]=J>="0".charCodeAt()&&J<="9".charCodeAt()||J==".".charCodeAt()||J=="e".charCodeAt()||J=="E".charCodeAt(),D[J]=J>=1&&9>=J||11==J||J>=14&&32>=J,E[J]=0==J;F='"'.charCodeAt(),G="'".charCodeAt(),H="\\".charCodeAt(),I={},I.str=Ra.ToStr,I.num=Ra.ToNum,I.bool=Ra.ToBool,I.not=Ra.Not,I.len=Ra.Length,I.lenb=Ra.LengthBin,I.and=Ra.And,I["in"]=Ra.In,I.mod=Ra.Mod,I.or=Ra.Or,I.div=Ra.Div,I.shl=Ra.Shl,I.shr=Ra.Shr,I.xor=Ra.Xor,I.is=Ra.Is,I.like=Ra.Like,I.ilike=Ra.ILike,I.match=Ra.Match,I.imatch=Ra.IMatch,I.defined=Ra.Defined,I["null"]=Ra.Null,I.empty=Ra.Empty,I.nan=Ra.NaN,I.datestr=Ra.ToDateStr,I.year=Ra.ToYear,I.month=Ra.ToMonth,I.day=Ra.ToDay,I.hour=Ra.ToHour;var K=null,L=null,M=0,N=0,O=0,P=0,R=0,S=0,T=0,U=0;this.tokenId=function(){return N},this.tokenLoc=function(){return{x:U-T,y:S}},this.tokenLen=function(){return O-U},this.token=function(){return L.substr(U,this.tokenLen())},this.isSpace=function(){return N==Ra.Space},this.init=function(a){L=a,M=a.length,_origin=0,S=0,T=0,U=0,P=O=0,N=0},this.charAhread=function(){for(P=O;M>P&&L.charCodeAt(P)>0&&L.charCodeAt(P)<=32;)P++;return L.charCodeAt(this._runAhead)},this.nextId=function(b){do a();while(M>O&&N!=b)},this.nextNoSpace=function(){if(M>O)do a();while(M>O&&this.isSpace())},this.isFirstInLine=function(){if(0==U)return!0;var a,b=U;for(b--;b>0&&D[L.charCodeAt(b)];)b--;return 0==b?!0:(a=L.charCodeAt(b),10==a||13==a?!0:!1)},z()},Ta=Ga("ExpressionNode",null,{init:function(){this._super()},_asLiteral:function(){return null},evaluate:function(){Ia()},toString:function(){return String(this)}}),Ua=(Ga("EmptyExpressionNode",Ta,{init:function(){this._super()},_asLiteral:function(){return null},evaluate:function(){return void 0},toString:function(){return""}},null,function(a){a.Default=new a}),Ga("ExpressionNodeImpl",Ta,{init:function(){this._super(),this.leftExpr=null,this.rightExpr=null,this.operator=Ra.Unknown,this._literal=null},evaluate:function(a){if(this._literal)return this._literal.value();if(!this.rightExpr)return this.leftExpr.evaluate(a);
var b=this.leftExpr.evaluate(a),c=this.rightExpr.evaluate(a);switch(this.operator){case Ra.Equal:return b==c;case Ra.NotEqual:return b!=c;case Ra.Greater:return b>c;case Ra.GreaterEqual:return b>=c;case Ra.Lower:return c>b;case Ra.LowerEqual:return c>=b;case Ra.Like:return this._calcLike(b,c,!1);case Ra.NotLike:return!this._calcLike(b,c,!1);case Ra.ILike:return this._calcLike(b,c,!0);case Ra.NotILike:return!this._calcLike(b,c,!0);case Ra.Match:return this._calcMatch(b,c,!1);case Ra.NotMatch:return!this._calcMatch(b,c,!1);case Ra.IMatch:return this._calcMatch(b,c,!0);case Ra.NotIMatch:return!this._calcMatch(b,c,!0);default:throw new R("Unknown operator: "+operator)}},toString:function(){var a="";if(this._literal)a=this._literal.toString();else if(this.rightExpr){var b,c=this.leftExpr.toString(),d=this.rightExpr.toString();switch(this.operator){case Ra.Equal:b="=";break;case Ra.NotEqual:b="<>";break;case Ra.Greater:b=">";break;case Ra.GreaterEqual:b=">=";break;case Ra.Lower:b="<";break;case Ra.LowerEqual:b="<=";break;case Ra.Like:b="like";break;case Ra.NotLike:b="not like";break;case Ra.ILike:b="ilike";break;case Ra.NotILike:b="not ilike";break;case Ra.Match:b="match";break;case Ra.NotMatch:b="not match";break;case Ra.IMatch:b="imatch";break;case Ra.NotIMatch:b="not imatch";break;default:b="<<ERROR>>"}a="("+c+" "+b+" "+d+")"}else a=this.leftExpr.toString();return a},isIdentifier:function(a){return this.leftExpr&&!this.rightExpr&&this.leftExpr.isIdentifier(a)},_prepareValue:function(){this.leftExpr._prepareValue(),null==this.rightExpr?this._literal=this.leftExpr._getLiteral():this.rightExpr._prepareValue()},_getLiteral:function(){return this._literal},_calcLike:function(a,b,c){var d=String(a),e=String(b);if(d&&e){c&&(d=d.toLowerCase(),e=e.toLowerCase());var f=e.length;if(f>1){var g="%"==e.charAt(0),h="%"==e.charAt(f-1);return g&&h?(e=e.substr(1,f-2),d.indexOf(e,0)>=0):g?(e=e.substr(1,f-1),f=d.length,d.lastIndexOf(e,f-1)==f-1):h?(e=e.substr(0,f-1),0==d.indexOf(e,0)):d==e}return"%"==e?!1:d==e}return!1},_calcMatch:function(a,b,c){var d=new RegExp(b,"m"+(c?"i":""));return d.test(a)}})),Va=Ga("DefinedNode",Ta,{init:function(){this._super()}}),Wa=Ga("DefinedNode",Va,{init:function(){this._super()},value:function(){return va},_asLiteral:function(){return this},evaluate:function(a){return va},toString:function(){return"defined"}}),Xa=Ga("EmptyNode",Va,{init:function(){this._super()},value:function(){return va},_asLiteral:function(){return this},evaluate:function(a){return va},toString:function(){return"empty"}}),Ya=Ga("NullNode",Va,{init:function(){this._super()},value:function(){return va},_asLiteral:function(){return this},evaluate:function(a){return null},toString:function(){return"null"}}),Za=Ga("NanNode",Va,{init:function(){this._super()},value:function(){return NaN},_asLiteral:function(){return this},evaluate:function(a){return NaN},toString:function(){return"NaN"}}),$a=Ga("CheckNode",Ua,{init:function(a,b,c){this._super(),this.leftExpr=a,this.operator=b,this._isNot=b==Ra.IsNot,this._value=-1,c instanceof Wa?this._value=$a.DEFINED:c instanceof Ya?this._value=$a.NULL:c instanceof Xa?this._value=$a.EMPTY:c instanceof Za&&(this._value=$a.NAN)},_prepareValue:function(){this.leftExpr._prepareValue(),this._literal=this.leftExpr._getLiteral()},_getLiteral:function(){return null},evaluate:function(a){var b,c=this._literal?this._literal.value():this.leftExpr.evaluate(a);switch(this._value){case $a.DEFINED:b=c!==va;break;case $a.NULL:b=c===va||null===c;break;case $a.EMPTY:b=c===va||null===c||0==String(c).length;break;case $a.NAN:b=null===c||isNaN(c);break;default:return va}return this._isNot?!b:b},toString:function(){var a="<<ERROR>>";switch(this._value){case $a.DEFINED:a="defined";break;case $a.NULL:a="null";break;case $a.EMPTY:a="empty";break;case $a.NAN:a="NaN"}return"("+((this._isNot?"is not ":"is ")+a)+")"}},{DEFINED:0,NULL:1,EMPTY:2,NAN:3}),_a=Ga("FloatLiteralNode",Ta,{init:function(a){this._super(),this._value=Number(a)},value:function(){return this._value},_asLiteral:function(){return this},evaluate:function(a){return this._value},toString:function(){return String(this._value)}}),ab=Ga("IntegerLiteralNode",Ta,{init:function(a){this._super(),this._value=parseInt(a)},value:function(){return this._value},_asLiteral:function(){return this},evaluate:function(a){return this._value},toString:function(){return String(this._value)}}),bb=Ga("StringLiteralNode",Ta,{init:function(a){this._super(),this._value=a.substr(1,a.length-2);for(var b="",c=0,d=!1;c<this._value.length;)"\\"!=this._value[c]||d?(d=!1,b+=this._value[c++]):(d=!0,c++);this._value=b},value:function(){return this._value},_asLiteral:function(){return this},evaluate:function(a){return this._value},toString:function(){return this._value}}),cb=Ga("IdentifierNode",Ta,{init:function(a){this._super(),this._literal=a,this._idKey=-651212},identifier:function(){return this._literal},evaluate:function(a){return-651212==this._idKey&&(this._idKey=a.isIdentifier(this._literal)),a.evaluateIdentifier(this._idKey)},toString:function(){return this._literal}}),db=Ga("IndexerNode",Ta,{init:function(a,b,c){this._super(),this._ident=a,this._indexer=b,this._capital=c,this._idKey=-1490313,this._intIndex=NaN,this._strIndex=null},_prepareValue:function(){var a=null,b=this._indexer._asLiteral();if(b||(a=this._indexer._prepareValue&&this._indexer,a&&(a._prepareValue(),b=a._getLiteral())),b){var c=b.value();"string"==typeof c?this._strIndex=c:this._intIndex=parseInt(c),this._capital&&this._strIndex&&(this._strIndex=this._strIndex.toUpperCase())}},_getLiteral:function(){return null},evaluate:function(a){if(-1490313==this._idKey&&(this._idKey=a.isIdentifier(this._ident)),this._strIndex)return a.evaluateIndexerS(this._idKey,this._strIndex,this._capital);if(isNaN(this._intIndex)){var b=this._indexer.evaluate(a);return"string"==typeof b?a.evaluateIndexerS(this._idKey,b,this._capital):a.evaluateIndexerI(this._idKey,b)}return a.evaluateIndexerI(this._idKey,this._intIndex)},toString:function(){var a=this._ident+"["+this._indexer.toString()+"]";return a}}),eb=Ga("UnaryNode",Ta,{init:function(a){this._super(),this._factor=a,this._literal=null},_prepareValue:function(){this._literal=this._factor._asLiteral(),!this._literal&&this._factor._prepareValue&&(this._factor._prepareValue(),this._literal=this._factor._getLiteral())},_getLiteral:function(){return null}}),fb=Ga("LenNode",eb,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return b?b.length:0},toString:function(){return"(len "+this._factor+")"}}),gb=Ga("MinusNode",eb,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return-b},toString:function(){return"-"+this._factor}}),hb=Ga("PlusNode",eb,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return b},toString:function(){return"+"+this._factor}}),ib=Ga("NotNode",eb,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return!b},toString:function(){return"(not "+this._factor+")"}}),jb=Ga("ToBoolNode",eb,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return Boolean(b)},toString:function(){return"(bool "+this._factor+")"}}),kb=Ga("ToNumberNode",eb,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return Number(b)},toString:function(){return"(num "+this._factor+")"}}),lb=Ga("ToStringNode",eb,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return String(b)},toString:function(){return"(str "+this._factor+")"}}),mb=Ga("ToDateStringNode",eb,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return b instanceof Date&&(b=s(b.getFullYear(),4)+s(b.getMonth()+1,2)+s(b.getDate(),2)+s(b.getHours(),2)+s(b.getMinutes(),2)+s(b.getSeconds(),2)+s(b.getMilliseconds(),3)),String(b)},toString:function(){return"(datestr "+this._factor+")"}}),nb=Ga("ToYearNode",eb,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return b instanceof Date?b.getFullYear():null},toString:function(){return"(year "+this._factor+")"}}),ob=Ga("ToMonthNode",eb,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return b instanceof Date?b.getMonth()+1:null},toString:function(){return"(month "+this._factor+")"}}),pb=Ga("ToDayNode",eb,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return b instanceof Date?b.getDate():null},toString:function(){return"(day "+this._factor+")"}}),qb=Ga("ToHourNode",eb,{init:function(a){this._super(a)},evaluate:function(a){var b=this._literal?this._literal.value():this._factor.evaluate(a);return b instanceof Date?b.getHours():null},toString:function(){return"(hour "+this._factor+")"}}),rb=Ga("TermNode",Ta,{init:function(){this._super(),this._factors=[],this._operators=[],this._literal=null},addFactor:function(a){this._factors.push(a)},addOperator:function(a){this._operators.push(a)},isIdentifier:function(a){return 1==this._factors.length&&this._factors[0]instanceof cb&&this._factors[0].identifier()==a},_prepareValue:function(){var a,b,c;for(a=0,b=this._factors.length;b>a;a++)c=this._factors[a],c._prepareValue&&c._prepareValue();0==this._operators.length&&(c=this._factors[0],this._literal=c._asLiteral(),!this._literal&&c._prepareValue&&(this._literal=c._getLiteral()))},_getLiteral:function(){return this._literal},evaluate:function(a){if(this._literal)return this._literal.value();var b,c,d=this._factors.length,e=this._factors[0].evaluate(a);for(b=1;d>b;b++)switch(c=this._factors[b].evaluate(a),this._operators[b-1]){case Ra.And:e=e&&c;break;case Ra.Star:e*=c;break;case Ra.Slash:e/=c;break;case Ra.Div:e=ja(ja(e)/ja(c));break;case Ra.Mod:e%=c;break;case Ra.Shl:e<<=c;break;case Ra.Shr:e>>=c}return e},toString:function(){var a="";if(this._literal)a=this._literal.toString();else if(1==this._factors.length)a=this._factors[0].toString();else{var b,c=this._factors.length;for(a="("+this._factors[0].toString(),b=1;c>b;b++){switch(this._operators[b-1]){case Ra.And:a+=" and ";break;case Ra.Star:a+=" * ";break;case Ra.Slash:a+=" / ";break;case Ra.Div:a+=" / ";break;case Ra.Mod:a+=" mod ";break;case Ra.Shl:a+=" shl ";break;case Ra.Shr:a+=" shr "}a+=this._factors[b].toString()}a+=")"}return a}}),sb=Ga("SimpleExpressioNode",Ta,{init:function(){this._super(),this._terms=[],this._operators=[],this._literal=null},addTerm:function(a){this._terms.push(a)},addOperator:function(a){this._operators.push(a)},isIdentifier:function(a){return 1==this._terms.length&&this._terms[0].isIdentifier(a)},_prepareValue:function(){var a,b;for(a=0,b=this._terms.length;b>a;a++)this._terms[a]._prepareValue();0==this._operators.length&&(this._literal=this._terms[0]._getLiteral())},_getLiteral:function(){return this._literal},evaluate:function(a){if(this._literal)return this._literal.value();var b,c,d=this._terms.length,e=this._terms[0].evaluate(a);for(b=1;d>b;b++)switch(c=this._terms[b].evaluate(a),this._operators[b-1]){case Ra.Minus:e-=c;break;case Ra.Plus:e+=c;break;case Ra.Or:e=e||c;break;case Ra.Xor:e^=c}return e},toString:function(){var a="";if(this._literal)a=this._literal.toString();else if(1==this._terms.length)a=this._terms[0].toString();else{var b,c=this._terms.length;for(a="("+this._terms[0].toString(),b=1;c>b;b++){switch(this._operators[b-1]){case Ra.Minus:a+=" - ";break;case Ra.Plus:a+=" + ";break;case Ra.Or:a+=" or ";break;case Ra.Xor:a+=" xor ";break;default:a+=" <<ERROR>> "}a+=this._terms[b].toString()}a+=")"}return a}}),tb=function(){function a(a){if(a!=D.tokenId())throw new Q("Token is not a expected kind ["+a+"]: "+D.tokenId(),D.tokenLoc());b()}function b(){D.nextNoSpace()}function c(){var a,c,e,f=null,g=d();if(Ra.IS_CHECK[e=D.tokenId()]){if(b(),a=d(),a._prepareValue(),c=Ja(a._getLiteral(),Va),!c)throw new Q("is operator's operand must be defined, null or empty: "+D.tokenId());f=new $a(g,e,c)}else f=new Ua,f.leftExpr=g,Ra.IS_RELATIVE[D.tokenId()]&&(f.operator=D.tokenId(),b(),f.rightExpr=d());return f}function d(){var a=new sb;for(a.addTerm(e());Ra.IS_ADDITIVE[D.tokenId()];)a.addOperator(D.tokenId()),b(),a.addTerm(e());return a}function e(){var a=new rb;for(a.addFactor(f());Ra.IS_MULTIPLICATIVE[D.tokenId()];)a.addOperator(D.tokenId()),b(),a.addFactor(f());return a}function f(){var a=D.tokenId();switch(a){case Ra.StringLiteral:return g();case Ra.RoundOpen:return h();case Ra.Identifier:return i();case Ra.IntegerLiteral:return k();case Ra.FloatLiteral:return j();case Ra.Minus:return l();case Ra.Plus:return m();case Ra.Not:return n();case Ra.Defined:return o();case Ra.Null:return p();case Ra.Empty:return q();case Ra.NaN:return r();case Ra.ToBool:return s();case Ra.ToNum:return t();case Ra.ToStr:return u();case Ra.Length:return v();case Ra.LengthBin:return w();case Ra.ToDateStr:return x();case Ra.ToYear:return y();case Ra.ToMonth:return z();case Ra.ToDay:return A();case Ra.ToHour:return B()}throw new Q("Unkown token: "+a)}function g(){var a=D.token();return b(),new bb(a)}function h(){b();var d=c();return a(Ra.RoundClose),d}function i(){var d=D.token();if(b(),D.tokenId()==Ra.BracketOpen){b();var e=c();return a(Ra.BracketClose),new db(d,e,C.indexOf(d)>=0)}return new cb(d)}function j(){var a=D.token();return b(),new _a(a)}function k(){var a=D.token();return b(),new ab(a)}function l(){return b(),new gb(f())}function m(){return b(),new hb(f())}function n(){return b(),new ib(f())}function o(){return b(),new Wa}function p(){return b(),new Ya}function q(){return b(),new Xa}function r(){return b(),new Za}function s(){return b(),new jb(f())}function t(){return b(),new kb(f())}function u(){return b(),new lb(f())}function v(){return b(),new fb(f())}function w(){return b(),new LenBinNode(f())}function x(){return b(),new mb(f())}function y(){return b(),new nb(f())}function z(){return b(),new ob(f())}function A(){return b(),new pb(f())}function B(){return b(),new qb(f())}var C=null,D=new Sa;this.parse=function(a,d){if(!a)return null;C=d||[],D.init(a),b();var e=c();return e&&e._prepareValue(),e},this.evaluate=function(a,b,c){var d=this.parse(a,c);return d.evaluate(b)}};tb.Default=new tb;var ub=Ga("ExpressionRuntime",null,{init:function(){this._super()},isIdentifier:function(a){throw new Error("Token is not a valid Identifier: "+a)},evaluateIdentifier:function(a){throw new Error("Invalid identifier key: "+a)},evaluateIndexerI:function(a,b){throw new Error("Invalid identifier indexer: "+a)},evaluateIndexerS:function(a,b){throw new Error("Invalid identifier indexer: "+a)}}),vb=Ga("FilterRuntime",ub,{init:function(){this._super(),this._value=null},setData:function(a){this._value=a},isIdentifier:function(a){return a=a.toLowerCase(),vb.IDENTS.hasOwnProperty(a)?vb.IDENTS[a]:this._super(a)},evaluateIdentifier:function(a){switch(a){case vb.ID_VALUE:return this._value}throw new R("Invalid identifier key: "+a)}},{ID_VALUE:0},function(a){a.IDENTS={value:a.ID_VALUE}}),wb='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',xb=function(a){return a>=26?(a-=26,String.fromCharCode(ja(a/26)+65)+String.fromCharCode(ja(a%26)+65)):String.fromCharCode(a+65)},yb=function(a){var b="",c=/(>)(<)(\/*)/g;a=a.replace(c,"$1\r\n$2$3");for(var d=0,e=a.split("\r\n"),f=0,g=e.length;g>f;f++){var h=e[f],i=0;h.match(/.+<\/\w[^>]*>$/)?i=0:h.match(/^<\/\w/)?0!=d&&(d-=1):i=h.match(/^<\w[^>]*[^\/]>.*$/)?1:0;for(var j="",k=0;d>k;k++)j+="  ";b+=j+h+"\r\n",d+=i}return b},zb=Ga("ExcelStrings",null,{init:function(a){this._super(),this._workbook=a,this._nextId=0,this._count=0,this._stringMap={},this._strings=[]},count:function(){return this._count},uniqueCount:function(){return this._nextId},add:function(a){this._count++;var b=this._stringMap[a];return void 0===b&&(b=this._nextId++,this._stringMap[a]=b,this._strings[b]=a),b},getIndex:function(a){return this._stringMap[a]},createPart:function(){var a='<sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"></sst>',b=F(a),c=b.documentElement,d=/^\s|\s$/;c.setAttribute("count",this._count),c.setAttribute("uniqueCount",this._nextId);for(var e=0,f=this._strings.length;f>e;e++){var g=b.createElement("si");c.appendChild(g);var h=b.createElement("t");g.appendChild(h);var i=b.createTextNode(this._strings[e]);h.appendChild(i),d.test(this._strings[e])?h.setAttribute("xml:space","preserve"):null}return a=G(b),wb+a}}),Ab=function(){this.id=void 0,this.name="Tahoma",this.size=10,this.color="ff000000",this.bold=!1,this.italic=!1,this.scheme=void 0};Ab.prototype.serialize=function(a,b){I(a,b,"sz","val",this.size||10),I(a,b,"name","val",this.name||"Calibri"),I(a,b,"color","rgb",this.color||"ff000000"),I(a,b,"b","val",this.bold?"true":"false"),I(a,b,"i","val",this.italic?"true":"false")};var Bb=function(){this.id=void 0,this.patternType="none",this.color=void 0,this.gradient=void 0,this.color2=void 0,this.degree="90",this.tint=0,this.serialize=function(a,b){var c;if("linear"==this.gradient){var d=a.createElement("gradientFill");b.appendChild(d),d.setAttribute("degree",this.degree);var e=a.createElement("stop");d.appendChild(e),e.setAttribute("position","0"),c=a.createElement("color"),e.appendChild(c),c.setAttribute("rgb",this.color),c.setAttribute("tint",this.tint),e=a.createElement("stop"),d.appendChild(e),e.setAttribute("position","1"),c=a.createElement("color"),e.appendChild(c),c.setAttribute("rgb",this.color2),c.setAttribute("tint",this.tint)}else{var f=a.createElement("patternFill");b.appendChild(f),f.setAttribute("patternType",this.patternType),"none"!=this.patternType&&(c=a.createElement("fgColor"),f.appendChild(c),c.setAttribute("rgb",this.color),c.setAttribute("tint",this.tint))}}},Cb=function(){this.id=void 0,this.left=void 0,this.right=void 0,this.top=void 0,this.bottom=void 0};Cb.prototype.serialize=function(a,b){this.serializeBorder(a,b,"left"),this.serializeBorder(a,b,"right"),this.serializeBorder(a,b,"top"),this.serializeBorder(a,b,"bottom")},Cb.prototype.serializeBorder=function(a,b,c){var d=a.createElement(c);if(b.appendChild(d),c=this[c],c&&c._width>0){d.setAttribute("style","thin");var e=a.createElement("color");d.appendChild(e),e.setAttribute("rgb",c._color.toColorHex())}};var Db=function(){this.id=void 0,this.horzAlign=Db.ALIGN_NEAR,this.vertAlign=Db.VALIGN_CENTER,this.wrapText=!1,this.formatId=0,this.font=null,this.fill=null,this.border=null,this.xfId=0};Db.ALIGN_NEAR="left",Db.ALIGN_CENTER="center",Db.ALIGN_FAR="right",Db.VALIGN_NEAR="top",Db.VALIGN_CENTER="center",Db.VALIGN_FAR="bottom",Db.prototype.clone=function(){var a=new Db;for(var b in this)this.hasOwnProperty(b)&&(a[b]=this[b]);return a.id=void 0,a},Db.prototype.serialize=function(a,b){this.border&&b.setAttribute("borderId",this.border?this.border.id:"0"),this.fill&&b.setAttribute("fillId",this.fill?this.fill.id:"0"),this.font&&b.setAttribute("fontId",this.font?this.font.id:"0"),b.setAttribute("numFmtId",this.formatId),b.setAttribute("xfId","0");var c=a.createElement("alignment");b.appendChild(c),c.setAttribute("horizontal",this.horzAlign),c.setAttribute("vertical",this.vertAlign),this.wrapText&&c.setAttribute("wrapText","1")},$$_EXCEL_NUMFMT_START=200;var Eb=Ga("ExcelStyles",null,{init:function(a){this._super(),this._book=a,this._fonts=[],this._fills=[],this._borders=[],this._numFormats=[],this._xfs=[];var b=new Bb;this._fills.push(b,b);var c=new Cb;this._borders.push(c);var d=new Ab;this._fonts.push(d);var e=new Db;this._xfs.push(e)},addFont:function(a){return a?(this._fonts.push(a),a.id=this._fonts.length-1):0},addFill:function(a){return a?(this._fills.push(a),a.id=this._fills.length-1):0},addBorder:function(a){return a?(this._borders.push(a),a.id=this._borders.length-1):0},addNumberFormat:function(a){var b=this._numFormats.indexOf(a);return 0>b&&(this._numFormats.push(a),b=this._numFormats.length-1),$$_EXCEL_NUMFMT_START+b},add:function(a){return a?(this._xfs.push(a),a.id=this._xfs.length-1):0},createPart:function(){var a='<styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"></styleSheet>',b=F(a),c=b.documentElement;if(this._numFormats.length>0){var d=b.createElement("numFmts");c.appendChild(d),this.$_createNumberFormats(b,d)}var e=b.createElement("fonts");c.appendChild(e),this.$_createFonts(b,e);var f=b.createElement("fills");c.appendChild(f),this.$_createFills(b,f);var g=b.createElement("borders");c.appendChild(g),this.$_createBorders(b,g);var h=b.createElement("cellStyleXfs");c.appendChild(h),this.$_createDefXfs(b,h);var i=b.createElement("cellXfs");return c.appendChild(i),this.$_createXfs(b,i),a=G(b),wb+a},$_createNumberFormats:function(a,b){for(var c=0,d=this._numFormats.length;d>c;c++){var e=a.createElement("numFmt");H(e,"formatCode",this._numFormats[c]),H(e,"numFmtId",$$_EXCEL_NUMFMT_START+c),b.appendChild(e)}},$_createFonts:function(a,b){if(this._fonts.length<1){var c=new Ab;this._fonts.push(c)}for(var d=0,e=this._fonts.length;e>d;d++){var f=a.createElement("font");this._fonts[d].serialize(a,f),b.appendChild(f)}b.setAttribute("count",this._fonts.length)},$_createFills:function(a,b){if(this._fills.length<1){var c=new Bb;this._fills.push(c)}for(var d=0,e=this._fills.length;e>d;d++){var f=a.createElement("fill");this._fills[d].serialize(a,f),b.appendChild(f)}b.setAttribute("count",this._fills.length)},$_createBorders:function(a,b){if(this._borders.length<1){var c=new Cb;this._borders.push(c)}for(var d=0,e=this._borders.length;e>d;d++){var f=a.createElement("border");this._borders[d].serialize(a,f),b.appendChild(f)}b.setAttribute("count",this._borders.length)},$_createDefXfs:function(a,b){var c=a.createElement("xf");b.appendChild(c),c.setAttribute("borderId",0),c.setAttribute("fillId",0),c.setAttribute("fontId",0),c.setAttribute("numFmtId",0),b.setAttribute("count",1)},$_createXfs:function(a,b){if(this._xfs.length<1){var c=new Db;this._xfs.push(c)}for(var d=0,e=this._xfs.length;e>d;d++){var f=this._xfs[d],g=a.createElement("xf");f.serialize(a,g),b.appendChild(g)}b.setAttribute("count",this._xfs.length)}}),Fb=function(){this.index=void 0,this.width=10,this.style=null,this.serialize=function(a,b){b.setAttribute("min",this.index),b.setAttribute("max",this.index),b.setAttribute("width",this.width),this.style&&b.setAttribute("style",this.style.id)}},Gb=Ga("ExcelSheet",null,{init:function(a){this._super(),this._book=a,this._columns=null,this._doc=null,this._viewRoot=null,this._dataRoot=null,this._mergeRoot=null,this._rows=[],this._mergeCount=0,this._outlineLevel=0,this.$_preparePart(),this._dateConverter=Hc.Default},colCount:function(){return this._columns.length},rowCount:function(){return this._rows.length},setColumns:function(a){this._columns=a},addRow:function(a,b){var c=this._rows[a];if(!c){var c=this._doc.createElement("row");c.setAttribute("r",a+1),b&&b>-1&&(c.setAttribute("ht",b),c.setAttribute("customHeight","1")),this._rows[a]=c,this._dataRoot.appendChild(c)}return c},setRowLevel:function(a,b){if(b>=0){var c=this._rows[a];c&&(c.setAttribute("outlineLevel",b),this._outlineLevel=Math.max(b,this._outlineLevel))}},addBlank:function(a,b,c){var d=this.addRow(a),e=this._doc.createElement("c");e.setAttribute("r",xb(b)+(a+1)),c&&e.setAttribute("s",c.id),d.appendChild(e)},addMerge:function(a,b,c,d){var e=xb(b)+(a+1)+":"+xb(b+d-1)+(a+c),f=this._doc.createElement("mergeCell");f.setAttribute("ref",e),this._mergeRoot.appendChild(f),this._mergeCount++},$_addCell:function(a,b,c,d,e,f){var g=this.addRow(a,f),h=this._doc.createElement("c");h.setAttribute("r",xb(b)+(a+1)),h.setAttribute("t",c),e&&h.setAttribute("s",e.id),g.appendChild(h);var i=this._doc.createElement("v");i.appendChild(this._doc.createTextNode(d)),h.appendChild(i)},addText:function(a,b,c,d,e){var f=void 0!==c&&null!==c?c:"";f=this._book.addString(f),this.$_addCell(a,b,"s",f,d,e)},addNumber:function(a,b,c,d,e,f){var g=isNaN(c)?"":String(c);this.$_addCell(a,b,"n",g,d)},addBool:function(a,b,c,d,e,f){this.$_addCell(a,b,"b",c?1:0,d)},addDate:function(a,b,c,d,e,f,g){if(c)if(g){var h=this._dateConverter.toExcelDate(c);this.addNumber(a,b,h,d)}else{var i=this.$_dateToStr(c);this.$_addCell(a,b,"d",i,d)}else this.$_addCell(a,b,"s","",d)},createPart:function(){var a=this._doc,b=a.documentElement,c="A1:"+xb(this._columns.length-1)+this._book._sheet._rows.length,d=a.getElementsByTagName("dimension");if(d&&d.length>0&&d[0].setAttribute("ref",c),this._outlineLevel>0){var e=a.createElement("sheetFormatPtr");b.appendChild(e),e.setAttribute("outlineLevelRow",this._outlineLevel)}if(this._columns){var f=a.createElement("cols");b.appendChild(f),this.$_createCols(a,f)}b.appendChild(this._dataRoot),this._mergeCount>0&&(b.appendChild(this._mergeRoot),this._mergeRoot.setAttribute("count",this._mergeCount));var g=G(a);return yb(wb+g)},$_preparePart:function(){var a='<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"></worksheet>',b=this._doc=F(a),c=b.createElement("dimension");b.documentElement.appendChild(c);var d=b.createElement("sheetViews");b.documentElement.appendChild(d);var e=this._viewRoot=b.createElement("sheetView");d.appendChild(e),e.setAttribute("workbookViewId","0"),e.setAttribute("tabSelected","1"),this._dataRoot=b.createElement("sheetData"),this._mergeRoot=b.createElement("mergeCells")},$_createCols:function(a,b){for(var c=this._columns,d=0,e=c.length;e>d;d++){var f=c[d],g=a.createElement("col");f.serialize(a,g),b.appendChild(g)}},$_dateToStr:function(a){return s(a.getFullYear(),4)+s(a.getMonth()+1,2)+s(a.getDate(),2)+"T"+s(a.getHours(),2)+s(a.getMinutes(),2)+s(a.getSeconds(),2)}}),Hb=Ga("ExcelWorkbook",null,{init:function(){this._super(),this._parts={},this._sst=new zb(this),this._styles=new Eb(this),this._sheet=new Gb(this),this.$_preapreTemplateParts()},parts:function(){return this._parts},sheet:function(){return this._sheet},addString:function(a){return this._sst.add(a)},addNumberFormat:function(a){return this._styles.addNumberFormat(a)},addFill:function(a){return this._styles.addFill(a)},addBorder:function(a){return this._styles.addBorder(a)},addFont:function(a){return this._styles.addFont(a)},addStyle:function(a){return this._styles.add(a)},createParts:function(){var a=this._parts;return a["xl/sharedStrings.xml"]=this._sst.createPart(),a["xl/styles.xml"]=this._styles.createPart(),a["xl/worksheets/sheet1.xml"]=this._sheet.createPart(),a},$_preapreTemplateParts:function(){var a=this._parts;a["[Content_Types].xml"]=wb+'<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Default Extension="xml" ContentType="application/xml"/><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/><Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/><Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/></Types>',a["_rels/.rels"]=wb+'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/></Relationships>',a["docProps/app.xml"]=wb+'<Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"><Application>RealGridJS</Application><AppVersion>1.0</AppVersion></Properties>',a["docProps/core.xml"]=wb+'<coreProperties xmlns="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><dcterms:created xsi:type="dcterms:W3CDTF">2014-12-25T03:06:34Z</dcterms:created><dc:creator>Wooritech</dc:creator></coreProperties>',a["xl/workbook.xml"]=wb+'<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><workbookPr date1904="false"/><bookViews><workbookView activeTab="0"/></bookViews><sheets><sheet name="Sheet1" r:id="rId3" sheetId="1"/></sheets></workbook>',a["xl/_rels/workbook.xml.rels"]=wb+'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/></Relationships>'}}),Ib=Ga("Dom",null,{init:function(a){this._super(),this._element=a},x:function(){return this._element.offsetLeft},y:function(){return this._element.offsetTop},size:function(){return Ib.getSize(this._element)},element:function(){return this._element},detach:function(){this._element.parentNode&&this._element.parentNode.removeChild(this._element)},clearChildren:function(){Ib.clearChildren(this._element)},addChild:function(a){Ib.addChild(this._element,a)},setStyles:function(a){Ib.setStyles(this._element,a)},getBounds:function(){return Ib.getBounds(this._element)},getOffset:function(){return Ib.getOffset(this._element)},move:function(a,b){Ib.move(this._element,a,b)},disableSelection:function(){Ib.disableSelection(this._element)},isAncestorOf:function(a){for(var b=a.parentElement;b;)if(b==this._element)return!0;return!1}},{createElement:function(a,b,c){var d=document.createElement(a);if(b&&Ib.setStyles(d,b),c)for(var e in c)d[e]=c[e];return d},setStyles:function(a,b){if(b){var c=a.style;for(var d in b)c[d]=b[d]}},removeStyleProperty:function(a,b){a.style.removeProperty?a.style.removeProperty(b):a.style.removeAttribute(b)},addEventListener:function(a,b,c,d){T.addEventListener?a.addEventListener(b,c,d):a.attachEvent(b,c,d)},removeEventListener:function(a,b,c,d){T.removeEventListener?a.removeEventListener(b,c,d):a.detachEvent(b,c)},getSize:function(a){var b=a.getBoundingClientRect();return{width:b.width,height:b.height}},setSize:function(a,b,c){var d=a.style;d.width=b+"px",d.height=c+"px"},getBounds:function(a){var b=a.getBoundingClientRect();return b.cx=a.offsetLeft,b.cy=a.offsetTop,b},setBounds:function(a,b,c,d,e){var f=a.style;f.left=b+"px",f.top=c+"px",f.width=d+"px",f.height=e+"px"},getScrolled:function(){var a=document.body,b=document.documentElement;return{sx:window.pageXOffset||b.scrollLeft||a.scrollLeft,sy:window.pageYOffset||b.scrollTop||a.scrollTop}},getOffset:function(a){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||c.scrollTop,f=window.pageXOffset||d.scrollLeft||c.scrollLeft,g=d.clientTop||c.clientTop||0,h=d.clientLeft||c.clientLeft||0,i=b.left+f-h,j=b.top+e-g;
return{x:Math.round(i),y:Math.round(j)}},move:function(a,b,c){a.style.left=b+"px",a.style.top=c+"px"},disableSelection:function(a){a.style["-moz-user-select"]="-moz-none",a.style["-khtml-user-select"]="none",a.style["-webkit-user-select"]="none",a.style["-o-user-select"]="none",a.style["-ms-user-select"]="none",a.style["user-select"]="none"},createOptions:function(a,b,c){for(var d=0,e=b.length;e>d;d++){var f=document.createElement("option");f.value=b[d],f.text=c?c[d]:b[d],a.appendChild(f)}},addChild:function(a,b){return a&&b&&b.parentNode!==a?(a.appendChild(b),!0):!1},removeChild:function(a,b){return a&&b&&b.parentNode===a?(a.removeChild(b),!0):!1},clearChildren:function(a){for(var b=a;b.lastChild;)b.removeChild(b.lastChild)},getChildIndex:function(a){if(a){var b=a.parentNode;if(b)for(var c=b.childNodes,d=0;d<c.length;d++)if(c[d]===a)return d}return-1},getRadioGroupValue:function(a){var b=document.getElementsByName(a);if(b)for(var c=b.length;c--;)if(b[c].checked)return b[c].value;return void 0},htmlEncode:function(a){return document.createElement("a").appendChild(document.createTextNode(a)).parentNode.innerHTML},getClipRect:function(a){return"rect("+a.y+"px,"+(a.x+a.width)+"px,"+(a.y+a.height)+"px,"+a.x+"px)"},renderTextRect:function(a,b,c,d,e,f){Ib.renderTextBounds(a,b,c,d,e.x,e.y,e.width,e.height,f)},renderTextBounds:function(a,b,c,d,e,f,g,h,i,j){if(c&&d){var k=a.style;a.textContent=d,k.font=b?b.font:DEF_FONT,k.color=c.css(),k.whiteSpace="nowrap",k.textDecoration=b.underline?"underline":"none";var l=a.getBoundingClientRect2();switch(i){case Qb.CENTER:e+=(g-l.width)/2;break;case Qb.RIGHT:e=e+g-l.width}switch(k.left=e+"px",j){case Rb.TOP:break;case Rb.BOTTOM:f=f+h-l.height;break;case Rb.MIDDLE:default:f+=(h-l.height)/2}k.top=f+"px"}},isAncestorOf:function(a,b){for(var c=b.parentElement;c;){if(c==a)return!0;c=c.parentElement}return!1},fireEvent:function(a,b){var c;document.createEventObject?(c=document.createEventObject(),a.fireEvent("on"+b,c)):(c=document.createEvent("HTMLEvents"),c.initEvent(b,!0,!0),a.dispatchEvent(c))}}),Jb=function(a,b){if("string"==typeof a){var c=Jb._parse(a,this,b,!1);if("object"==typeof c)return c}else a instanceof Jb?(this._r=a._r,this._g=a._g,this._b=a._b,this._a=a._a):isNaN(a)?(this._r=this._g=this._b=0,this._a=b?NaN:1):(this._a=(a>>>24)/255,this._r=(16711680&a)>>16,this._g=(65280&a)>>8,this._b=255&a)};Jb._ERROR=new Jb(va,!0),Jb._ERROR.error=!0,Jb.createFrom=function(a,b){var c=Jb._parse(a,Kb,b,!1);return c?"object"==typeof c?c:Kb.clone():null},Jb._parse=function(a,b,c,d){var e=String(a);if(e){var f,g=e.length;if(e=e.trim().toLowerCase(),"#"==e.charAt(0))if(e=e.substr(1),g--,g>=6&&8>=g)b._b=u(e.substr(g-2,2),16),b._g=u(e.substr(g-4,2),16),b._r=u(e.substr(g-6,2),16),b._a=6==g?c?NaN:1:u(e.substr(0,g-6),16)/255;else{if(3!=g){if(d)throw"Invalid color value text: "+a;return!1}b._r=u(e.charAt(0)+e.charAt(0),16),b._g=u(e.charAt(1)+e.charAt(1),16),b._b=u(e.charAt(2)+e.charAt(2),16),b._a=c?NaN:1}else if(0==e.indexOf("rgba(")&&")"==e.charAt(g-1))e=e.substring(5,g-1),f=e.split(","),b._r=u(f[0]),b._g=u(f[1]),b._b=u(f[2]),b._a=f[3];else{if(0!=e.indexOf("rgb(")||")"!=e.charAt(g-1)){if(c&&Mb.hasOwnProperty(e))return Mb[e];if(!c&&Lb.hasOwnProperty(e))return Lb[e];var h=Nb.createFrom(e,!1);if(h)return h;if(d)throw new Error("Invalid color text: "+a);return!1}e=e.substring(4,g-1),f=e.split(","),b._r=u(f[0]),b._g=u(f[1]),b._b=u(f[2]),b._a=c?NaN:1}return!0}return!1},Jb.getColorStringArray=function(a){return a.trim().toLowerCase().split(/\s+|(rgba\(.*\))|(rgb\(.*\))|(pal\(.*\))/).filter(Boolean)},Jb.getColorCsvArray=function(a){return a.trim().toLowerCase().split(/\s*,\s*|\s+|(rgba\(.*\))|(rgb\(.*\))|(pal\(.*\))/).filter(Boolean)},Jb.prototype.clone=function(){return new Jb(this)},Jb.prototype.copy=function(a,b){return a?(this._r=a._r,this._g=a._g,this._b=a._b,this._a=isNaN(a._a)?Number(b):a._a):this._a=Number(b),this},Jb.prototype.value=function(){return"rgba("+this._r+","+this._g+","+this._b+","+this._a+")"},Jb.prototype.valueWithBrightness=function(a){var b=this._r,c=this._g,d=this._b,e=Number(a);return isNaN(e)||1==e||(b=ia(Math.max(0,Math.min(255,b*e))),c=ia(Math.max(0,Math.min(255,c*e))),d=ia(Math.max(0,Math.min(255,d*e))),255==b&&this._r<255&&(b=ia((255+this._r)/2)),255==c&&this._g<255&&(c=ia((255+this._g)/2)),255==d&&this._b<255&&(d=ia((255+this._b)/2))),"rgba("+b+","+c+","+d+","+this._a+")"},Jb.prototype.argb=function(){return Math._floor(255*this._a)<<24|this._r<<16|this._g<<8|this._b},Jb.prototype.rgb=function(){return this._r<<16|this._g<<8|this._b},Jb.prototype.extractAlpha=function(){var a=this._a;return this._a=NaN,a},Jb.prototype.toHex=function(){return""+t(ia(255*this._a))+t(this._r)+t(this._g)+t(this._b)},Jb.prototype.toColorHex=function(){return""+t(this._r)+t(this._g)+t(this._b)},Jb.prototype.toString=function(){return"#"+t(ia(255*this._a))+t(this._r)+t(this._g)+t(this._b)},Jb.prototype.toColorString=function(){return"#"+t(this._r)+t(this._g)+t(this._b)},Jb.areEqual=function(a,b){return a&&b&&a._r==b._r&&a._g==b._g&&a._b==b._b&&a._a==b._a};var Kb=new Jb,Lb=([new Jb,new Jb],{transparent:new Jb("#00000000"),aqua:new Jb("#00ffff"),black:new Jb("#000000"),blue:new Jb("#0000ff"),fuchsia:new Jb("#ff00ff"),gray:new Jb("#808080"),green:new Jb("#008000"),lime:new Jb("#00ff00"),maroon:new Jb("#800000"),navy:new Jb("#000080"),olive:new Jb("#808000"),orange:new Jb("#ffa500"),purple:new Jb("#800080"),red:new Jb("#ff0000"),silver:new Jb("#c0c0c0"),teal:new Jb("#008080"),white:new Jb("#ffffff"),yellow:new Jb("#ffff00"),dimGray:new Jb("#696969"),ltGray:new Jb("#d3d3d3")}),Mb={transparent:new Jb("#00000000"),aqua:new Jb("#00ffff",!0),black:new Jb("#000000",!0),blue:new Jb("#0000ff",!0),fuchsia:new Jb("#ff00ff",!0),gray:new Jb("#808080",!0),green:new Jb("#008000",!0),lime:new Jb("#00ff00",!0),maroon:new Jb("#800000",!0),navy:new Jb("#000080",!0),olive:new Jb("#808000",!0),orange:new Jb("#ffa500",!0),purple:new Jb("#800080",!0),red:new Jb("#ff0000",!0),silver:new Jb("#c0c0c0",!0),teal:new Jb("#008080",!0),white:new Jb("#ffffff",!0),yellow:new Jb("#ffff00",!0),dimGray:new Jb("#696969",!0),ltGray:new Jb("#d3d3d3",!0)},Nb=function(a,b){this._palette=a,this._index=arguments.length>1?b:-1};Nb.createFrom=function(a,b){var c=b?a.trim().toLowerCase():a;if(0==c.indexOf("pal(")&&")"==c.charAt(c.length-1)){if(c=c.substring(4,c.length-1),c.indexOf(",")>=1){var d=c.split(",");return d.length>1?new Nb(d[0],parseInt(d[1])):new Nb(d[0])}return new Nb(c)}return null},Nb.prototype.clone=function(){var a=new Nb(this._palette,this._index);return a},Nb.prototype.getColor=function(){var a=this.getIndex();return a>=0?this._palette.getColor(a):Lb.transparent},Nb.prototype.getIndex=function(){var a=this._palette;return a instanceof Ob||(this._palette=a=Ob.getPalette(this._palette)),a?((this._index<0||this._index>=a.getCount())&&(this._index=a.next()),this._index):-1};var Ob=function(a){this._colors=[],this._next=0,this._parse(a)};Ob.register=function(a,b){a&&(Ob._palettes[a]=b)},Ob.loadPalettes=function(a){if(a){var b=ga(a);if(b)for(var c=0;c<b.length;c++){var d=b[c].name,e=b[c].colors;if(d&&e){var f=new Ob(e);Ob.register(d,f)}}}},Ob.getPalette=function(a){return Ob._palettes.hasOwnProperty(a)?Ob._palettes[a]:Ob._palettes["default"]},Ob.prototype.getCount=function(){return this._colors.length},Ob.prototype.getColors=function(){return this._colors.slice()},Ob.prototype.next=function(){var a=this._next;return this._next=(this._next+1)%this._colors.length,a},Ob.prototype.getColor=function(a){return this._colors[a]},Ob.prototype._parse=function(a,b){if(this._colors=[],a){var c=a;ea(c)||(c=String(a).split(","));for(var d=0,e=c.length;e>d;d++){var f=Jb.createFrom(c[d],!0);this._colors.push(f)}}this._colors.length<1&&this._colors.push(Jb.createFrom("#00000000"))},Ob._palettes={"default":new Ob("#eeeeee")};var Pb=function(a){a&&this._parse(a)};Pb.prototype._parse=function(a){var b=xa.splitEscape(a," ");3==b.length&&"solid"==b[1]?(this._width=parseInt(b[0]),this._color=new Jb(b[2])):2==b.length&&"solid"==b[1]?(this._width=1,this._color=Lb.black):(this._width=0,this._color=null)},Pb.prototype.width=function(){return this._width},Pb.prototype.color=function(){return this._color},Pb.prototype.css=ua?function(){return this._width+"px solid "+this._color.toColorString()}:function(){return this._width+"px solid "+this._color.value()};var Qb=P({LEFT:"left",CENTER:"center",RIGHT:"right"}),Rb=P({TOP:"top",MIDDLE:"middle",BOTTOM:"bottom"}),Sb=(P({NONE:"none",NORMAL:"normal"}),P({CIRCLE:"circle",TRIANGLE:"triangle",SQUARE:"square",DIAMOND:"diamond"}),P({VISIBLE:"visible",HIDDEN:"hidden",COLLAPSED:"collapsed"}),P({DEFAULT:"default",FAR:"far",MID:"mid",NEAR:"near"}),P({HORIZONTAL:"horizontal",VERTICAL:"vertical"}),P({DEFAULT:"default",LEFT:"left",CENTER:"center",RIGHT:"right",FILL:"fill"}),P({DEFAULT:"default",TOP:"top",MIDDLE:"middle",BOTTOM:"bottom",FILL:"fill"}),P({NONE:"none",JUSTIFY:"justify"}),function(a,b,c,d){"undefined"==typeof a||null===a?this.x=this.y=this.width=this.height=0:(this.x=a,this.y=b,this.width=c,this.height=d)});Sb.prototype={constructor:Sb,clone:function(){return new Sb(this.x,this.y,this.width,this.height)},getInner:function(){return new Sb(0,0,this.width,this.height)},equals:function(a){return a===this||a&&this.x===a.x&&this.y===a.y&&this.width===a.width&&this.height===a.height},toString:function(){return"{x: "+this.x+", y: "+this.y+", width: "+this.width+", height: "+this.height+"}"},left:function(){return this.x},setLeft:function(a){var b=a-this.x;this.x+=b,this.width-=b},leftBy:function(a){return this.x+=a,this.width-=a,this},right:function(){return this.x+this.width},setRight:function(a){var b=a-(this.x+this.width);this.width+=b},rightBy:function(a){return this.width+=a,this},top:function(){return this.y},setTop:function(a){var b=a-this.y;return this.y+=b,this.height-=b,this},topBy:function(a){return this.y+=a,this.height-=a,this},bottom:function(){return this.y+this.height},setBottom:function(a){var b=a-(this.y+this.height);return this.height+=b,this},bottomBy:function(a){return this.height+=a,this},shrink:function(a,b){return this.width-=a,this.height-=b,this},expand:function(a,b){return this.width+=a,this.height+=b,this},contains:function(a,b){return a>=this.x&&a<=this.x+this.width&&b>=this.y&&b<=this.y+this.height},isEmpty:function(){return 0===this.width||0===this.height},setEmpty:function(){return this.width=this.height=0,this},set:function(a,b,c,d){return this.x=a,this.y=b,this.width=c,this.height=d,this},copy:function(a){return this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height,this},copyHorz:function(a){return this.x=a.x,this.width=a.width,this},copyVert:function(a){return this.y=a.y,this.height=a.height,this},inflate:function(a,b,c,d){return b=arguments.length>1?b:0,c=arguments.length>2?c:a,d=arguments.length>3?d:b,a&&this.setLeft(this.x-a),b&&this.setTop(this.y-b),c&&this.setRight(this.right()+c),d&&this.setBottom(this.bottom()+d),this},offset:function(a,b){return this.x+=a,this.y+=b,this},round:function(){var a=this.clone();return a.x>>>=0,a.y>>>=0,a.width>>>=0,a.height>>>=0,a},union:function(a){var b=this.clone();return b.setLeft(Math.min(this.x,a.x)),b.setRight(Math.max(this.right(),a.right())),b.setTop(Math.min(this.y,a.y)),b.setBottom(Math.max(this.bottom(),a.bottom())),b},normalize:function(){return this.width<0&&(this.x-=this.width,this.width*=-1),this.height<0&&(this.y-=this.height,this.height*=-1),this}};var Tb=function(a,b){0==arguments.length?this.width=this.height=0:(this.width=a,this.height=b)};Tb.EMPTY=new Tb,Tb.empty=function(){return new Tb},Tb.create=function(a,b){return new Tb(a,b)},Tb.prototype={constructor:Tb,clone:function(){return new Tb(this.width,this.height)},equals:function(a){return a===this||a&&this.width===a.width&&this.height===a.height},toString:function(){return"{width: "+this.width+", height: "+this.height+"}"},isEmpty:function(){return 0===this.width||0===this.height},setEmpty:function(){return this.width=this.height=0,this},set:function(a,b){return this.width=a,this.height=b,this},round:function(){var a=this.clone();return a.width>>>=0,a.height>>>=0,a}};var Ub=function(a,b){0==arguments.length?this.x=this.y=0:(this.x=a,this.y=b)};Ub.EMPTY=new Ub,Ub.empty=function(){return new Ub},Ub.create=function(a,b){return new Ub(a,b)},Ub.prototype={constructor:Tb,clone:function(){return new Ub(this.x,this.y)},equals:function(a){return a===this||a&&this.width===a.width&&this.height===a.height},toString:function(){return"{x: "+this.x+", y: "+this.y+"}"},isEmpty:function(){return 0===this.x||0===this.y},setEmpty:function(){return this.x=this.y=0,this},set:function(a,b){return this.x=a,this.y=b,this},round:function(){var a=this.clone();return a.x>>>=0,a.y>>>=0,a}};var Vb=function(){this.left=new Sb,this.right=new Sb,this.top=new Sb,this.bottom=new Sb};Vb.prototype={constructor:Vb,clear:function(){this.left.setEmpty(),this.right.setEmpty(),this.top.setEmpty(),this.bottom.setEmpty()},setLeft:function(a,b,c,d){this.left.set(a,b,c,d)},setRight:function(a,b,c,d){this.right.set(a,b,c,d)},setTop:function(a,b,c,d){this.top.set(a,b,c,d)},setBottom:function(a,b,c,d){this.bottom.set(a,b,c,d)}};var Wb=function(a,b){this._size=a,this._fixed=b};Wb.prototype={constructor:Wb,clone:function(){return new Wb(this._size,this._fixed)},getSize:function(a){return this._fixed?this._size:a*this._size}},Wb.Empty=new Wb(0,!1),Wb.createFrom=function(a){var b=0,c=!1;if(a){var d=String(a).trim(),e=d.length;e>0&&(e>2&&d.lastIndexOf("px")==e-2&&(c=!0,d=d.substr(0,e-3)),d&&(b=parseFloat(d)))}return new Wb(b,c)},Wb.equals=function(a,b){return a instanceof Wb&&b instanceof Wb&&a._size===b.size&&a._precentage===b._precentage};var Xb=function(a,b){this._size=a,this._fixed=b};Xb.prototype={constructor:Xb,clone:function(){return new Xb(this._size,this._fixed)},getSize:function(a,b){return this._fixed?this._size:a*this._size/(b||100)}},Xb.Empty=new Xb(0,!0),Xb.createFrom=function(a){var b=0,c=!0;if(a){var d=String(a).trim(),e=d.length;e>0&&(e>1&&d.lastIndexOf("%")==e-1&&(c=!1,d=d.substr(0,e-1).trim()),d&&(b=parseFloat(d)))}return new Xb(b,c)},Xb.equals=function(a,b){return a instanceof Xb&&b instanceof Xb&&a._size===b.size&&a._precentage===b._precentage};var Yb=function(a,b){this.width=a,this.height=b};Yb.prototype={constructor:Yb,clone:function(){return new Yb(this.width,this.height)},set:function(a,b){this.width=parseFloat(a),this.height=parseFloat(b)}},Yb.createFrom=function(a){var b=0,c=0;if(a){var d=String(a).split(",");d.length>0&&(b=c=parseFloat(d[0])),d.length>1&&(c=parseFloat(d[1]))}return new Yb(b,c)};var Zb=Ga("ProgressView",null,{init:function(){this._super(),this._container=null,this._element=this.$_createElement(),this._min=0,this._max=0,this._pos=0},destroy:function(){this._element.parentNode&&this._container.removeChild(this._element),this._container=null,this._super()},modal:!1,message:"Load data...",position:function(){return this._pos},setPosition:function(a,b){a=Math.max(this._min,Math.min(this._max,a)),a!=this._pos&&(this._pos=a,this._message=b,this.$_refreshView())},setProperties:function(a,b,c,d,e){this._min=a,this._max=Math.max(a,b),this._max==this._min&&(this._max=this._min+1),this._pos=Math.max(this._min,Math.min(this._max,c)),d&&(this._message=d),e&&this.$_refreshView()},show:function(a,b){this._container=a,b&&this.$_setMessage(b),a.appendChild(this._element);var c=a.getBoundingClientRect(),d=this._element.getBoundingClientRect();this._element.style.left=(c.width-d.width)/2+"px",this._element.style.top=(c.height-d.height)/3+"px"},close:function(){this._element.parentNode&&this._container.removeChild(this._element)},$_createElement:function(){var a=U.createElement("div");return a.style.position="absolute",a.style.zIndex=3001,a.style.minWidth="250px",a.style.padding="8px 10px",a.className="realpivot-progress",this._barElement=this.$_createBar(),a.appendChild(this._barElement),this._msgElement=this.$_createMsg(),a.appendChild(this._msgElement),a},$_createBar:function(){var a=U.createElement("div");a.style.width="100%",a.style.height="13px",a.style.marginBottom="4px",a.className="realpivot-progress-bar";var b=this._ledElement=U.createElement("div");return b.style.height="100%",b.style.width="0px",b.className="realpivot-progress-led",a.appendChild(b),a},$_createMsg:function(){var a=U.createElement("div");a.style.width="100%",a.className="realpivot-progress-message";var b=this._spanElement=U.createElement("span");return b.className="realpivot-progress-message",a.appendChild(b),a},$_refreshView:function(){var a=(this._element,this._barElement),b=this._ledElement,c=this._spanElement;c.innerHTML=Ib.htmlEncode(this._message);var d=a.getBoundingClientRect();b.style.width=Math.min(d.width-1,ja(d.width*(this._pos-this._min)/(this._max-this._min)))+"px"},$_setMessage:function(a){var b=this._spanElement;b.innerHTML=Ib.htmlEncode(this._message)}}),$b=Ga("ProgressManager",null,{init:function(a){this._super(),this._container=a,this._title=null,this._view=null},destroy:function(){this._view&&xa.freeAndNull(this._view),this._container=null,this._super()},show:function(a,b){this._view||(this._view=new Zb),this._view.show(this._container,a||"Load data...")},close:function(){this._view&&this._view.close()},setProperties:function(a,b,c,d){d||(d=this._title||"Load data... ",b>a&&(d+=parseInt(100*(c-a)/(b-a))+"% ("+c+" / "+b+")")),this._view&&this._view.setProperties(a,b,c,d,!0)}}),_b=Ga("ToolTipView",Ka,{init:function(a){this._super(),this._container=a,this._span=null,this._element=this._createElement()},destroy:function(){this._span&&this._element.removeChild(this._span),this._element.parentNode&&this._container.removeChild(this._element),this._container=null,this._super()},show:function(a,b,c,d){this.$_show(a,b,c,d)},$_show:function(a,b,c,d){var e=a.message+"";if(e){var f=this._span;f.innerHTML=e.replace(/\n/g,"<br>");var g=this._element;g.style.position="absolute",g.style.left=b+"px",g.style.top=c+"px",g.style.visibility="hidden",this._container.appendChild(g);var h=g.getBoundingClientRect(),i=this._container.getBoundingClientRect();g.style.left=h.right>i.right?Math.max(i.right-h.width-i.left-2,0)+"px":g.style.left,g.style.top=h.bottom>i.bottom?Math.max(c-h.height-d.height(),0)+"px":g.style.top,g.style.visibility="visible"}},hide:function(){var a=this._element;a&&a.parentNode&&this._container.removeChild(a)},_createElement:function(){var a=U.createElement("div");return a.className="realpivot-tooltip",this._span=U.createElement("span"),this._span.className="realpivot-tooltip",a.appendChild(this._span),a}}),ac=Ga("ToolTipManager",null,{init:function(a){this._super(),this._container=a,this._tipView=null,this._active=!1},destroy:function(){this._active&&this.close(),this._tipView&&xa.freeAndNull(this._tipView),this._container=null,this._super()},delayTime:100,showTimer:null,isVisible:function(){return this._active},show:function(a,b,c,d){this._active||(this.close(),a&&(this._tipView||(this._tipView=new _b(this._container)),this._tipView.show(a,b,c,d),this._active=!0))},close:function(){this._showTimer&&clearTimeout(this._showTimer),this._active&&(this._tipView&&this._tipView.hide(),this._active=!1)}}),bc=Ga("ContextMenuView",Ka,{init:function(a,b){this._super(),this._container=a,this._listners=[],this._items=b,this._createElement(b)},destroy:function(){this._items=null,this._removeItems(),this._container.removeChild(this._element),this._element=null,this._container=null,this._super()},show:function(a,b,c){this.$_show(a,b,c)},$_show:function(a,b,c){var d=this._element;d.style.position="absolute",d.style.left=a+"px",d.style.top=b+"px",d.style.visibility="hidden",this._container.appendChild(d);var e=d.getBoundingClientRect(),f=this._container.getBoundingClientRect(),g=c?c.height:0;d.style.left=e.right>f.right?Math.max(f.right-e.width-f.left-2,0)+"px":d.style.left,d.style.top=e.bottom>f.bottom?Math.max(b-e.height-g,0)+"px":d.style.top,d.style.visibility="visible"},hide:function(){var a=this._element;a&&a.parentNode&&this._container.removeChild(a)},_createElement:function(a){this._element=U.createElement("div"),this._element.className="realpivot-menu",this._buildItems(a)},_removeItems:function(){for(var a=this._listners.length;a--;){var b=this._listners[a];Ib.removeEventListener(b,"click",this._menuItemClick,!1),delete b}for(this._listners=[];this._element.firstChild;)this._element.removeChild(this._element.firstChild)},_buildItems:function(a){this._removeItems();var b,c,d,e,f,g,h=this._element;for(f=0,g=a.length;g>f;f++)b=U.createElement("div"),b.menuItem=a[f],"-"==a[f].text?(b.className="realpivot-menu-split",c=U.createElement("hr"),c.className="realpivot-menu-split",b.appendChild(c)):(b.className="realpivot-menu-item",a[f].callback&&(Ib.addEventListener(b,"click",this._menuItemClick.bind(this),!1),this._listners.push(b)),d=U.createElement("span"),d.className="realpivot-menu-item-pre",b.appendChild(d),e=U.createElement("span"),e.className="realpivot-menu-item",e.innerHTML=a[f].text||"&nbsp;",b.appendChild(e)),h.appendChild(b)},_menuItemClick:function(a){var b=a.currentTarget?a.currentTarget:a.srcElement,c=b.menuItem.callback;this.hide(),c()}}),cc=Ga("ContextMenuManager",null,{init:function(a,b){this._super(),this._container=a,this._menuView=null,b?this._items=b.slice():this._items=null,this._active=!1,this._itemChanged=!1},destroy:function(){this._active&&this.close(),this._menuView&&xa.freeAndNull(this._menuView),this._container=null,this._items=null,this._super()},isVisible:function(){return this._active},show:function(a,b,c){this._active||(this.close(),this._menuView?this._itemChanged&&this._menuView._buildItems(this._items):this._menuView=new bc(this._container,this._items),this._menuView.show(a,b,c),this._active=!0,this._itemChanged=!1)},close:function(){this._active&&(this._menuView&&this._menuView.hide(),c(this._menuView._element.parentNode),this._active=!1)},setItems:function(a){if(a){this._items=[],this._itemChanged=!0;for(var b=0,c=a.length;c>b;b++){var d={};d.text=a[b].text,d.callback=a[b].callback,this._items.push(d)}}else this._items=null}}),dc=(P({BACK:8,TAB:9,ENTER:13,ESC:27,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,F2:113,F3:114,D:68,I:73,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90}),P({DEFAULT:"default",AUTO:"auto",POINTER:"pointer",WAIT:"wait",MOVE:"move",COL_RESIZE:"col-resize",ROW_RESIZE:"row-resize",CROSSHAIR:"crosshair",HORZ_RESIZE:"ew-resize",VERT_RESIZE:"ns-resize",NESW_RESIZE:"nesw-resize",NWSE_RESIZE:"nwse-resize",NO_DROP:"no-drop",NOT_ALLOWED:"not-allowed"})),ec=function(a,b){if(!b)return void alert("no touch");if(!a)return void alert("no container");if(!a._canvas)return void alert("no canvas");var c=a._canvas.getBoundingClientRect();return b.x=b.pageX-(c.left+window.scrollX),b.y=b.pageY-(c.top+window.scrollY),b},fc=(Ga("TouchManager",null,{init:function(a){this._super(),this._container=a},touchStart:function(a){},touchMove:function(a){},touchEnd:function(a){},touchCancel:function(a){},_toOffset:function(a){return ec(this._container,a)}}),Ga("VisualTool",null,{init:function(a){this._super(),this._owner=a,this._dragTracker=null,this._clickX=0,this._clickY=0,this._currX=0,this._currY=0},dragTracker:null,owner:function(){return this._owner},setDragTracker:function(a){a!==this._dragTracker&&(this._dragTracker&&this._dragTracker.deactivate(),this._dragTracker=a,this._dragTracker&&this._dragTracker.activate())},isDragging:function(){return this._dragTracker&&this._dragTracker.isDragging()},inDraggablePt:function(a,b){return a>=b-fc.DRAG_BORDER&&a<=b+fc.DRAG_BORDER},clickX:function(){return this._clickX},clickY:function(){return this._clickY},currX:function(){return this._currX},currY:function(){return this._currY},isEditing:function(){return!1},touchManager:function(){return null},activate:function(){this._doActivate()},deactivate:function(){this._doDeactivate()},keyDown:function(a,b,c,d){return this._doKeyDown(a,b,c,d)},keyUp:function(a,b,c,d){return this._doKeyUp(a,b,c,d)},keyPress:function(a){return this._doKeyPress(a)},click:function(a){this._doClick(a.mouseX,a.mouseY)},dblclick:function(a){this._doDblClick(a.mouseX,a.mouseY)},mouseDown:function(a){var b=this._currX=this._clickX=a.mouseX,c=this._currY=this._clickY=a.mouseY;this.isDragging()&&(this._stopDragTracker(b,c,!1),this.setDragTracker(null));var d=oa&&a.metaKey||!oa&&a.ctrlKey;this._doMouseDown(a.mouseX,a.mouseY,d,a.shiftKey,a.button,a)},mouseMove:function(a){var b,c=this._currX=a.mouseX,d=this._currY=a.mouseY,e=this.dragTracker();e?e.isDragging()?("$hasNotButtons"in fc||(fc.$hasNotButtons=ta||ra),fc.$hasNotButtons||a.buttons>0?e.drag(c,d)||(b=e.getNextRequest(c,d),b&&(this._stopDragTracker(c,d,!0),this.setDragTracker(this._getDragTracker(b)),this._startDragTracker(c,d))):this._stopDragTracker(c,d,!0)):na(c-this._clickX)>=fc.DRAG_THRESHOLD||na(d-this._clickY)>=fc.DRAG_THRESHOLD?this._startDragTracker(c,d):this._doMouseMove(c,d):this._doMouseMove(c,d)},mouseUp:function(a){var b=this._currX=a.mouseX,c=this._currY=a.mouseY;return this.isDragging()?void this._stopDragTracker(b,c,!1):void this._doMouseUp(b,c,a)},mouseEnter:function(a){this._doMouseEnter(a.mouseX,a.mouseY)},mouseLeave:function(a){this._doMouseLeave(a.mouseX,a.mouseY)},mouseOver:function(a){this._doMouseOver(a.mouseX,a.mouseY)},mouseOutside:function(){this._doMouseOutside()},mouseWheel:function(a){return xdelta=a.wheelDeltaX?a.wheelDeltaX:0,ydelta=a.wheelDeltaY?a.wheelDeltaY:a.wheelDelta,na(xdelta)>na(ydelta)?(ydelta=0,xdelta=xdelta>0?fc.WHEEL_DOWN:fc.WHEEL_UP):(xdelta=0,ydelta=ydelta>0?fc.WHEEL_DOWN:fc.WHEEL_UP),a.shiftKey?this._doMouseWheel(a.mouseX,a.mouseY,ydelta,xdelta):this._doMouseWheel(a.mouseX,a.mouseY,xdelta,ydelta)},touchStart:function(a){this.touchManager()?this.touchManager().touchStart(a):this._doTouchStart(a)},touchMove:function(a){this.touchManager()?this.touchManager().touchMove(a):this._doTouchMove(a)},touchEnd:function(a){this.touchManager()?this.touchManager().touchEnd(a):this._doTouchEnd(a)},touchCancel:function(a){this.touchManager()?this.touchManager().touchCancel(a):this._doTouchCancel(a)},findElementAt:function(a,b,c){return this._owner.findChildAt(a,b,c)},setFocus:function(){return this._doSetFocus()},_doActivate:function(){aa("tool: activated")},_doDeactivate:function(){aa("tool: deactivated")},_doKeyDown:function(a,b,c,d){return aa("tool: keyDown("+a+")"),!1},_doKeyUp:function(a,b,c,d){return aa("tool: keyUp("+a+")"),!1},_doKeyPress:function(a){aa("tool: keyPress("+a+")")},_doClick:function(a,b){aa("tool: click("+a+","+b+")")},_doDblClick:function(a,b){aa("tool: dblClick("+a+","+b+")")},_doMouseDown:function(a,b,c,d,e,f){aa("tool: mouseDown("+a+","+b+")")},_doMouseMove:function(a,b){aa("tool: mouseMove("+a+","+b+")")},_doMouseUp:function(a,b){aa("tool: mouseUp("+a+","+b+")")},_doMouseEnter:function(a,b){aa("tool: mouseEnter("+a+","+b+")")},_doMouseLeave:function(a,b){aa("tool: mouseLeave("+a+","+b+")")},_doMouseOver:function(a,b){aa("tool: mouseOver("+a+","+b+")")},_doMouseOutside:function(){},_doMouseWheel:function(a,b,c,d){return aa("tool: mouseWheel("+c+","+d+")"),!1},_doTouchStart:function(a){aa("tool: touchStart")},_doTouchMove:function(a){aa("tool: touchMove")},_doTouchEnd:function(a){aa("tool: touchEnd")},_doTouchCancel:function(a){aa("tool: touchCancel")},_startDragTracker:function(a,b){this._dragTracker&&(this._dragTracker.start(a,b)?this._doDragTrackerStarted(this._dragTracker):this._dragTracker=null)},_stopDragTracker:function(a,b,c){if(this.isDragging()){var d=this._dragTracker;c?d.cancel():d.drop(a,b),this.setDragTracker(null),this._doDragTrackerFinished(d,c),this._owner&&this._owner.invalidate&&this._owner.invalidate()}},_doDragTrackerStarted:function(a){aa("dragTracker started: "+a.name())},_doDragTrackerFinished:function(a,b){aa("dragTracker stopped: "+a.name()+", "+(b?"canceled":"completed"))},_doSetFocus:function(){}},{DRAG_BORDER:2,DRAG_THRESHOLD:3,WHEEL_UP:-60,WHEEL_DOWN:60})),gc=".",hc=",",ic=Ga("DecimalFormatter",null,{init:function(a){this._super(),this._minDigits=0,this._maxDigits=0,this._minInts=0,this._maxInts=0,this._optDecimal=!1,this._groupPos=0,this._seperator=null,this._groupSep=null,this._reg=null,this._regDecimal=null,this._replacement="$&,",this._parse(a)},format:function(a){var b=Number(a);if(isNaN(b))return"";var c=this._minDigits;if(this._optDecimal){var d=S(b);c=Math.min(Math.max(d,this._minDigits),this._maxDigits)}b=Number(b.toPrecision(15));var e=b.toFixed(c);return this._seperator&&(e=e.replace(gc,this._seperator)),this._reg?c?e.replace(this._regDecimal,this._replacement):e.replace(this._reg,this._replacement):e},_parse:function(a){if(a&&(a=a.trim()),a){var b=gc,c=hc;if(a.indexOf(";")>-1){var d=a.split(";");a=d[0],d.length>1&&d[1]&&(b=d[1]),d.length>2&&d[2]&&(c=d[2])}this._seperator=b==gc?null:b,this._groupSep=c==hc?null:c;var e,f,g=a.length,h=a.indexOf(gc);if(this._optDecimal=a.indexOf("#",h)>0,h>=0){for(e=h+1;g>e&&"0"==a.charAt(e);e++)this._minDigits++,this._maxDigits++;for(;g>e&&"#"==a.charAt(e);e++)this._maxDigits++;a=a.substr(0,h)}if(a&&(g=a.length,a.charAt(g-1)==hc&&(this._groupPos=3,a=a.substr(0,g-1))),a){g=a.length;var i=!0;for(e=g-1;e>=0;e--)if(f=a.charAt(e),"0"==f&&i)this._minInts++,this._maxInts++;else if(0==this._groupPos&&f==hc)this._groupPos=g-e-1;else{if("#"!=f)break;i=!1}}this._groupPos>0&&(this._replacement="$&"+c,this._reg=new RegExp("\\d(?=(\\d{"+this._groupPos+"})+($|\\"+b+"))","g"),this._regDecimal=new RegExp("\\d(?=(\\d{"+this._groupPos+"})+\\"+b+")","g"))}}},{PerformTest:function(a,b){for(var c=new ic(a),e=d(),f=0;b>f;f++)c.format(1234567.1234);e=d()-e,aa("##### DecimalFormat PerformTest Result : "+e+" msces.")},Test:function(a,b){var c=new ic(a),d=c.format(b);aa("##### DecimalFormat Test Result : "+d)}}),jc=(Ga("BooleanFormatter",null,{init:function(a){this._super(),this._format=a,this._nullText=null,this._trueText=null,this._falseText=null,this._parse()},format:null,setFormat:function(a){a!=this._format&&(this._format=a,this._parse())},formatValue:function(a){return a===va?this._nullText:a?this._trueText:this._falseText},_parse:function(){if(this._falseText=this._trueText=null,this._format){var a=this._format.split(/[;\:]/);this._falseText=a[0],a.length>0&&(this._trueText=a[1]),a.length>1&&(this._nullText=a[2])}}}),function(a){var b=a,c=null,d=!0,e=null,f=null;this.format=function(){return b},this.setFormat=function(a){a!=b&&(b=a,g(a))},this.toBool=function(a){if(c&&a){var b=d?String(a):String(a).toLowerCase();if(b in c)return c[b]}return Boolean(a)},this.toBoolEx=function(a){var b=d?String(a):String(a).toLowerCase();return c&&b in c?c[b]:b?Boolean(b):void 0},this.toBoolStrict=function(a){if(c){var b=d?String(a):String(a).toLowerCase();if(b in c)return c[b]}return void 0},this.toText=function(a){return a?e:f};var g=function(a){if(a){var b,g,h,i,j=a.split(/[;\:]/),k=!0;for(b=j[0],h=b?b.split(","):null,j.length>1&&(b=j[1],i=b?b.split(","):null),j.length>2&&(b=ha(j[2]),"0"==b&&(k=!1)),c={},d=k,g=0;g<h.length;g++)b=h[g],c[k?b:b.toLowerCase()]=!1;for(g=0;g<i.length;g++)b=i[g],c[k?b:b.toLowerCase()]=!0;e=i&&i.length>0?i[0]:"true",f=h&&h.length>0?h[0]:"false"}else c={},c["true"]=!0,c["false"]=!1,e="true",f="false"};g(b)});jc.Default=new jc("false,f,0:true,t,1:0");var kc="./-: ",lc=Ga("DateTimeParser",null,{init:function(a){this._super(),this._baseYear=0,this._patterns=[],this.setFormat(a)},format:null,baseYear:2e3,amText:"AM",pmText:"PM",setFormat:function(a){if(a!=this._format){if(!a)throw"Invalid empty date format";this.$_parseFormat(a),this._format=a}},setBaseYear:function(a){a!=this._baseYear&&(this._baseYear=a)},setAmText:function(a){a!=this._amText&&(this._amText=a)},setPmText:function(a){a!=this._pmText&&(this._pmText=a)},parse:function(a){try{var b,c=0,d=1,e=1,f=0,g=0,h=0,i=0,j=0,k=0,l=this._patterns.length,m=0,n=a.length;for(b=0;l>b&&n>m;b++){var o=this._patterns[b],p=o.c,q=o.len;switch(p){case"y":c=ja(a.substr(m,q));break;case"M":d=ja(a.substr(m,q));break;case"d":e=ja(a.substr(m,q));break;case"a":
if(this._amText&&a.indexOf(this._amText,m)==m)j=12,q=this._amText.length;else{if(!this._pmText||a.indexOf(this._pmText,m)!=m)return null;k=12,q=this._pmText.length}break;case"H":f=ja(a.substr(m,q));break;case"h":f=ja(a.substr(m,q));break;case"m":g=ja(a.substr(m,q));break;case"s":h=ja(a.substr(m,q));break;case"S":i=ja(a.substr(m,q));break;case".":case"/":case"-":case":":case" ":if(kc.indexOf(a.charAt(m))<0)return null;break;default:return null}m+=q}}catch(r){return null}return 100>c&&(c+=this._baseYear),j>0?12==f&&(f=0):k>0&&12>f&&(f+=12),new Date(c,d-1,e,f,g,h,i)},$_parseFormat:function(a){var b,c,d,e=a,f=e.length,g=0;for(this._patterns=[];f>g;)if(b=g,c=e.charAt(g),z(c)){for(g++;f>g&&z(e.charAt(g));)g++;this._patterns.push({c:" ",p:b,len:g-b})}else{switch(d=0,c){case"y":d=this.$_getPattern(e,g,c),4!=d&&2!=d&&this.$_throwInvalidFormat(e);break;case"M":case"d":case"H":case"h":case"m":case"s":d=this.$_getPattern(e,g,c),2!=d&&this.$_throwInvalidFormat(e);break;case"S":d=this.$_getPattern(e,g,c),3!=d&&this.$_throwInvalidFormat(e);break;case"a":case".":case"/":case"-":case":":d=this.$_getPattern(e,g,c),1!=d&&this.$_throwInvalidFormat(e);break;default:this.$_throwInvalidFormat(e)}d>0&&(this._patterns.push({c:c,p:g,len:d}),g+=d)}},$_throwInvalidFormat:function(a){throw"Invalid date format: "+a},$_throwInvalidValue:function(a){throw"Invalid date text: "+a},$_getPattern:function(a,b,c){for(var d=1;++b<a.length&&a.charAt(b)==c;)d++;return d}}),mc=["yy","yyyy","M","MM","d","dd","a","H","HH","h","hh","m","mm","s","ss","S","SS","SSS"],nc=[".","/","-",":"],oc=("0".charCodeAt(0),"9".charCodeAt(0),"Z".charCodeAt(0)),pc="z".charCodeAt(0),qc="A".charCodeAt(0),rc="a".charCodeAt(0),sc=("Y".charCodeAt(0),"y".charCodeAt(0)),tc="M".charCodeAt(0),uc="m".charCodeAt(0),vc=("D".charCodeAt(0),"d".charCodeAt(0)),wc="H".charCodeAt(0),xc="h".charCodeAt(0),yc="S".charCodeAt(0),zc="s".charCodeAt(0),Ac=function(a){var b=null,c=null,d=null,e=null,f=!1,g=null,h=function(a){var b=[];if(a)for(var c,d,e,f=a.trim(),g=f.length,h=0;g>h;){if(c=f.charAt(h),nc.indexOf(c)>=0)b.push(c),h++;else{for(d=h++;g>h&&f.charAt(h)==c;)h++;if(c=f.substring(d,h),mc.indexOf(c)<0&&(e=c.charCodeAt(0),e>=qc&&oc>=e||e>=rc&&pc>=e))throw new Error("Invalid datetime write format: "+a);b.push(c)}if(g>h&&z(c=f.charAt(h)))for(b.push(c);g>h&&z(f.charAt(h));)h++}return b},i=function(a){if(c="AM",d="PM",a){var g=a.split(";");if(b=g[0]||Ac.$_DefaultFormat,e=h(b),f=e.indexOf("a")>=0||e.indexOf("A")>=0,g.length>1&&g[1]){var i=g[1].split(",");i.length>0&&i[0]&&(c=i[0]),i.length>1&&i[1]&&(d=i[1])}}},j=function(a){return 10>a?"0"+a:String(a)};this.format=function(){return b},this.formatString=function(){return g},this.setFormatString=function(a){a=a||Ac.$_DefaultFormat,a!=g&&(e=[],i(a),g=a)},this.getText=function(a){if(!e)return"";var b=a;b instanceof Date||(b=new Date(a));for(var g,h="",i=0,k=e.length;k>i;i++){var l=e[i],m=l.length;switch(l.charCodeAt(0)){case sc:h+=m>2?b.getFullYear():j(b.getFullYear()%100);break;case tc:h+=m>1?j(b.getMonth()+1):b.getMonth()+1;break;case vc:h+=m>1?j(b.getDate()):b.getDate();break;case wc:h+=m>1?j(b.getHours()):b.getHours();break;case xc:f?(g=b.getHours(),0==g?g=12:g>12&&(g-=12),h+=m>1?j(g):g):h+=m>1?j(b.getHours()):b.getHours();break;case uc:h+=m>1?j(b.getMinutes()):b.getMinutes();break;case zc:h+=m>1?j(b.getSeconds()):b.getSeconds();break;case rc:case qc:h+=b.getHours()<12?c:d;break;case yc:h+=b.getMilliseconds().toString().substr(0,m);break;default:h+=l}}return h},this.setFormatString(a||Ac.$_DefaultFormat)};Ac.$_DefaultFormat="yyyy/MM/dd",Ac.Default=new Ac(Ac.$_DefaultFormat);var Bc=["yy","yyyy","M","MM","d","dd","a","A","H","HH","h","hh","m","mm","s","ss"],Cc=[".","/","-",":"],Dc="0".charCodeAt(0),Ec="9".charCodeAt(0),Fc=6048e5,Gc=new Date,Hc=function(a){var b=null,c=null,d=null,e=null,f=2e3,g=!1,h=function(a){var b,c=[];if(b=A(a)){for(var d,e,f=b.length,g=0;f>g;){if(d=b.charAt(g),Cc.indexOf(d)>=0)c.push(d),g++;else{for(e=g++;f>g&&b.charAt(g)==d;)g++;if(d=b.substring(e,g),Bc.indexOf(d)<0)throw new Error("Invalid datetime read format: "+a);c.push("A"==d?"a":d)}if(f>g&&z(d=b.charAt(g)))for(c.push(" ");f>g&&z(b.charAt(g));)g++}var h=[];for(f=c.length,e=0,g=0;f>g;g++)d=c[g],"a"==d||Bc.indexOf(d)<0?(e>1&&h.push("E"),h.push(d),e=0):(1==e&&h.splice(h.length-2,0,"L"),h.push(d),e++);c=h}return c},i=function(a,b,c){var d,e=[],f=["am","pm","AM","PM","Am","Pm","aM","pM"];if(b&&f.push(b),c&&f.push(c),d=A(a))for(var g,h,i=d.length,j=0;i>j;){if(g=d.charAt(j),kc.indexOf(g)>=0)e.push(g),j++;else if(g.charCodeAt(0)>=Dc&&g.charCodeAt(0)<=Ec){for(h=j++;i>j&&d.charCodeAt(j)>=Dc&&d.charCodeAt(j)<=Ec;)j++;g=d.substring(h,j),e.push(g)}else{for(var k=-1,l=0;l<f.length;l++)if(d.indexOf(f[l],j)==j){k=l;break}if(0>k)throw"Invalid date value: "+d;e.push(f[l]),j+=f[l].length}if(i>j&&z(g=d.charAt(j)))for(e.push(" ");i>j&&z(d.charAt(j));)j++}return e},j=function(a){if(a=A(a)){var b=h(a),c=b.indexOf("a")>=0;if(c&&b.indexOf("H")>=0)throw"Invalid datetime read format - 'H'와 'a'가 같이 존재할 수 없습니다: "+a;if(b.indexOf("h")>=0&&!c)throw"Invalid datetime read format - 'h'가 있으면 'a'가 반드시 있어야 합니다: "+a}},k=function(a){if(d="am",e="pm",f=2e3,g=!1,a){var b=a.split(";");if(c=b[0]?b[0]:_defaultFormat,j(c),b.length>1&&b[1]&&(f=ja(b[1])),b.length>2&&b[2]){var h=b[2].split(",");d=h[0]?h[0]:"am",h.length>1&&(e=h[1]?h[1]:"pm")}b.length>3&&(g=b[3]?"1"==b[3]:!1)}};this.formatString=function(){return b},this.setFormatString=function(a){a!=b&&(b=a,k(a))},this.format=function(){return c},this.getDate=function(a){var b=null;if(a=A(a)){for(var g,j=h(c),k=i(a,d,e),l=(j.indexOf("a")>=0||j.indexOf("A")>=0,j.length),m=k.length,n=0,o=1,p=1,q=0,r=0,s=0,t=0,u=0,v=0,w=0;l>v&&m>w;){var x=j[v],y=k[w];switch(x.charAt(0)){case"L":for(g=String(y),v++;l>v&&"E"!=(a=j[v]);){switch(y=g?ja(g.substr(0,a.length)):-1,g=g.substr(a.length),a.charAt(0)){case"Y":case"y":n=Math.max(0,y);break;case"M":o=y>=0?y:1;break;case"D":case"d":p=y>=0?y:1;break;case"H":case"h":q=Math.max(0,y);break;case"m":r=Math.max(0,y);break;case"s":s=Math.max(0,y)}v++}break;case"Y":case"y":n=ja(y);break;case"M":o=ja(y);break;case"D":case"d":p=ja(y);break;case"H":case"h":q=ja(y);break;case"m":r=ja(y);break;case"s":s=ja(y);break;case"a":a=String(y),a&&(a=a.toLowerCase(),d&&a==d.toLowerCase()||"am"==a?t=12:(e&&a==e.toLowerCase()||"pm"==a)&&(u=12))}v++,w++}if(100>n&&n>=0&&(n+=f),0>n||n>9999)return null;if(1>o||o>12)return null;if(1>p||p>31)return null;if(2==o){if(p>29)return null;if(29==p&&(n%4!=0||n%100==0)&&n%400!=0)return null}if(0>q||q>24)return null;if((t>0||u>0)&&q>12)return null;if(0>r||r>59)return null;if(0>s||s>59)return null;t>0?q%=12:u>0&&(q=q%12+12),b=new Date(n,o-1,p,q,r,s)}return b},this.getDateNull=function(a){try{return this.getDate(a)}catch(b){}return null},this.getText=function(a){var b=a;b instanceof Date||(b=new Date(a));for(var f,g=h(c),i=g.indexOf("a")>=0||g.indexOf("A")>=0,j="",k=0,l=g.length;l>k;k++){var m=g[k],n=m.length;switch(m.charAt(0)){case"L":break;case"Y":case"y":j+=n>2?b.getFullYear():fa(b.getFullYear()%100);break;case"M":j+=n>1?fa(b.getMonth()+1):b.getMonth()+1;break;case"D":case"d":j+=n>1?fa(b.getDate()):b.getDate();break;case"H":j+=n>1?fa(b.getHours()):b.getHours();break;case"h":i?(f=b.getHours(),0==f?f=12:f>12&&(f-=12),j+=n>1?fa(f):f):j+=n>1?fa(b.getHours()):b.getHours();break;case"m":j+=n>1?fa(b.getMinutes()):b.getMinutes();break;case"s":j+=n>1?fa(b.getSeconds()):b.getSeconds();break;case"A":case"a":j+=b.getHours()<12?d:e;break;default:j+=m}}return j},this._daysOfYear=function(a){for(var b=[31,28,31,30,31,30,31,31,30,31,30],c=0,d=0;d<a.getMonth();d++)c+=b[d];if(a.getMonth()>=2){var e=a.getFullYear();(e%400==0||e%4==0&&e%100!=0)&&c++}return c+=a.getDate()},this._daysOfPriorYears=function(a){if(1900>=a)return 0;a--;var b=parseInt(a/4)-parseInt(a/100)+parseInt(a/400)-460;return 365*(a-1899)+b},this.toExcelDate=function(a){var b=864e5,c=(1e3*(60*(60*a.getHours()+a.getMinutes())+a.getSeconds())+a.getMilliseconds())/b,d=this._daysOfPriorYears(a.getFullYear())+this._daysOfYear(a),e=d+c;return e>=60&&e++,e},this.getDateValue=function(a,b){if(!v(a))return null;switch(b){case Nc.YEAR:return a.getFullYear();case Nc.HALF:return a.getMonth()>5?2:1;case Nc.QUARTER:return ia(a.getMonth()/3)+1;case Nc.MONTH:return a.getMonth()+1;case Nc.WEEKOFYEAR:var c=new Date(a.getFullYear(),0,1);return c.setDate(c.getDate()-c.getDay()),ia((a-c)/Fc)+1;case Nc.WEEKOFMONTH:var c=new Date(a.getFullYear(),a.getMonth(),1);return c.setDate(c.getDate()-c.getDay()),ia((a-c)/Fc)+1;case Nc.WEEKDAY:return a.getDay();case Nc.DAY:return a.getDate();case Nc.HOUR:return a.getHours()}},this.setFormatString(a)};Hc.$_DefaultFormat="yyyy/MM/dd",Hc.Default=new Hc(Hc.$_DefaultFormat);var Ic=function(){},Jc=60*Gc.getTimezoneOffset()*1e3;Ic.parse=function(a,b){var c=null;try{var d,e,f,g,h=a.indexOf("T"),i=a.substring(0,h),j=a.substring(h+1),k=i.split("-"),l=k.length,m=ja(k[0]),n=l>1?ja(k[1]):1,o=l>2?ja(k[2]):1;-1!=j.indexOf("Z")?(d=1,e=0,f=0,j=j.replace("Z","")):-1!=j.indexOf("+")?(d=1,g=j.substring(j.indexOf("+")+1,j.length),e=Number(g.substring(0,g.indexOf(":"))),f=Number(g.substring(g.indexOf(":")+1,g.length)),j=j.substring(0,j.indexOf("+"))):-1!=j.indexOf("-")?(d=-1,g=j.substring(j.indexOf("-")+1,j.length),e=Number(g.substring(0,g.indexOf(":"))),f=Number(g.substring(g.indexOf(":")+1,g.length)),j=j.substring(0,j.indexOf("-"))):d=0;var p=j.split(":");l=p?p.length:0;var q=l>0?ja(p[0]):0,r=l>1?ja(p[1]):0,s=l>2?String(p[2]).split("."):null,t=s&&s.length>0?ja(s[0]):0,u=s&&s.length>1?1e3*parseFloat("0."+s[1]):0,v=Date.UTC(m,n-1,o,q,r,t,u),w=d?(36e5*e+6e4*f)*d:-Jc;if(c=new Date(v-w),b&&isNaN(c.getTime()))throw"Invalidate date text: "+a}catch(x){if(b){var y="Invalid date Text: "+a;throw y+="\nError: "+x.toString()}}return c};var Kc=function(a){var b=null,c=0,d=new lc,e=function(a){if(a){var b=a.toLowerCase();c=Math.max(0,Kc.FORMATS.indexOf(b)),0==c&&d.setFormat(a)}};this.format=function(){return b},this.setFormat=function(a){a!=b&&(b=a,e(a))},this.amText=function(){return d.amText()},this.setAmText=function(a){d.setAmText(a)},this.pmText=function(){return d.pmText()},this.setPmText=function(a){d.setPmText(a)},this.baseYear=function(){return d.baseYear()},this.setBaseYear=function(a){d.setBaseYear(a)},this.toDate=function(a){if(void 0===a||null===a||""===a)return null;var b=a;if(!(b instanceof Date)){var e=String(a);if(e)switch(c){case 0:b=d.parse(e);break;case 1:b=Ic.parse(e);break;case 2:default:b=new Date(e)}}return b?isNaN(b.getTime())?null:b:null},this.setFormat(a)};Kc.FORMATS=["custom","iso","platform"],Kc.Default=new Kc("yyyy/MM/dd HH:mm:ss"),Kc.Default.setAmText("AM"),Kc.Default.setPmText("PM"),Kc.Default.setBaseYear(2e3),ExcelFormatConverter=Ga("ExcelFormatConverter",null,{},{convertNumberFormat:function(a){return a.indexOf(".#")>0?a.replace(".#",".0"):a},convertDateFormat:function(a){for(var b="",c=a.length,d=0;c>d;d++){var e=a.charAt(d);switch(e){case"y":case"d":case"m":case"s":case":":b+=e;break;case"M":b+="m";break;case"a":b+="AM/PM";break;case"H":b+="h",(d>=c-1||"H"!=a.charAt(d+1))&&(b+="h");break;case"h":(0==d||"h"!=a.charAt(d-1))&&(b+="h");break;case"S":break;case".":case"/":case"-":case" ":(d>=c-1||"S"!=a.charAt(d+1))&&(b=b+"\\"+e);break;default:b=b+'"'+e+'"'}}return b}}),ExcelFormatConverter.Default=new ExcelFormatConverter;var Lc=P({COLUMN:"column",ROW:"row",VALUE:"value"}),Mc=P({SUM:"sum",COUNT:"count",MIN:"min",MAX:"max",AVERAGE:"avg",DISTINCT:"distinct"}),Nc=P({YEAR:"year",HALF:"half",QUARTER:"quarter",MONTH:"month",WEEKOFYEAR:"weekofyear",WEEKOFMONTH:"weekofmonth",WEEKDAY:"weekday",DAY:"day",HOUR:"hour"}),Oc=P({ALL:"all",EXPRESSION:"expression",ITEMS:"items"}),Pc=P({AND:"and",OR:"or"}),Qc=P({LABEL:"label",VALUE:"value"}),Rc=P({NONE:"none",ASCENDING:"ascending",DESCENDING:"descending"}),Sc=Ga("PivotField",null,{init:function(a,b){this._super(),this._owner=a,this._dataSource=a.getDataSource(),this._orgField=null,this._sourceFieldIndex=za,this._displayFieldIndex=za,this._formatter=null,b&&this.assign(b)},destroy:function(){this._owner=null,this._dataSource=null,this._orgField=null,this._super()},name:null,sourceField:null,fieldHeader:null,fieldType:null,dateType:null,labelEnable:!0,valueEnable:!0,filterEnable:!0,displayLabels:null,displayFormat:null,displayField:null,summaryHeader:null,summaryFormat:null,sortDir:Rc.NONE,expression:null,numberFormat:null,prefix:null,suffix:null,setDateType:function(a){this._orgField.dataType()==Grids.ValueType.DATETIME?this._dateType=a:this._dateType=null},setSourceField:function(a){this._sourceField!=a&&(this._sourceField=a,a?(this._sourceFieldIndex=this._dataSource.getFieldIndex(a),this._orgField=this._dataSource.getField(this._sourceFieldIndex),ba(this._sourceFieldIndex>za,"sourceField is not found in dataProvider.")):(this._sourceFieldIndex=za,this._orgField=null))},setDisplayField:function(a){this._displayField!=a&&(this._displayField=a,a?(this._displayFieldIndex=this._dataSource.getFieldIndex(a),ba(this._displayFieldIndex>za,"displayField is not found in dataProvider.")):this._displayFieldIndex=za)},setDisplayLabels:function(a){a?this._displayLabels=D(a):this._displayLabels=null},getDisplayLabels:function(){return this._displayLabels?D(this._displayLabels):null},setNumberFormat:function(a){a!=this._numberFormat&&(a&&(this._formatter?this._formatter._parse(a):this._formatter=new ic(a)),this._numberFormat=a)},assign:function(a){ba(a.name,"name is not defined."),ba(a.sourceField,"sourceField is not defined."),this._super(a),this._orgField&&this._orgField.dataType()==Grids.ValueType.NUMBER&&!this._numberFormat&&this.setNumberFormat("#0")},getOrgIndex:function(){return this._sourceFieldIndex},getFieldHeader:function(){return this._fieldHeader?this._fieldHeader:this._name},getDataType:function(){return this._orgField.dataType()},getSummaryLabel:function(a,b){return this._summaryFormat?this._summaryFormat.replace("${value}",a).replace("${label}",b):this._summaryHeader?this._summaryHeader:a},getDisplayText:function(a){var b;return this._formatter&&(b=this._formatter.format(a)),this._prefix&&(b=this._prefix+a),this._suffix&&(b+=this._suffix),b}}),Tc=Ga("PivotFieldManager",null,{init:function(a){this._super(),this._owner=a,this._fields=[],this._columns=[],this._rows=[],this._values=[],this._valueSort={}},destroy:function(){this.clear(),this._owner=null,this._super()},$_fillFieldList:function(a,b,c){var d;if(b)for(var e=0,f=b.length;f>e;e++)d=h(b[e])?this.getFieldByName(b[e]):this.getFieldByName(b[e].name),d&&(a==Lc.VALUE&&d.setExpression(b[e].expression?b[e].expression:Mc.SUM),d.setFieldType(a),a!=Lc.VALUE&&d.setSortDir(b[e].direction?b[e].direction:Rc.ASCENDING),d&&c.push(d))},$_packFieldList:function(a,b){for(var c,d=[],e=0,f=b.length;f>e;e++)c=b[e],a==Lc.VALUE?d.push({name:c.name(),expression:c.expression()}):d.push(c.name());return d},clear:function(){var a,b;this._columns=[],this._rows=[],this._values=[],this._sortMethod=Qc.LABELS,this._colDirFlds=[],this._rowDirFlds=[],this._colCondFlds=[],this._rowCondFlds=[],this._valueField=null;for(var a=0,b=this._fields.length;b>a;a++)this._fields[a].destroy(),delete this._fields[a];this._fields=[]},fieldCount:function(){return this._fields.length},getField:function(a){return this._fields[a]},getFieldByName:function(a){for(var b=0,c=this._fields.length;c>b;b++)if(this._fields[b].name()==a)return this._fields[b];return null},columnCount:function(){return this._columns.length},getColumn:function(a){return this._columns[a]},getColumns:function(){return this._columns},rowCount:function(){return this._rows.length},getRow:function(a){return this._rows[a]},getRows:function(){return this._rows},valueCount:function(){return this._values.length},getValueNames:function(){for(var a=[],b=0,c=this._values.length;c>b;b++)a.push(this._values[b].name());return a},getValue:function(a){return this._values[a]},getValues:function(){return this._values},setFieldMapping:function(a){var b,c;for(this.clear(),b=0,c=a.length;c>b;b++){var d=new Sc(this._owner,a[b]);this._fields.push(d)}},setPivotFields:function(a){this._columns=[],this._rows=[],this._values=[],this.$_fillFieldList(Lc.COLUMN,a.columns,this._columns),this.$_fillFieldList(Lc.ROW,a.rows,this._rows),this.$_fillFieldList(Lc.VALUE,a.values,this._values)},getPivotFields:function(a){return{columns:this.$_packFieldList(Lc.COLUMN,this._columns),rows:this.$_packFieldList(Lc.ROW,this._rows),values:this.$_packFieldList(Lc.VALUE,this._values)}},clearSort:function(){for(var a=this._fields.length;a--;)this._fields[a].setSortDir(Rc.NONE);this._valueSort={}},clearValueSort:function(){this._valueSort={}},setValueSort:function(a,b,c,d){this._valueSort[a]||(this._valueSort[a]={});var e=this._valueSort[a];this.getFieldByName(b);e.fieldName=b,e.direction=c,e.conditions=E(d)},getValueSort:function(a){return this._valueSort[a]},getFieldSortDir:function(a,b){if(a==Lc.VALUE){var c=this._valueSort[Lc.COLUMN],d=this._valueSort[Lc.ROW];return c&&c.fieldName==b?c.direction:d&&d.fieldName==b?d.direction:Rc.NONE}var e=this._valueSort[a];return e?Rc.NONE:this.getFieldByName(b).sortDir()}}),Uc=(Ga("PivotFieldManager",null,{init:function(a){this._super(),this._fieldManager=a,this.clear()},destroy:function(){this.clear(),this.fieldManager=null,this._super()},$_fillSortLabels:function(a,b,c){for(var d=0,e=a.length;e>d;d++){b.push(a[d].name);var f=a[d].direction?a[d].direction:Rc.ASCENDING,g=this._fieldManager.getFieldByName(a[d].name);g.setSortDir(f),c.push(f)}},$_fillSortConditions:function(a,b,c){for(var d=0,e=a.length;e>d;d++)b.push(a[d].name),c.push(a[d].value)},$_packSortLabels:function(a,b){for(var c=[],d=0,e=a.length;e>d;d++)c.push({name:a[d],direction:b[d]});return c},$_packSortConditions:function(a,b){for(var c=[],d=0,e=a.length;e>d;d++)c.push({name:a[d],direction:b[d]});return c},clear:function(){this._colSortMethod=Qc.LABEL,this._rowSortMethod=Qc.LABEL,this._colValueField=null,this._colValueDir=Rc.NONE,this._rowValueField=null,this._rowValueDir=Rc.NONE,this._colFlds=[],this._rowFlds=[],this._colDirs=[],this._rowDirs=[],this._colCondFlds=[],this._rowCondFlds=[],this._colCondVals=[],this._rowCondVals=[]},setValues:function(a){this.clear(),a&&(a.column&&(a.column.method&&(this._colSortMethod=a.column.method),this._colSortMethod==Qc.LABEL?(this.$_fillSortLabels(a.column.labels,this._colFlds,this._colDirs),this._colValueField=null):(this.$_fillSortConditions(a.column.conditions,this._colCondFlds,this._colCondVals),this._colValueField=a.column.fieldName,this._colValueDir=a.column.direction?a.column.direction:Rc.ASCENDING)),a.row&&(a.row.method&&(this._rowSortMethod=a.row.method),this._colSortMethod==Qc.LABEL?(this.$_fillSortLabels(a.row.labels,this._rowFlds,this._rowDirs),this._rowValueField=null):(this.$_fillSortConditions(a.row.conditions,this._rowCondFlds,this._rowCondVals),this._rowValueField=a.row.fieldName,this._rowValueDir=a.row.direction?a.column.direction:Rc.ASCENDING)))},getValues:function(){var a={method:this._sortMethod};switch(this._sortMethod){case Qc.COL_VALUES:a.columns=this.$_packSortLabels(this._colFlds,this._colDirs),a.rows=this.$_packSortConditions(this._rowCondFlds,this._rowCondVals);break;case Qc.ROW_VALUES:a.columns=this.$_packSortConditions(this._colCondFlds,this._colCondVals),a.rows=this.$_packSortLabels(this._rowFlds,this._rowDirs);break;default:a.columns=this.$_packSortLabels(this._colFlds,this._colDirs),a.rows=this.$_packSortLabels(this._rowFlds,this._rowDirs)}this._sortMethod!=Qc.LABELS&&(this._valueField=source.value.name,this._valueDir=source.value.direction?source.value.direction:Rc.ASCENDING)},isSorted:function(){return this._colFlds.length>0||this._rowFlds.length>0},getColFldCount:function(){return this._colFlds.length},getRowFldCount:function(){return this._rowFlds.length},getColCondCount:function(){return this._colCondFlds.length},getRowCondCount:function(){return this._rowCondFlds.length},getColFld:function(a){return[this._colFlds[a],this._colDirs[a]]},getRowFld:function(a){return[this._rowFlds[a],this._rowDirs[a]]},getColCondFld:function(a){return[this._colCondFlds[a],this._colCondVals[a]]},getRowCondFld:function(a){return[this._rowCondFlds[a],this._rowCondVals[a]]},getValueFld:function(){return[this._valueField["this"]._valueDir]},getColDir:function(a){var b;return(b=this._colFlds.indexOf(a))>-1?this._colDirs[b]:Rc.NONE},getRowDir:function(a){var b;return(b=this._rowFlds.indexOf(a))>-1?this._rowDirs[b]:Rc.NONE},getColDirs:function(){return this._colDirs.slice(0)},getRowDirs:function(){return this._rowDirs.slice(0)}}),Ga("FilterItem",null,{init:function(){this._super(),this._exprNode=null,this._field=null},destroy:function(){this._exprNode=null,this._field=null,this._super()},type:Oc.ALL,field:null,values:null,getValues:function(){return this._values?this._values.slice(0):null},criteria:null,setCriteria:function(a){a?this._exprNode=tb.Default.parse(a,null):this._exprNode=null,this._criteria=a},parse:function(a){if(a.criteria)this._type=Oc.EXPRESSION,this.setCriteria(a.criteria);else if("all"==a.values)this._type=Oc.ALL;else if(this._values=[],this._type=Oc.ITEMS,k(a.values))for(var b=0,c=a.values.length;c>b;b++)this._values.push(a.values[b]);else this._values.push(a.values)},toObject:function(){var a={};switch(a.name=this._field.fieldName(),this._type){case Oc.ALL:a.values="all";break;case Oc.EXPRESSION:a.criteria=this._criteria;break;case Oc.ITEMS:a.values=this._values.slice(0)}return a},checkExpress:function(a,b){return this._exprNode?(a.setData(b),this._exprNode.evaluate(a)):!1},checkInclude:function(a){return this._values&&this._values.length>0?this._values.indexOf(a)>-1:!1}})),Vc=Ga("FilterManager",null,{init:function(a){this._super(),this._owner=a,this._filters=[],this._fieldManager=a.fieldManager()},destroy:function(){this.$_clear(),this._super()},operation:Pc.AND,$_clear:function(){for(var a=this._filters.length;a--;){this._filters[a].field();this._filters[a].destroy(),delete this._filters[a]}this._filters=[]},count:function(){return this._filters.length},getFilter:function(a){return this._filters[a]},parse:function(a){this._operation=a.operation?a.operation:Pc.AND,this.$_clear();for(var b=0,c=a.conditions.length;c>b;b++){var d=new Uc,e=this._fieldManager.getFieldByName(a.conditions[b].name);ba(null!=e,"[filter] Not found field. ("+a.conditions[b].name+")"),d.setField(e),d.parse(a.conditions[b]),this._filters.push(d)}},toObject:function(){if(this._filters.length>0){var a={};a.operation=this._operation,a.conditions=[];for(var b=0,c=this._filters.length;c>b;b++){var d=this._filters[b];a.conditions.push(d.toObject())}return a}return null},select:function(a,b){for(var c=!0,d=0,e=this._filters.length;e>d;d++){var f=this._filters[d],g=!0;switch(f._type){case Oc.ALL:break;case Oc.EXPRESSION:var h=this._owner._getPivotValue(b,f.field());g=f.checkExpress(a,h);break;case Oc.ITEMS:var h=this._owner._getPivotValue(b,f.field());g=f.checkInclude(h)}c=this._operation==Pc.AND?c&&g:c||g}return c}}),Wc={};Wc[Mc.SUM]=function(a,b){return f(a)?a+b:b},Wc[Mc.COUNT]=function(a,b){return f(a)?a+b:b},Wc[Mc.MIN]=function(a,b){return f(a)?la(a,b):b},Wc[Mc.MAX]=function(a,b){return f(a)?ma(a,b):b},Wc[Mc.AVERAGE]=function(a,b){return f(a)?a+b:b},Wc[Mc.DISTINCT]=function(a,b){return f(b)?b:a};var Xc=Ga("PivotDataProvider",Ka,{init:function(){this._super(),this._dataSource=null,this._fieldManager=new Tc(this),this._columnLeafCount=0,this._rowLeafCount=0,this._columnLabels=[],this._rowLabels=[],this._baseValues=[],this._filteredValues=[],this._values=[],this._summaries=[],this._filters=new Vc(this),this._filterRuntime=new vb},destroy:function(){this._filterRuntime=null,xa.freeAndNull(this._filters),this._rowLabels=null,this._coumnLabels=null,this._values=null,this._summaries=null,this._baseValues=null,this._filteredValues=null,xa.freeAndNull(this._fieldManager),this._dataSource&&this._dataSource.removeListener(this),this._dataSource=null,this._super()},_getPivotValue:function(a,b){var c=a[b.getOrgIndex()];return null!=b.dateType()&&(c=Hc.Default.getDateValue(c,b.dateType())),c},$_compareByValue:function(a,b){return a.value>b.value?1:b.value>a.value?-1:0},$_compareDescByValue:function(a,b){return a.value>b.value?-1:b.value>a.value?1:0},$_compareByRefValue:function(a,b){return a.refValue>b.refValue||!b.hasOwnProperty("refValue")?1:b.refValue>a.refValue||!a.hasOwnProperty("refValue")?-1:0},$_compareDescByRefValue:function(a,b){return a.refValue>b.refValue?-1:b.refValue>a.refValue?1:0},$_getColumnLabels:function(a,b,c,d,e,f,g){var h=[],i=this.getDistinctValues(b[a],b.slice(0,a),c,!0,e?e:b[a].sortDir(),d,f,g);this._columnLeafCount+=i.length;for(var j=0,k=i.length;k>j;j++){var l=D(i[j]);a<b.length-1&&(l.childs=this.$_getColumnLabels(a+1,b,c.concat(i[j].value),d,e,f,g)),h.push(l)}return i=[],h},$_getRowLabels:function(a,b,c,d,e,f,g){var h=[],i=this.getDistinctValues(b[a],b.slice(0,a),c,!0,e?e:b[a].sortDir(),d,f,g);this._rowLeafCount+=i.length;for(var j=0,k=i.length;k>j;j++){var l=D(i[j]);a<b.length-1&&(l.childs=this.$_getRowLabels(a+1,b,c.concat(i[j].value),d,e,f,g)),h.push(l)}return i=[],h},$_extractLabels:function(){var a=this._fieldManager.getColumns(),b=this._fieldManager.getRows();this._columnLeafCount=0,this._rowLeafCount=0;var c=this._fieldManager,d=c.getValueSort(Lc.COLUMN),e=c.getValueSort(Lc.ROW);if(0==a.length)this._columnLabels=[];else if(d&&d.fieldName){for(var f=c.getFieldByName(d.fieldName),g=[],h=[],i=0,j=d.conditions.length;j>i;i++)g.push(c.getFieldByName(d.conditions[i].name)),h.push(d.conditions[i].value);this._columnLabels=this.$_getColumnLabels(0,a,[],f,d.direction,g,h)}else this._columnLabels=this.$_getColumnLabels(0,a,[]);if(0==b.length)this._rowLabels=[];else if(e&&e.fieldName){for(var f=c.getFieldByName(e.fieldName),g=[],h=[],i=0,j=e.conditions.length;j>i;i++)g.push(c.getFieldByName(e.conditions[i].name)),h.push(e.conditions[i].value);this._rowLabels=this.$_getRowLabels(0,b,[],f,e.direction,g,h)}else this._rowLabels=this.$_getRowLabels(0,b,[])},$_getValueLabels:function(a,b){for(var c=[],d=0,e=b.length;e>d;d++){var f=b[d];if(a[f.getOrgIndex()]){var g={};g.name=b[d].name(),g.value=this._getPivotValue(a,f),c.push(g)}}return c},$_findValue:function(a,b,c,d){for(var e,f=0,g=a.length;g>f;f++)if(e=a[f],n(e.rows,b)&&n(e.cols,c)&&e.valueField==d.name())return e;return null},$_putValue:function(a,b,c,d,e,f){var g=Wc[d.expression()],h=this.$_findValue(a,b,c,d);h?(h.value=g(h.value,e),f?h.count+=f:h.count++):(h={},h.rows=b,h.cols=c,h.valueField=d.name(),h.value=e,h.count=f?f:1,a.push(h))},$_summaraizeValues:function(){var a,b,c,d,e,g,h,i,j=this._fieldManager.getColumns(),k=this._fieldManager.getRows(),l=this._fieldManager.valueCount();for(this._values=[],a=0,c=this._filteredValues.length;c>a;a++)if(e=this._filteredValues[a],h=this.$_getValueLabels(e,j),i=this.$_getValueLabels(e,k),h&&h.length>0||i&&i.length>0)for(b=0;l>b;b++)d=this._fieldManager.getValue(b),g=e[d.getOrgIndex()],f(g)&&this.$_putValue(this._values,i,h,d,g)},$_summarizeGroups:function(){this._summaries=[];var a,b,c,d,e,g,h,i,j,k,l=this._fieldManager.valueCount();for(a=l;a--;){for(g=this._fieldManager.getValue(a),h=g.name(),b=0,e=this._values.length;e>b;b++)if(k=this._values[b],k.valueField==h&&f(k.value))for(c=0,j=k.rows.length;j+1>c;c++)for(d=0,i=k.cols.length;i+1>d;d++)(c!=j||d!=i)&&this.$_putValue(this._summaries,k.rows.slice(0,c),k.cols.slice(0,d),g,k.value,k.count);if(g.expression()==Mc.AVERAGE){for(b=this._values.length;b--;)k=this._values[b],h==k.valueField&&(k.value=k.value/k.count);for(b=this._summaries.length;b--;)k=this._summaries[b],h==k.valueField&&(k.value=k.value/k.count)}}},onDataProviderRefresh:function(){this._baseValues=this._dataSource.getRows(),this._filteredValues=D(this._baseValues),this.buildPivotData()},fieldManager:function(){return this._fieldManager},isEmpty:function(){return 0==this._fieldManager.valueCount()||0==this._fieldManager.columnCount()&&0==this._fieldManager.rowCount()},isDataEmpty:function(){return 0==this._values.length},setDataSource:function(a){a?(ba(a._dp&&a._dp instanceof Grids.LocalDataProvider,"provider indices must be RealGridJS.LocalDataProvider."),this._dataSource=a._dp,this._dataSource.addListener(this)):(this._dataSource.removeListener(this),this._dataSource=null)},getDataSource:function(){return this._dataSource},clearFieldMapping:function(){this._fieldManager.clear()},setFieldMapping:function(a){this._fieldManager.setFieldMapping(a)},getFieldMapping:function(){for(var a=[],b=this._fieldManager,c=0,d=b.fieldCount();d>c;c++)a.push(b.getField(c).proxy());return a},setPivotFields:function(a){if(this._fieldManager.setPivotFields(a),a.filter&&this.filter(a.filter),this._fieldManager.clearValueSort(),a.sort){var b;(b=a.sort.column)&&this._fieldManager.setValueSort(Lc.COLUMN,b.fieldName,b.direction,b.conditions),(b=a.sort.row)&&this._fieldManager.setValueSort(Lc.Row,b.fieldName,b.direction,b.conditions)}this._baseValues&&this._baseValues.length>0&&this.buildPivotData()},filterManager:function(){return this._filters},getPivotFields:function(){var a=this._fieldManager.getPivotFields(!this._valueSorted);return this._filters.count()>0&&(a.filter=this._filters.toObject()),a},buildPivotData:function(){c("#pivot build data");var a=X?(new Date).getTime():null;this.$_summaraizeValues(),this.$_summarizeGroups(),this.$_extractLabels(),c((new Date).getTime()-a+"ms ellapsed."),this.fireEvent(Xc.DATA_REFRESHED)},resetFilter:function(){this._filteredValues=D(this._baseValues),this.buildPivotData()},filter:function(a){this._filters.parse(a),this._filteredValues=[];for(var b=0,c=this._baseValues.length;c>b;b++)this._filters.select(this._filterRuntime,this._baseValues[b])&&this._filteredValues.push(this._baseValues[b])},getDistinctValues:function(a,b,c,d,e,f,g,h){var i,j,k,m,n=[],o=(this._fieldManager,d?this._filteredValues:this._baseValues),p=b.length;for(i=0,l=o.length;i<l;i++){var r=o[i];k=this._getPivotValue(r,a);var s=q(n,"value",k),t=0>s;if(t||f){var u=!0;for(j=0;p>j;j++)if(m=this._getPivotValue(r,b[j]),m!=c[j]){u=!1;break}var v;if(u&&(t?(v={},v.name=a._name,v.value=k,a._displayFieldIndex>za?v.label=r[a._displayFieldIndex]:a._displayFormat?v.label=a._displayFormat.replace("${value}",k):a._displayLabels&&(v.label=a._displayLabels[k]),n.push(v)):v=n[s]),f&&v){for(var w=!0,x=0,y=h.length;y>x;x++)if(h[x]!=this._getPivotValue(r,g[x])){w=!1;break}if(w){var z=f.expression(),A=this._getPivotValue(r,f);if(z==Mc.AVERAGE){var B=v.refCount?v.refCount:0;v.refValue=(v.refValue*B+A)/B++,v.refCount=B}else v.refValue=Wc[z](v.refValue,A)}}}}return e&&(f?n.sort(e==Rc.DESCENDING?this.$_compareDescByRefValue:this.$_compareByRefValue):n.sort(e==Rc.DESCENDING?this.$_compareDescByValue:this.$_compareByValue)),n},getBodyCount:function(){return this._columnLeafCount*this._fieldManager.valueCount()*this._rowLeafCount}});Xc.DATA_REFRESHED="onPivotDataRefreshed";var Yc=Ga("Request",null,{init:function(){this._super()},cursor:function(){return dc.AUTO},source:function(){return null},isSelectable:function(){return!1},isDblClickable:function(){return!1}}),Zc=Ga("CellRequest",Yc,{init:function(a){this._super(),this._cell=a},destroy:function(){this._super(),this._cell=null},cell:function(){return this._cell},cursor:function(){return null},source:function(){return this._cell},isSelectable:function(){return!0},isDblClickable:function(){return!1}}),$c=Ga("ColumnResizeRequest",Zc,{init:function(a){this._super(a)},delta:0,cursor:function(){return dc.HORZ_RESIZE},isSelectable:function(){return!1}}),_c=Ga("RowResizeRequest",Zc,{init:function(a){this._super(a)},cursor:function(){return dc.VERT_RESIZE},isSelectable:function(){return!1}}),ad=Ga("ColumnLevelResizeRequest",Yc,{init:function(a,b){this._super(),this._grid=a,this._level=b},destroy:function(){this._super(),this._grid=null},delta:0,grid:function(){return this._grid},level:function(){return this._level},cursor:function(){return dc.VERT_RESIZE},isSelectable:function(){return!1}}),bd=Ga("RowLevelResizeRequest",Yc,{init:function(a,b){this._super(),this._grid=a,this._level=b},destroy:function(){this._super(),this._grid=null},grid:function(){
return this._grid},level:function(){return this._level},cursor:function(){return dc.HORZ_RESIZE},isSelectable:function(){return!1}}),cd=(Ga("DataCellRequest",Yc,{init:function(a){this._super(),this._index=a},cursor:function(){return null},source:function(){return null},isSelectable:function(){return!0}}),Ga("DragTracker",null,{init:function(a,b,c,d){this._super(),this._container=a,this._name=b,this._active=!1,this._completed=!1,this._dragging=!1,this._startX=c,this._startY=d,this._currentX=0,this._currentY=0},cancelabel:!1,container:function(){return this._container},name:function(){return this._name},isActive:function(){return this._active},isDragging:function(){return this._dragging},startWhenCreated:function(){return!1},isCompleted:function(){return this._completed},activate:function(){this._active||(this._doActivate(),this._active=!0)},deactivate:function(){this._active&&(this.cancel(),this._doDeactivate(),this._active=!1)},start:function(a,b,c){return this.cancel(),this._active&&this._doStart(a,b,c)?(this._currentX=this._startX=a,this._currentY=this._startY=b,this._dragging=!0,this._completed=!1,this._showFeedback(a,b),!0):!1},drag:function(a,b){return this._dragging&&(this._currentX=a,this._currentY=b,this._doDrag(a,b))?(this._moveFeedback(a,b),!0):!1},cancel:function(){try{if(this._dragging)try{this._dragging=!1,this._doCanceled()}finally{this._doEnded()}}finally{this._hideFeedback()}},drop:function(a,b){try{if(this._dragging)try{this._currentX=a,this._currentY=b,this._dragging=!1,this._canAccept(a,b)?(this._doCompleted(a,b),this._completed=!0):this._doCanceled(a,b)}finally{this._doEnded()}}finally{this._hideFeedback()}},getNextRequest:function(a,b){return null},startX:function(){return this._startX},startY:function(){return this._startY},currentX:function(){return this._currentX},currentY:function(){return this._currentY},offsetX:function(){return this._currentX-this._startX},offsetY:function(){return this._currentY-this._startY},_showFeedback:function(a,b){},_moveFeedback:function(a,b){},_hideFeedback:function(){},_doActivate:function(){aa(this._name+" activated")},_doDeactivate:function(){aa(this._name+" deactivated")},_doStart:function(a,b){return!0},_doDrag:function(a,b){return!0},_doCanceled:function(){},_canAccept:function(a,b){return!0},_doCompleted:function(){},_doEnded:function(){},_findElementAt:function(a,b,c){return this._container.findElementAt(a,b,c)}})),dd=Ga("GridDragTracker",cd,{init:function(a,b){this._destroying=!0,this._super(a.container(),b),this._grid=a},destroy:function(){this._grid=null,this._super()},grid:function(){return this._grid},isStartWhenCreated:function(){return!1},checkScrolling:function(){return this._grid.checkScrolling()},checkHScrolling:function(){return this._grid.checkHSCrolling()}}),ed=2,fd=Ga("ColumnResizeTracker",dd,{init:function(a,b,c){var d=this._cell=a.cell(),e=d.grid();this._super(e,"columnResizeTracker"),this._request=a,this._startWidth=d.width(),this._offset=b-this._startWidth,this._changeOffset=0},_doStart:function(a,b){return!0},_doDrag:function(a,b){var c=this._cell,d=(c.grid(),a-this._offset);if(d>=ed){var e=d-this._startWidth;c.changeSize(e,0),this._startWidth=d,this._changeOffset+=e}return!0},_doEnded:function(){var a=this._cell,b=a.grid();b._changeClientSize(this._changeOffset,0);for(var c=a.getFamilyTree(),d=c.length;d--;)b.setOrgColumnWidth(c[d],c[d].width())}}),gd=Ga("RowResizeTracker",dd,{init:function(a,b,c){var d=this._cell=a.cell(),e=d.grid();this._super(e,"rowResizeTracker"),this._request=a,this._startHeight=d.height(),this._offset=c-this._startHeight,this._changeOffset=0},_doStart:function(a,b){return!0},_doDrag:function(a,b){var c=this._cell,d=(c.grid(),b-this._offset);if(d>=ed){var e=d-this._startHeight;c.changeSize(0,e),this._changeOffset+=e,this._startHeight=d}return!0},_doEnded:function(){var a=this._cell,b=a.grid();b._changeClientSize(0,this._changeOffset);for(var c=a.getFamilyTree(),d=c.length;d--;)b.setOrgRowHeight(c[d],c[d].height())}}),hd=Ga("ColumnResizeTracker",dd,{init:function(a,b,c){var d=a.grid();this._super(d,"columnLevelResizeTracker"),this._request=a,this._level=a.level(),this._startHeight=d.columnLevelHeight(this._level),this._offset=c-this._startHeight},_doStart:function(a,b){return!0},_doDrag:function(a,b){var c=this._level,d=this._request.grid(),e=b-this._offset;return e>=ed&&(d.changeColumnLevelHeight(c,e-this._startHeight),this._startHeight=e),!0},_doEnded:function(){}}),id=Ga("RowLevelResizeTracker",dd,{init:function(a,b,c){var d=this._grid=a.grid();this._super(d,"rowLevelResizeTracker"),this._request=a,this._level=a.level(),this._startWidth=d.rowLevelWidth(this._level),this._offset=b-this._startWidth},_doStart:function(a,b){return!0},_doDrag:function(a,b){var c=this._level,d=this._request.grid(),e=a-this._offset;return e>=ed&&(d.changeRowLevelWidth(c,e-this._startWidth),this._startWidth=e),!0},_doEnded:function(){}}),jd=Ga("PivotViewTool",fc,{init:function(a){this._super(a),this._request=null,this._hoveredCell=null,this._tooltipCell=null,this._tooltipIndex=null},_doKeyDown:function(a,b,c,d){if(aa("tool: keyDown("+a+")"),27==a){var e=this._owner.tooltipManager();e.isVisible()&&this.$_hideTooltip()}return!1},_doKeyUp:function(a,b,c,d){return aa("tool: keyUp("+a+")"),!1},_doKeyPress:function(a){aa("tool: keyPress("+a+")")},_doClick:function(a,b){aa("tool: click("+a+","+b+")");var c=this.findElementAt(a,b,!0);this._owner._fireClick(c)},_doDblClick:function(a,b){aa("tool: dblClick("+a+","+b+")");var c=this.findElementAt(a,b,!0);this._owner._fireDblClick(c)},_doMouseDown:function(a,b,c,d,e,f){if(this._request){var g=this._getDragTracker(this._request,a,b);this.setDragTracker(g)}else{var h=this.findElementAt(a,b);if(h){var i=h.containerToClient(a,b);h instanceof Oa&&h.click(i.x,i.y)}}f.preventDefault()},_doMouseMove:function(a,b){var c=this._owner;c.setCursor(dc.DEFAULT);var d=this.findElementAt(a,b,!0);if(d!=this._hoveredCell&&(this.$_hideTooltip(),this._hoveredCell=d),!this.isDragging()&&!c.isPopuped()){var e=this._request=this._getRequest(d,a,b);if(e&&e.cursor())c.setCursor(e.cursor());else{var f=c.tooltipManager(),g=c.displayOptions().tooltipDelay();d instanceof Jd&&c.displayOptions().isShowTooltip()?g>0?(f._showTimer&&clearTimeout(f._showTimer),f._showTimer=setTimeout(function(){this._showTooltip(d)}.bind(this),g)):this._showTooltip(d):d instanceof Cd&&c.displayOptions().isShowLabelTooltip()?g>0?(f._showTimer&&clearTimeout(f._showTimer),f._showTimer=setTimeout(function(){this._showLabelTooltip(d)}.bind(this),g)):this._showLabelTooltip(d):f.isVisible()&&f.close()}}},_doMouseUp:function(a,b){},_doMouseEnter:function(a,b){aa("tool: mouseEnter("+a+","+b+")")},_doMouseLeave:function(a,b){aa("tool: mouseLeave("+a+","+b+")")},_doMouseOver:function(a,b){aa("tool: mouseOver("+a+","+b+")")},_doMouseOutside:function(){},_doMouseWheel:function(a,b,c,d){aa("tool: mouseWheel("+c+","+d+")");var e=this._owner._scrollContainer.wheelScroll(c,d);return e},_doTouchStart:function(a){aa("tool: touchStart")},_doTouchMove:function(a){aa("tool: touchMove")},_doTouchEnd:function(a){aa("tool: touchEnd")},_doTouchCancel:function(a){aa("tool: touchCancel")},_getRequest:function(a,b,c,d,e){var f,g;this._owner;return a instanceof Ud?new Wd(a):a instanceof yd?(g=a,(f=this.$_getColumnResizeRequest(b,c))?f:(f=this.$_getRowResizeRequest(b,c),f?f:null)):null},_getDragTracker:function(a,b,c){return a instanceof Wd?new Xd(a,b,c):a instanceof $c?new fd(a,b,c):a instanceof _c?new gd(a,b,c):a instanceof ad?new hd(a,b,c):a instanceof bd?new id(a,b,c):void 0},$_getColumnResizeRequest:function(a,b){var c=this._owner,d=c.columnView(),e=d.boundsByContainer();if(e.inflate(0,0,fc.DRAG_BORDER,fc.DRAG_BORDER),!e.contains(a,b))return null;for(var f=d.getChildren(),g=e.left(),h=e.top(),i=0,j=f.length;j>i;i++){var k=f[i];if(b>=h+k.top()&&b<=h+k.bottom()&&this.inDraggablePt(a,g+k.right()))return new $c(k);if(a>=g+k.left()&&a<=g+k.right()&&this.inDraggablePt(b,h+k.bottom()))return new ad(c,k.level())}return null},$_getRowResizeRequest:function(a,b){var c=this._owner,d=c.rowView(),e=d.boundsByContainer();if(e.inflate(0,0,fc.DRAG_BORDER,fc.DRAG_BORDER),!e.contains(a,b))return null;for(var f=d.getChildren(),g=e.left(),h=e.top(),i=0,j=f.length;j>i;i++){var k=f[i];if(a>=g+k.left()&&a<=g+k.right()&&this.inDraggablePt(b,h+k.bottom()))return new _c(k);if(b>=h+k.top()&&b<=h+k.bottom()&&this.inDraggablePt(a,g+k.right()))return new bd(c,k.level())}return null},_showTooltip:function(a){if(a){var b=this._owner,c=b.tooltipManager(),d=a.getCellIndex();if(!c.isVisible()||this._tooltipCell!=a||!Pa.areEquals(d,this._tooltipIndex)){var e=a.getTooltip();if(e){var f=b._fireShowTooltip(d,e);if(f){var g={};"object"==typeof f?(g.message=f.message,f.styles&&(g.styles=f.styles)):"string"==typeof f&&(g.message=f),this.$_showTooltip(a,g)}}}}},_showLabelTooltip:function(a){if(a){var b=this._owner,c=b.tooltipManager(),d=a.getCellIndex();if(!c.isVisible()||this._tooltipCell!=a||!Pa.areEquals(d,this._tooltipIndex)){var e=a.getTooltip();if(e){var f=b._fireShowLabelTooltip(d,e);if(f){var g={};"object"==typeof f?(g.message=f.message,f.styles&&(g.styles=f.styles)):"string"==typeof f&&(g.message=f),this.$_showTooltip(a,g)}}}}},$_showTooltip:function(a,b){var c=this._owner,d=c.tooltipManager(),e=a.getCellIndex();this.$_hideTooltip();var f=a.boundsBy(),g=f.x,h=f.y+a.height();d.show(b,g,h,a),this._tooltipCell=a,this._tooltipIndex=e},$_hideTooltip:function(){this._owner.tooltipManager().close(),this._tooltipCell=null,this._tooltipIndex=null}}),kd=P({FIRST:"first",LAST:"last"}),ld=P({NONE:"none",COLUMN:"column",ROW:"row",VALUE:"value",FILTER:"filter"}),md=P({NONE:"none",ADD:"add",REMOVE:"remove",MOVE:"move"}),nd=Ga("PivotOptions",null,{init:function(a){this.assign(a),this._super()},destroy:function(){this._super()}}),od=Ga("DisplayOptions",nd,{columnHeight:20,rowHeight:20,columnWidth:60,rowLabelWidth:80,rowGroupWidth:70,cellSpaceWidth:0,cellSpaceHeight:0,showTooltip:!1,showLabelTooltip:!1,tooltipDelay:100,blankFillValue:0,showProgress:!1,maxStableCellCount:1e4,notReadyMessage:RealPivotMessages.notReadyText,emptyMessage:RealPivotMessages.emptyDataText}),pd=Ga("SummaryOptions",nd,{columnVisible:!0,rowVisible:!0,columnGroupVisible:!0,rowGroupVisible:!0,columnPosition:kd.FIRST,rowPosition:kd.FIRST,columnTotalText:RealPivotMessages.columnTotalText,rowTotalText:RealPivotMessages.rowTotalText}),qd=Ga("HeaderOptions",nd,{titleVisible:!0,titleHeight:20,rowHeadVisible:!0,columnHeadVisible:!0,valueHeadVisible:!0,menuButtonVisible:!0,setupButtonVisible:!0}),rd=Ga("PivotEmptyElement",Na,{init:function(a){this._super(a,"realpivot-empty"),this._mouseEnabled=!1,this._messageSpan=null},destroy:function(){this._messageSpan&&this._element.removeChild(this._messageSpan),this._messageSpan=null,this._super()},_layoutCells:function(){var a=this.grid(),b=a.tmpDisplayOptions().emptyMessage();this._messageSpan||(this._messageSpan=U.createElement("span"),this._messageSpan.className=this.cssClass(),this._element.appendChild(this._messageSpan)),this._messageSpan.textContent=b},_doRender:function(a){}}),sd=Ga("PivotEmptyElement",Na,{init:function(a){this._super(a,"realpivot-noready"),this._mouseEnabled=!1,this._messageSpan=null,this._productSpan=null},destroy:function(){this._messageSpan&&this._element.removeChild(this._messageSpan),this._productSpan&&this._element.removeChild(this._productSpan),this._messageSpan=null,this._productSpan=null,this._super()},_layoutCells:function(){var a=this.grid(),b=a.tmpDisplayOptions().notReadyMessage(),c=Ba.toString();this._messageSpan||(this._messageSpan=U.createElement("span"),this._messageSpan.className=this.cssClass(),this._element.appendChild(this._messageSpan)),this._messageSpan.textContent=b,this._productSpan||(this._productSpan=U.createElement("span"),this._productSpan.className=this.cssClass()+"-product",this._productSpan.style.position="absolute",this._productSpan.style.right="5px",this._productSpan.style.bottom="5px",this._element.appendChild(this._productSpan)),this._productSpan.textContent=c},_doRender:function(a){}}),td=Ga("HeaderElement",Na,{init:function(a){this._super(a,"realpivot-header"),this._isContainer=!0,this._childFixed=!0,this._titleCell=null,this._colHeaderCell=null,this._rowHeaderCell=null,this._valHeaderCell=null,this._rowTotHeight=0,this._rowHeaderHeight=0,this._valHeaderHeight=0},columnFields:null,rowFields:null,valueFields:null,setWidth:function(a){var b=!1;if(this._width&&this._width!=a&&(b=!0),this._super(a),b&&this._colHeaderCell&&this._colHeaderCell.isVisible()){var c=this.clientRect();this._colHeaderCell.setWidth(c.width-this._grid._centralPt.x)}},getTitleCell:function(){return this._titleCell},getColHeaderCell:function(){return this._colHeaderCell},getRowHeaderCell:function(){return this._rowHeaderCell},getValHeaderCell:function(){return this._valHeaderCell},changeTitleSize:function(a,b){var c=this._grid.tmpHeaderOptions(),d=c.isValueHeadVisible(),e=c.isRowHeadVisible(),f=c.isTitleVisible(),g=c.isColumnHeadVisible();if(a&&((f||g)&&(this._titleCell.inflate(a,0),this._colHeaderCell.offset(a),this._colHeaderCell.inflate(-a,0)),d&&this._valHeaderCell.inflate(a,0),e&&this._rowHeaderCell.inflate(a,0)),b){this._rowTotHeight+=b,this._height+=b;var h=this._rowTotHeight;d&&(this._valHeaderHeight=e?ia(this._rowTotHeight/2):this._rowTotHeight,this._valHeaderCell.setHeight(this._valHeaderHeight),h-=this._valHeaderHeight),e&&(this._rowHeaderHeight=h,d&&this._rowHeaderCell.setTop(this._valHeaderCell.bottom()),this._rowHeaderCell.setHeight(this._rowHeaderHeight))}},_layoutCells:function(){this._titleCell||(this._titleCell=new Ad(this._grid),this.addChild(this._titleCell)),this._colHeaderCell||(this._colHeaderCell=new Bd(this._grid,Lc.COLUMN),this.addChild(this._colHeaderCell)),this._rowHeaderCell||(this._rowHeaderCell=new Bd(this._grid,Lc.ROW),this.addChild(this._rowHeaderCell)),this._valHeaderCell||(this._valHeaderCell=new Bd(this._grid,Lc.VALUE),this.addChild(this._valHeaderCell));var a=this.clientRect(),b=this._grid,c=b.tmpHeaderOptions(),d=c.titleHeight(),e=c.isTitleVisible(),f=c.isColumnHeadVisible(),g=c.isValueHeadVisible(),h=c.isRowHeadVisible(),i=b._centralPt,j=a.clone(),k=0;if(e||f?(j.width=i.x,j.height=d,this._titleCell.setVisible(!0),this._titleCell.setSpace(this._cellSpaceWidth,this._cellSpaceHeight),this._titleCell.setRectI(j),this._titleCell.setContentsVisible(e),this._titleCell.setMenuVisible(c.isMenuButtonVisible()),this._titleCell.setSetupVisible(c.isSetupButtonVisible()),this._titleCell.layoutContent(),j.leftBy(i.x),j.width=a.width-i.x,this._colHeaderCell.setFields(this._columnFields),this._colHeaderCell.setVisible(!0),this._colHeaderCell.setSpace(this._cellSpaceWidth,this._cellSpaceHeight),this._colHeaderCell.setRectI(j),this._colHeaderCell.setContentsVisible(f),this._colHeaderCell.layoutContent(),k+=d):(this._titleCell.setVisible(!1),this._colHeaderCell.setVisible(!1)),a.setTop(k),a.width=i.x,this._rowTotHeight=a.height,this._valHeaderCell.setVisible(g),g){this._valHeaderCell.setFields(this._valueFields);var l=this._valHeaderHeight=h?ia(a.height/2):a.height;j=a.clone(),j.height=l,this._valHeaderCell.setSpace(this._cellSpaceWidth,this._cellSpaceHeight),this._valHeaderCell.setRectI(j),this._valHeaderCell.layoutContent(),a.setTop(a.y+l)}else this._valHeaderCell.setVisible(!1);h||!g?(this._rowHeaderCell.setFields(this._rowFields),this._rowHeaderCell.setVisible(!0),this._rowHeaderCell.setSpace(this._cellSpaceWidth,this._cellSpaceHeight),this._rowHeaderCell.setRectI(a),this._rowHeaderHeight=a.height,this._rowHeaderCell.setContentsVisible(h),this._rowHeaderCell.layoutContent()):this._rowHeaderCell.setVisible(!1)},_doRender:function(a){}}),ud=Ga("LabelElement",Na,{init:function(a,b){this._super(a,b),this._isContainer=!0,this._sumOptions=a.tmpSummaryOptions(),this._rootElement=this._createRootCell()},destroy:function(){this._labels=null,this._rootElement.destroy(),this._rootElement=null,this._super()},labels:null,depth:0,cellIndexes:null,rootElement:function(){return this._rootElement},$_addIndexCell:function(a,b){this._cellIndexes[b]=a,a.setIndex(b)},_layoutCells:function(){this._super(),this._cellIndexes=[],this._layoutChildren({childs:this._labels},0,0,0,this._rootElement)},_layoutChildren:function(a,b,c,d,e){},_doRender:function(a){},_createRootCell:function(){},sortByLabel:function(a,b){this._rootElement.sortByLabel(a,b)},sortByRef:function(a,b,c,d){this._rootElement.sortByValue(a._bodies,b,c,d)},findCell:function(a,b,c){var d=this._rootElement.findLower(a,c);if(d&&b&&d._lowers.length>0){for(var e=0,f=d._lowers.length;f>e;e++){var g=d._lowers[e];if(b==g.valueField().name())return g}return null}return d},getVisibleLeafCount:function(){return this._rootElement.getDescendantCount(!0)}}),vd=Ga("ColumnLabelElement",ud,{init:function(a){this._super(a,"realpivot-col")},destroy:function(){this._values=null,this._super()},values:[],changeHeight:function(a,b){this.setHeight(this._height+b);for(var c=this._childs.length;c--;){var d=this._childs[c];d._level==a?d.inflate(0,b):d._level<a&&d instanceof Id&&d._level+d._mergeCount>=a?d.inflate(0,b):d._level>a&&d.offset(0,b)}},_createRootCell:function(){var a=new Gd(this._grid);return a.setVisible(!1),a},_layoutChildren:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p=cnt=0,q=this._grid,r=q._dataSource.fieldManager(),s=r.getColumn(b),t=this._values.length,u=q.columnPoints(),v=this._cellSpaceWidth,w=this._cellSpaceHeight,x=t>1?this._depth-2:this._depth-1,y=0==b?this._sumVisible:this._groupSumVisible;for(y&&this._sumPosition==kd.FIRST&&(l=d,m=c,d+=u[m+t]-u[m],c+=t),f=0,h=a.childs.length;h>f;f++){var z=a.childs[f];if(z.hasOwnProperty("childs")?n=new Ed(q,b):(cnt=t,j=u[c+t]-u[c],n=new Cd(q,Lc.COLUMN,b),2>t&&this.$_addIndexCell(n,c++)),this.addChild(n),k=q.getColumnLevelSumHeight(0,b-1),i=q.columnLevelHeight(b),n.setLabelField(s),1==t&&n.setValueField(this._values[0]),n.setValue(z.value),n.setText(z.label?z.label:z.value),n.setGroup(e),n instanceof Ed&&(cnt=this._layoutChildren(z,b+1,c,d,n),j=u[c+cnt]-u[c],c+=cnt),n.setBounds(d,k,j,i,v,w),n.draw(),n.layoutContent(),o=n,p+=cnt,t>1&&!(n instanceof Ed))for(g=0;t>g;g++)n=new Cd(q,Lc.COLUMN,this._depth-1),this.addChild(n),j=u[c+1]-u[c],k=q.getColumnLevelSumHeight(0,this._depth-2),i=q.columnLevelHeight(this._depth-1),n.setBounds(d,k,j,i,v,w),this.$_addIndexCell(n,c++),n.setValueLabel(!0),n.setLabelField(s),n.setValueField(this._values[g]),n.setValue(z.value),n.setText(this._values[g].getFieldHeader()),n.setGroup(o),n.draw(),d+=j;else d+=j}if(y&&(void 0===l&&(l=d,m=c),s=r.getColumn(b-1),n=new Id(q,Lc.COLUMN,b,x-b),this.addChild(n),j=u[m+t]-u[m],k=q.getColumnLevelSumHeight(0,b-1),i=q.getColumnLevelSumHeight(b,x),n.setBounds(l,k,j,i,v,w),2>t&&this.$_addIndexCell(n,m),1==t&&n.setValueField(this._values[0]),n.setLabelField(s),n.setLabelPosition(this._sumPosition),e.setSummaryCell(n),b>0&&n.setValue(a.value),n.setText(0==b?this._totalText:s.getSummaryLabel(a.value,a.label)),n.setGroup(e,this._sumPosition==kd.FIRST?0:void 0),n.draw(),o=n,p+=t,t>1))for(g=0;t>g;g++)n=new Id(q,Lc.COLUMN,this._depth-1),this.addChild(n),j=u[m+1]-u[m],k=q.getColumnLevelSumHeight(0,x),i=q.columnLevelHeight(this._depth-1),n.setBounds(l,k,j,i,v,w),this.$_addIndexCell(n,m++),n.setLabelField(s),n.setValueLabel(!0),n.setValueField(this._values[g]),b>0&&n.setValue(a.value),n.setText(this._values[g].getFieldHeader()),n.setGroup(o),n.draw(),l+=j;return p},_layoutCells:function(){this._cellWidth=this._options.columnWidth(),this._sumVisible=this._sumOptions.isColumnVisible(),this._groupSumVisible=this._sumOptions.isColumnGroupVisible(),this._sumPosition=this._sumOptions.columnPosition(),this._totalText=this._sumOptions.columnTotalText(),this._cellHeight=this._options.columnHeight(),this._super()},_doRender:function(a){}}),wd=Ga("RowLabelElement",ud,{init:function(a){this._super(a,"realpivot-row")},changeWidth:function(a,b){this.setWidth(this._width+b);for(var c=this._childs.length;c--;){var d=this._childs[c];d._level==a?d.inflate(b,0):d._level<a&&d instanceof Id&&d._level+d._mergeCount>=a?d.inflate(b,0):d._level>a&&d.offset(b,0)}},_createRootCell:function(){var a=new Hd(this._grid);return a.setVisible(!1),a},_layoutChildren:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n=cnt=0,o=this._grid,p=o._dataSource.fieldManager(),q=p.getRow(b),r=o.rowPoints(),s=this._cellSpaceWidth,t=this._cellSpaceHeight,u=0==b?this._sumVisible:this._groupSumVisible;for(u&&this._sumPosition==kd.FIRST&&(k=d,l=c,d+=r[l+1]-r[l],c++),f=0,g=a.childs.length;g>f;f++){var v=a.childs[f];v.hasOwnProperty("childs")?m=new Fd(o,b):(cnt=1,i=r[c+1]-r[c],h=this._cellWidth,m=new Cd(o,Lc.ROW,b),this.$_addIndexCell(m,c++)),this.addChild(m),j=o.getRowLevelSumWidth(0,b-1),h=o.rowLevelWidth(b),m.setLabelField(q),m.setValue(v.value),m.setText(v.label?v.label:v.value),m.setGroup(e),m instanceof Fd&&(cnt=this._layoutChildren(v,b+1,c,d,m),i=r[c+cnt]-r[c],h=this._groupWidth,c+=cnt),m.setBounds(j,d,h,i,s,t),m.draw(),m.layoutContent(),n+=cnt,d+=i}return u&&(void 0===k&&(k=d,l=c),q=p.getRow(b-1),m=new Id(o,Lc.ROW,b,this._depth-b-1),this.addChild(m),j=o.getRowLevelSumWidth(0,b-1),h=o.getRowLevelSumWidth(b,this._depth-1),i=r[l+1]-r[l],m.setBounds(j,k,h,i,s,t),this.$_addIndexCell(m,l),m.setLabelField(q),m.setGroup(e,this._sumPosition==kd.FIRST?0:void 0),m.setLabelPosition(this._sumPosition),e.setSummaryCell(m),b>0&&m.setValue(a.value),m.setText(0==b?this._totalText:q.getSummaryLabel(a.value,a.label)),m.draw(),n++),n},_layoutCells:function(){this._groupWidth=this._options.rowGroupWidth(),this._cellWidth=this._options.rowLabelWidth(),this._sumVisible=this._sumOptions.isRowVisible(),this._groupSumVisible=this._sumOptions.isRowGroupVisible(),this._sumPosition=this._sumOptions.rowPosition(),this._totalText=this._sumOptions.rowTotalText(),this._cellHeight=this._options.rowHeight(),this._super()},_doRender:function(a){}}),xd=Ga("BodyElement",Na,{init:function(a){this._super(a,"realpivot-body"),this._isContainer=!0,this._cells=[],this._cellCount=0},destroy:function(){this._columnView=null,this._rowView=null,this._valueFields=null,this._values=null,this._super()},columnView:null,rowView:null,valueFields:null,values:null,summaries:null,getCells:function(a,b){return this._cells[a][b]},_layoutCells:function(a){this._super();var c,d,e,g,h=this._cellSpaceWidth,i=this._cellSpaceHeight,j=this._grid.dataSource().fieldManager(),k=this._columnView.cellIndexes(),l=this._rowView.cellIndexes(),m=k.length,n=l.length,o=this._options.blankFillValue(),p=this._options.isShowProgress();for(this._cells=new Array(n),c=0;n>c;c++)this._cells[c]=new Array(m);this._cellCount=0,e=this._values.length;var q=p?la(1e3,ja(e/3)):e;xa.asyncLoop(0,e-1,q,this,function(a){var b=this._values[a],c=this._columnView.findCell(b.cols,b.valueField),d=this._rowView.findCell(b.rows);if(c&&d){var e=c.index(),f=d.index(),g=new Kd(this._grid);this.addChild(g),this._cells[f][e]=g,g.setBounds(c.left(),d.top(),c.width(),d.height(),h,i),g.setColumnLabel(c),g.setRowLabel(d);var k=j.getFieldByName(b.valueField);g.setValueField(k),g.setValue(b),g.draw(),this._cellCount++}}.bind(this),function(a){this._grid.increaseProgress(a)}.bind(this)),e=this._summaries.length;var q=p?la(1e3,ja(e/3)):e;xa.asyncLoop(0,e-1,q,this,function(a){var b=this._summaries[a],c=this._columnView.findCell(b.cols,b.valueField,!0),d=this._rowView.findCell(b.rows,null,!0);if(c&&d){var e=c.index(),f=d.index(),g=c.isValueLabel()?c.group().level():c.level(),k=new Ld(this._grid,d.level(),g);this.addChild(k),this._cells[f][e]=k,k.setBounds(c.left(),d.top(),c.width(),d.height(),h,i),k.setColumnLabel(c),k.setRowLabel(d);var l=j.getFieldByName(b.valueField);k.setValueField(l),k.setValue(b),k.draw(),this._cellCount++}}.bind(this),function(a){this._grid.increaseProgress(a)}.bind(this)),setTimeout(function(){for(c=0;n>c;c++)for(d=0;m>d;d++)if(!this._cells[c][d]&&(rowCell=l[c],colCell=k[d],colCell&&rowCell)){var a,b=colCell.isValueLabel()?colCell.group().level():colCell.level();a=colCell instanceof Id||rowCell instanceof Id?new Ld(this._grid,rowCell.level(),b,d):new Kd(this._grid),this.addChild(a),this._cells[c][d]=a,a.setBounds(colCell.left(),rowCell.top(),colCell.width(),rowCell.height(),h,i),a.setColumnLabel(colCell),a.setRowLabel(rowCell),g=colCell.valueField(),a.setValueField(g),f(o)&&a.setValue({value:o,count:0}),a.draw(),this._cellCount++}}.bind(this)),p?setTimeout(function(){this._grid.completeProgress(),setTimeout(function(){this._grid.closeProgress(),a&&a(),b("body cells = "+this._cellCount)}.bind(this))}.bind(this),10):(a&&a(),b("body cells = "+this._cellCount))},_doRender:function(a){}}),yd=Ga("PivotCellElement",Na,{init:function(a,b){this._super(a,"realpivot-cell "+b),this._cellIndex=new Pa(a)},destroy:function(){this._super()},text:null,_labelPositionCells:function(){},_doRender:function(a){if(this._text){var b=this.$_prepareSpan();b.innerHTML=this._text}},getCellIndex:function(){return this._cellIndex},getTooltip:function(){return null}}),zd=Ga("HeaderCellElement",yd,{init:function(a,b){this._super(a,b)},destroy:function(){this._super()},contentsVisible:!0}),Ad=Ga("TitleCellElement",zd,{init:function(a){this._super(a,"realpivot-title"),this._menuImg=U.createElement("div"),this._menuImg.className="realpivot-title-menu",this._menuImg.style.display="none",Ib.addEventListener(this._menuImg,"click",this._menuButtonClicked.bind(this),!1),this._element.appendChild(this._menuImg),this._setupImg=U.createElement("div"),this._setupImg.className="realpivot-title-setup",this._setupImg.style.display="none",Ib.addEventListener(this._setupImg,"click",this._setupButtonClicked.bind(this),!1),this._element.appendChild(this._setupImg)},destroy:function(){Ib.removeEventListener(this._menuImg,"click",this._menuButtonClicked.bind(this),!1),Ib.removeEventListener(this._setupImg,"click",this._setupButtonClicked.bind(this),!1),this._element.removeChild(this._menuImg),this._element.removeChild(this._setupImg),this._super()},menuVisible:!0,setupVisible:!0,_menuButtonClicked:function(a){var b=this._grid.contextMenuManager();b.isVisible()?b.close():b.show(this.left()+5,this.bottom()+1)},_setupButtonClicked:function(a){this._grid.setupView().show()},_doLayoutContent:function(){this._contentsVisible&&this._menuVisible?this._menuImg.style.display="inline-block":this._menuImg.style.display="none",this._contentsVisible&&this._setupVisible?this._setupImg.style.display="inline-block":this._setupImg.style.display="none"},_doRender:function(a){}}),Bd=Ga("LabelHeaderCellElement",zd,{init:function(a,b){var c=b==Lc.VALUE?"realpivot-value-header":b==Lc.ROW?"realpivot-row-header":"realpivot-col-header";this._super(a,c),this._type=b,this._headers=[]},destroy:function(){this._fields=null,this._clearElements(),this._super()},type:null,fields:null,_clearElements:function(){var a,b;for(a=this._headers.length;a--;){var c=this._headers[a];for(b=c.childElementCount;b--;)c.removeChild(c.children[b]);this._element.removeChild(this._headers[a]),delete this._headers[a]}this._headers=[]},_doLayoutContent:function(){this._clearElements();for(var a,b,c,d=this._grid.dataSource().fieldManager(),e=this.cssClass()+"-text",f="realpivot-header-sort",g=0,h=this._fields.length;h>g;g++){a=U.createElement("div"),a.className=e,this._element.appendChild(a),this._headers.push(a),b=U.createElement("span"),b.className=e,a.appendChild(b);var i=this._fields[g].getFieldHeader();this._type==Lc.VALUE&&(i=RealPivotMessages.valueTypeTexts[this._fields[g].expression()]+": "+i),b.textContent=i;var j=this._fields[g],k=d.getFieldSortDir(j.fieldType(),j.name());k!=Rc.NONE&&(c=U.createElement("div"),c.className=f+" "+f+(k==Rc.ASCENDING?"-asc":"-desc"),a.appendChild(c))}},_doRender:function(a){}}),Cd=Ga("LabelCellElement",yd,{init:function(a,b,c){var d;if(this instanceof Id)d=b==Lc.ROW?"realpivot-row-sum":"realpivot-col-sum",d+=(b==Lc.ROW?" realpivot-row-sum-":" realpivot-col-sum-")+(0==c?"tot":c+1);else{var d=b==Lc.ROW?"realpivot-row-label":"realpivot-col-label";d+=(b==Lc.ROW?" realpivot-row-d":" realpivot-col-d")+(c+1),this instanceof Ed?d+=" realpivot-col-group":this instanceof Fd&&(d+=" realpivot-row-group")}b==Lc.VALUE&&(d+=" realpivot-value-label"),this._super(a,d),this._type=b,this._level=c,this._lowers=[],this._bodies=[],this._widthOffset=0,this._heightOffset=0},destroy:function(){this.releaseGroup();var a;for(a=this._lowers.length;a--;)delete this._lowers[a];for(this._lowers=[],a=this._bodies.length;a--;)delete this._bodies[a];this._bodies=[],this._labelField=null,this._valueField=null,this._super()},type:null,level:za,mergeCount:0,index:za,valueLabel:!1,labelField:null,valueField:null,value:null,group:null,isRoot:function(){return!1},setGroup:function(a,b){a!=this._group&&(this.releaseGroup(),b>-1?a.$_insertLower(this,b):a.$_addLower(this),this._group=a,this.$_resetIndex())},releaseGroup:function(){this._group&&this._group.$_removeLower(this),this._group=null},addBody:function(a){this._bodies.push(a)},removeBody:function(a){var b=this._bodies.indexOf(a);b>-1&&this._bodies.splice(b,1)},hasLower:function(){return this._lowers.length>0},getLowers:function(){return this._lowers},getDescendantCount:function(a){for(var b=0,c=this._lowers.length;c--;){var d=this._lowers[c];!(d._lowers.length>0)||a&&d instanceof Dd&&!d._expanded?b++:b+=d.getDescendantCount(a)}return b},getDescendants:function(a){for(var b=this._lowers.slice(),c=0,d=b.length;d>c;c++){var e=b[c];!(e._lowers.length>0)||a&&e instanceof Dd&&!e._expanded||b.push.apply(b,e.getDescendants(a))}return b},getAncestors:function(){for(var a=this.group(),b=[];a&&!a.isRoot();)b.push(a),a=a.group();return b},getFamilyTree:function(){var a=[];return a.push.apply(a,this.getAncestors()),a.push(this),a.push.apply(a,this.getDescendants()),a},$_toggleMembers:function(a){this.setVisible(a);for(var b=this._bodies.length;b--;){var c=this._bodies[b];(!a||c.columnLabel().isVisible()&&c.rowLabel().isVisible())&&c.setVisible(a)}for(b=this._lowers.length;b--;)this._lowers[b].$_toggleMembers(a)},$_offsetMembers:function(a,b){if(this.isVisible()){var c;if(this.offset(a,b),this._type==Lc.ROW){if(0!=b)for(c=this._bodies.length;c--;)this._bodies[c].offset(0,b)}else if(0!=a)for(c=this._bodies.length;c--;)this._bodies[c].offset(a,0);for(c=this._lowers.length;c--;)this._lowers[c].isVisible()&&this._lowers[c].$_offsetMembers(a,b)}},$_inflateGroup:function(a,b,c){for(var d=this._lowers.length;d--;){var e=this._lowers[d];e.isVisible()&&(0!=b&&e._left>a._left||0!=c&&e._top>a._top)&&e.$_offsetMembers(b,c)}this.inflate(b,c),this._group&&this._group.$_inflateGroup(this,b,c)},$_inflateWithLowers:function(a,b){var c;for(this.inflate(a,b),c=this._bodies.length;c--;)this._bodies[c].inflate(a,b);var d=this.getVisibleLowers(!0,!0);if(d.length>0){var e=d.length,f=a/e,g=b/e,h=0,i=0;for(c=0;e>c;c++){var j=d[c],k=c==e-1?a-h:f,l=c==e-1?b-i:g;c>0&&j.$_offsetMembers(h,i),j.$_inflateWithLowers(k,l),h+=f,i+=g}}},changeSize:function(a,b){this._group&&this._group.$_inflateGroup(this,a,b),this.$_inflateWithLowers(a,b)},setTop:function(a){this._super(a)},$_insertLower:function(a,b){this._lowers.splice(b,0,a)},$_addLower:function(a){this._lowers.push(a)},$_removeLower:function(a){var b=this._lowers.indexOf(a);b>-1&&this._lowers.splice(b,1)},_doLayoutContent:function(){},_doRender:function(a){this._super(a)},findLower:function(a,b){for(var c=0,d=this._lowers.length;d>c;c++){var e=this._lowers[c];if(a&&0!=a.length){if(a.length>0&&e.value()==a[0].value)return a.length<2?e instanceof Dd&&b&&e._lowers.length>0?e.findLower([],b):e:e.findLower(a.slice(1,a.length),b)}else if(e instanceof Id)return e}},getVisibleLowers:function(a,b){for(var c=[],d=this._lowers.length,e=0;d>e;e++){var f=this._lowers[e];!a&&f instanceof Id||!f.isVisible()||c.push(this._lowers[e])}return b&&d>0&&c.sort(function(a,b){var c=a._left+a._top,d=b._left+b._top;return d>c?-1:c>d?1:0}),c},$_resetIndex:function(){var a,b;this._group.isRoot()||(b=this._type==Lc.ROW?this._group._cellIndex.rows():this._group._cellIndex.columns()),a=b?D(b):{},this instanceof Id&&(a[Pa.ATTR_ISSUM]=!0),
this._labelField&&(a[this._labelField.name()]=this._value),this._type==Lc.ROW?this._cellIndex.setRows(a):this._cellIndex.setColumns(a)},getTooltip:function(){for(var a="",b=this;b&&!b.isRoot();)""!=a&&(a=" - "+a),a=b._text+a,b=b._group;return a}}),Dd=Ga("GroupCellElement",Cd,{init:function(a,b,c){this._super(a,b,c),this._expander=new Nd(a,this,!0),this.addChild(this._expander),this._expander.addListener(this),this._expanded=!0,this._sumDeltaX=0,this._sumDeltaY=0,this._deflateW=0,this._deflateH=0},expander:null,summaryCell:null,expanded:function(){return this._expanded},expand:function(){this._expanded||(this._doExpand(this),this._expanded=!0,this._expander.setExpanded(!0),this._group&&this._group.$_inflateGroup(this,this._deflateW,this._deflateH),this.inflate(this._deflateW,this._deflateH),this._grid._changeClientSize(this._deflateW,this._deflateH))},collapse:function(){this._expanded&&(this._prepareCollapse(),this.inflate(-this._deflateW,-this._deflateH),this._doCollapse(this),this._expanded=!1,this._expander.setExpanded(!1),this._group&&this._group.$_inflateGroup(this,-this._deflateW,-this._deflateH),this._grid._changeClientSize(-this._deflateW,-this._deflateH))},sortByLabel:function(a,b){var c,d=this.getVisibleLowers(!1),e=d.length;if(e>1){var f=a[0]==Rc.ASCENDING,g=d[0].labelField();xa.sortLabels(d,g.name(),f,b,0,e-1);var h=this._summaryCell;if(this._type==Lc.COLUMN){var i=this._left;for(h&&h._left==i&&(i+=h._width),c=0;e>c;c++){var j=d[c];j.$_offsetMembers(i-j._left,0),i+=j._width}}else{var k=this._top;for(h&&h._top==k&&(k+=h._height),c=0;e>c;c++){var j=d[c];j.$_offsetMembers(0,k-j._top),k+=j._height}}}if(a.length>1)for(c=0;e>c;c++){var j=d[c];j instanceof Dd&&j.sortByLabel(a.slice(1,a.length),b)}},sortByValue:function(a,b,c,d){var e,f,g,h,i=[],j=this._type==Lc.COLUMN?"columnLabel":"rowLabel",k=this.getVisibleLowers(!1);for(e=0,g=k.length;g>e;e++){var l=this._lowers[e];l instanceof Dd&&l._summaryCell&&(l=l._summaryCell);var m=l._lowers.length;if(m>0&&l._lowers[0].isValueLabel())for(f=m;f--;)if(l._lowers[f].valueField().name()==b){l=l._lowers[f];break}for(f=0,h=a.length;h>f;f++)if(a[f].getProperty(j)==l){i.push(a[f]);break}}var n=i.length;if(n>1){var o=c==Rc.ASCENDING,p=k[0].labelField();xa.sortValues(i,p.name(),o,d,0,n-1);var q=this._summaryCell;if(this._type==Lc.COLUMN){var r=this._left;for(q&&q._left==r&&(r+=q._width),e=0;n>e;e++){var l=i[e].getProperty(j);l&&(l.isValueLabel()&&(l=l._group),l instanceof Id&&(l=l._group),l.$_offsetMembers(r-l._left,0),r+=l._width)}}else{var s=this._top;for(q&&q._top==s&&(s+=q._height),e=0;n>e;e++){var l=i[e].getProperty(j);l&&(l instanceof Id&&(l=l._group),l.$_offsetMembers(0,s-l._top),s+=l._height)}}}for(e=0,g=k.length;g>e;e++){var l=k[e];l instanceof Dd&&k[e].sortByValue(a,b,c,d)}},_prepareCollapse:function(){},_doExpand:function(a){},_doCollapse:function(a){for(var b=this._lowers.length;b--;){var c=this._lowers[b];this==a&&c instanceof Id?c.$_offsetMembers(this._sumDeltaX,this._sumDeltaY):c.$_toggleMembers(!1)}},$_getExpenderRect:function(){return new Sb(2,2,Nd.SIZE,Nd.SIZE)},_doLayoutContent:function(){var a=this.$_getExpenderRect();this._expander.setSize(a.width,a.height)},onGroupExpanderExpand:function(){this.expand()},onGroupExpanderCollapse:function(){this.collapse()}}),Ed=Ga("ColumnGroupCellElement",Dd,{init:function(a,b){this._super(a,Lc.COLUMN,b)},_doRender:function(a){this._super(a)},_prepareCollapse:function(){for(var a=da,b=0,c=this._lowers.length;c--;){var d=this._lowers[c];d instanceof Id?a=d._left:b+=d._width}this._sumDeltaX=a==da?0:this._left-a,this._deflateW=b},_doExpand:function(a){for(var b=this._left+(0==this._sumDeltaX?this._summaryCell._width:0),c=0,d=this._lowers.length;d>c;c++){var e=this._lowers[c],f=0==b?0:b-e._left;e instanceof Id?this==a?e.$_offsetMembers(-this._sumDeltaX,0):(e.$_toggleMembers(!0),e.$_offsetMembers(e._labelPosition==kd.FIRST?this._left-e._left:f,0)):(e.$_toggleMembers(!0),0!=this._sumDeltaX&&e.$_offsetMembers(f,0)),b+=e._width}}}),Fd=Ga("RowGroupCellElement",Dd,{init:function(a,b){this._super(a,Lc.ROW,b)},_doRender:function(a){this._super(a)},_prepareCollapse:function(){for(var a=da,b=0,c=this._lowers.length;c--;){var d=this._lowers[c];d instanceof Id?a=d._top:b+=d._height}this._sumDeltaY=a==da?0:this._top-a,this._deflateH=b},_doExpand:function(a){for(var b=this._top+(this._summaryCell._labelPosition==kd.FIRST?this._summaryCell._height:0),c=0,d=this._lowers.length;d>c;c++){var e=this._lowers[c],f=0==b?0:b-e._top;e instanceof Id?this==a?e.$_offsetMembers(0,-this._sumDeltaY):(e.$_toggleMembers(!0),e.$_offsetMembers(0,e._labelPosition==kd.FIRST?this._top-e._top:f)):(e.$_toggleMembers(!0),0!=this._sumDeltaY&&e.$_offsetMembers(0,f)),b+=e._height}}}),Gd=Ga("ColumnRootCellElement",Ed,{init:function(a){this._super(a,-1),this.setLeft(0)},isRoot:function(){return!0}}),Hd=Ga("RowRootCellElement",Fd,{init:function(a){this._super(a,-1),this.setTop(0)},isRoot:function(){return!0}}),Id=Ga("LabelSummaryCellElement",Cd,{init:function(a,b,c,d){this._super(a,b,c),this._mergeCount=d},labelPosition:kd.FIRST,_doLayoutContent:function(){},_doRender:function(a){this._super(a)}}),Jd=Ga("BodyCellElement",yd,{init:function(a,b){this._super(a,b)},destroy:function(){this._columnLabel&&this._columnLabel.removeBody(this),this._columnLabel=null,this._rowLabel&&this._rowLabel.removeBody(this),this._rowLabel=null,this._super()},columnLabel:null,rowLabel:null,valueField:null,value:null,setColumnLabel:function(a){a!=this._columnLabel&&(this._columnLabel&&this._columnLabel.removeBody(this),a&&a.addBody(this),this._columnLabel=a,this._cellIndex.setColumns(a.getCellIndex().columns()))},setRowLabel:function(a){a!=this._rowLabel&&(this._rowLabel&&this._rowLabel.removeBody(this),a&&a.addBody(this),this._rowLabel=a,this._cellIndex.setRows(a.getCellIndex().rows()))},setValueField:function(a){a!=this._valueField&&(this._valueField=a,this._cellIndex.setValueField(a.name()))},setValue:function(a){if(f(a)){this._valueField.expression();this._value=a;var b;b=g(a)?a.value:a,this._text=this._valueField.getDisplayText(b)}},_doLayoutContent:function(){},_doRender:function(a){this._super(a)},getTooltip:function(){for(var a="",b=this._columnLabel;b&&!b.isRoot();)b.valueField()||(""!=a&&(a=" - "+a),a=b.text()+a),b=b.group();var c=RealPivotMessages.columnText+" : "+a;for(a="",b=this._rowLabel;b&&!b.isRoot();)""!=a&&(a=" - "+a),a=b.text()+a,b=b.group();var d=RealPivotMessages.rowText+" : "+a,e=this._valueField.getFieldHeader(),f=RealPivotMessages.valueText+" : "+this._text,g="<br/>"+RealPivotMessages.countText+" : "+this._value.count;return e+"<br/>"+f+"<br/>"+c+"<br/>"+d+g}}),Kd=Ga("ValueCellElement",Jd,{init:function(a){this._super(a,"realpivot-body-value")},_doLayoutContent:function(){},_doRender:function(a){this._super(a)}}),Ld=Ga("SummaryCellElement",Jd,{init:function(a,b,c){var d="realpivot-body-sum";0==c&&0==b?d+=" realpivot-body-sum-tot":(c>za&&(d+=" realpivot-body-col-sum-"+(0==c?"tot":"d"+c)),b>za&&(d+=" realpivot-body-row-sum-"+(0==b?"tot":"d"+b))),this._super(a,d)},_doLayoutContent:function(){},_doRender:function(a){this._super(a)}}),Md=Ga("HandleElement",Oa,{init:function(a,b,c){this._super(a,c),this._css.removeProperty("position"),this._cellView=b},cellView:function(){return this._cellView}}),Nd=Ga("GroupExpander",Md,{init:function(a,b,c){this._expanded=arguments.length>2?c:!0,this._super(a,b,this.$_getCssClass())},destroy:function(){this._super()},expanded:!0,setExpanded:function(a){this._expanded!=a&&(this._expanded=a,this.setCssClass(this.$_getCssClass()))},$_getCssClass:function(){return this._expanded?"realpivot-expander-expand":"realpivot-expander-collapse"},_doClick:function(a){this._expanded?this.fireEvent(Nd.COLLAPSE):this.fireEvent(Nd.EXPAND)}},{SIZE:15});Nd.EXPAND="onGroupExpanderExpand",Nd.COLLAPSE="onGroupExpanderCollapse";var Od=Ga("LayerElement",La,{init:function(a){this._super(),this._grid=a,this._element.style.pointerEvents="none",this._element.style.zIndex=-1,this._css.position="absolute",this._layers=[]},destroy:function(){for(var a=0,b=this._layers.length;b>a;a++)this._element.removeChild(this._layers[0]);this._layers=[],this._super()},isLayer:function(){return!0}}),Pd=Ga("LayerElement",La,{init:function(){this._super(),this._element.className="realpivot-mask",this.setVisible(!1)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)}}),Qd={LINE_UP:"lineUp",LINE_DOWN:"lineDown",LINE_LEFT:"lineLeft",LINE_RIGHT:"lineRight",PAGE_UP:"pageUp",PAGE_DOWN:"pageDown",PAGE_LEFT:"pageLeft",PAGE_RIGHT:"pageRight",WHEEL_X:"wheelX",WHEEL_Y:"wheelY",THUMB_TRACK:"thumbTrack",THUMB_END:"thumbEnd"},Rd=Ga("ScrollContainer",La,{init:function(a){this._super(),this._owner=a,this._isContainer=!0,this._css.position="absolute",this._css.zIndex=-1,this._css.pointerEvents="none",this._hscrollBar=new Sd(a,this,!1),this.addChild(this._hscrollBar),this._vscrollBar=new Sd(a,this,!0),this.addChild(this._vscrollBar),this._hscrollBar.addListener(this),this._vscrollBar.addListener(this),this._corner=new Vd(a),this.addChild(this._corner),this._scrollWidth=0,this._scrollHeight=0},destroy:function(){this._super(),this._hscrollBar=null,this._vscrollBar=null,this._corner=null},hscrollBar:null,vscrollBar:null,hscrollable:!1,vscrollable:!1,scrollBarSize:15,leftPos:0,topPos:0,setLeftPos:function(a){a!=this._leftPos&&(a=ma(0,la(a,this._maxWidth-this._scrollWidth)),this._owner.scrollTo(a-this._leftPos,0),this._leftPos=a)},setTopPos:function(a){a!=this._topPos&&(a=ma(0,la(a,this._maxHeight-this._scrollHeight)),this._owner.scrollTo(0,a-this._topPos),this._topPos=a)},wheelScroll:function(a,b){var c=!1;return this._hscrollable&&(c=this._hscrollBar._doScroll(Qd.WHEEL_X,-a,0)),this._vscrollable&&(c=c||this._vscrollBar._doScroll(Qd.WHEEL_Y,-b,0)),c},clientWidth:function(){return this._width-(this._vscrollable?this._scrollBarSize:0)},clientHeight:function(){return this._height-(this._hscrollable?this._scrollBarSize:0)},updateScroll:function(a,b,c,d,e){var f=a.clone();this.setRect(f);var g=b+d,h=c+e;this._measure(g,h),this._maxWidth=b,this._maxHeight=c;var i,j;this.layoutContent(),this._leftPos>g-a.width&&this.setLeftPos(ma(g-a.width,0)),this._topPos>h-a.height&&this.setTopPos(ma(h-a.height,0)),this._hscrollable&&(i=b,this._scrollWidth=f.width-d-(this._vscrollable?this._scrollBarSize:0),j=Math.min(this._scrollWidth,b-this._leftPos),this._hscrollBar.setProperties(0,i,j),this._hscrollBar.setPosition(this._leftPos)),this._vscrollable&&(i=c,this._scrollHeight=f.height-e-(this._hscrollable?this._scrollBarSize:0),j=Math.min(this._scrollHeight,c-this._topPos),this._vscrollBar.setProperties(0,i,j),this._vscrollBar.setPosition(this._topPos))},_measure:function(a,b){this._hscrollable=a>this._width,this._vscrollable=b>this._height;var c=this._scrollBarSize;this._hscrollable&&(this._vscrollable=b>this._height-c),this._vscrollable&&(this._hscrollable=a>this._width-c)},_doLayoutContent:function(){var a=this._width,b=this._height,c=this._scrollBarSize,d=this._vscrollable?c:0,e=this._hscrollable?c:0;this._hscrollBar.setVisible(this._hscrollable),this._hscrollable&&this._hscrollBar.setBounds(0,b-c,a-d,c),this._vscrollBar.setVisible(this._vscrollable),this._vscrollable&&this._vscrollBar.setBounds(a-c,0,c,b-e),this._corner.setVisible(this._hscrollable&&this._vscrollable),this._corner.isVisible()&&this._corner.setBounds(a-c,b-c,c,c)},onScrollBarScrolled:function(a,b,c,d){var e=a.getScrollUnit(b);if(a.isVertical())switch(b){case Qd.LINE_DOWN:case Qd.LINE_UP:case Qd.PAGE_DOWN:case Qd.PAGE_UP:this.setTopPos(this.topPos()+c*e);break;case Qd.WHEEL_Y:this.setTopPos(this.topPos()+c);break;default:this.setTopPos(d)}else switch(b){case Qd.LINE_RIGHT:case Qd.LINE_LEFT:case Qd.PAGE_RIGHT:case Qd.PAGE_LEFT:this.setLeftPos(this.leftPos()+c*e);break;case Qd.WHEEL_X:this.setLeftPos(this.leftPos()+c);break;default:this.setLeftPos(d)}}}),Sd=Ga("ScrollBar",Oa,{init:function(a,b,c){this._super(a,"realpivot-sbar"),this._vertical=c,this._container=b,this._nearButton=new Td(a,this,!1),this.addChild(this._nearButton),this._farButton=new Td(a,this,!0),this.addChild(this._farButton),this._thumb=new Ud(a,this),this.addChild(this._thumb),this._buttonSize=20,this._min=0,this._max=0,this._pos=0,this._page=0,this._maxPosition=0},destroy:function(){this._super(),this._nearButton=null,this._farButton=null,this._thumb=null},linescrollBarSize:1,pagescrollBarSize:10,minThumbSize:20,isVertical:function(){return this._vertical},maxPosition:function(){return this._maxPosition},getScrollUnit:function(a){switch(a){case Qd.LINE_DOWN:case Qd.LINE_UP:case Qd.LINE_RIGHT:case Qd.LINE_LEFT:return Sd.SCROLL_LINE_SIZE*this.linescrollBarSize();case Qd.PAGE_DOWN:case Qd.PAGE_UP:case Qd.PAGE_RIGHT:case Qd.PAGE_LEFT:return Sd.SCROLL_LINE_SIZE*this.pagescrollBarSize();default:return 1}},setProperties:function(a,b,c){a=Math.max(0,a),b=Math.max(a,b),(a!=this._min||b!=this._max||c!=this._page)&&(this._min=a,this._max=b,this._page=c,this._pos=Math.min(this._max,Math.max(this._min,this._pos)),this._maxPosition=Math.max(0,this._max-this._page),this._doLayoutContent())},setPosition:function(a){return a=Math.min(this._maxPosition,Math.max(this._min,a)),a!=this._pos?(this._pos=a,this._doLayoutContent(),!0):!1},ptInTrack:function(a,b,c){var d=this.containerToElement(a,b);if(this._vertical){if(d.y>=this._nearButton.height()&&d.x<this._farButton.y())return!c&&d.y<this._thumb.y()||c&&d.y>=this._thumb.bottom()}else if(a>=this._nearButton.width()&&a<this._farButton.x())return!c&&d.x<this._thumb.x()||c&&d.x>=this._thumb.right();return!1},_doLayoutContent:function(){var a=this._vertical,b=this._buttonSize,c=(a?this._height:this._width)-2*b,d=Math.min(c,Math.max(this._minThumbSize,ja(c*this._page/(this._max-this._min+1)))),e=b+Math.min(c-d,Math.max(0,ja((c-d)*this._pos/(this._maxPosition-this._min))));a?(this._nearButton.setBounds(0,0,this._width,b),this._farButton.setBounds(0,this._height-b,this._width,b),c>=d&&this._thumb.setBounds(1,e,this._width-2,d)):(this._nearButton.setBounds(0,0,b,this._height),this._farButton.setBounds(this._width-b,0,b,this._height),c>=d&&this._thumb.setBounds(e,1,d,this._height-2))},_doScroll:function(a,b,c){var d=!1;return 0!=b?d=this.setPosition(this._pos+b*this.getScrollUnit(a)):c&&(d=this.setPosition(c)),d&&this.fireEvent(Sd.SCROLLED,a,b,c),d},_mouseOut:function(){this._nearButton.setPressed(!1),this._farButton.setPressed(!1),this._thumb.setPressed(!1)},_doClick:function(a,b){this._vertical?b<this._thumb.top()?this._doScroll(Qd.PAGE_UP,-1,0):this._doScroll(Qd.PAGE_DOWN,1,0):a<this._thumb.left()?this._doScroll(Qd.PAGE_LEFT,-1,0):this._doScroll(Qd.PAGE_RIGHT,1,0)}});Sd.SCROLL_LINE_SIZE=20,Sd.SCROLLED="onScrollBarScrolled";var Td=Ga("ScrollButton",Oa,{init:function(a,b,c){var d=this.$_getClassName(b.isVertical(),c);this._super(a,d),this._scrollBar=b,this._far=c},destroy:function(){this._scrollBar=null,this._super()},far:!1,enabled:!0,pressed:!1,setPressed:function(a){a!=this._pressed&&(this.setCssClass(this.$_getClassName(this.isVertical(),this._far,a)),this._pressed=a)},isVertical:function(){return this._scrollBar.isVertical()},scrollBar:function(){return this._scrollBar},_doClick:function(a,b){this.isVertical()?this._far?this._scrollBar._doScroll(Qd.LINE_DOWN,1,0):this._scrollBar._doScroll(Qd.LINE_UP,-1,0):this._far?this._scrollBar._doScroll(Qd.LINE_RIGHT,1,0):this._scrollBar._doScroll(Qd.LINE_LEFT,-1,0)},$_getClassName:function(a,b,c){var d=c?"realpivot-sbar-button-pressed":"realpivot-sbar-button",e=a?"realpivot-sbar-v":"realpivot-sbar-h";return e+=b?"fbutton":"nbutton",d+" "+e}}),Ud=Ga("ScrollThumb",Oa,{init:function(a,b){this._scrollBar=b,this._request=null,this._super(a,this.$_getClassName())},pressed:!1,setPressed:function(a){a!=this._pressed&&(this.setCssClass(this.$_getClassName(a)),this._pressed=a)},destroy:function(){this._scrollBar=null,this._request=null,this._super()},scrollBar:function(){return this._scrollBar},isVertical:function(){return this._scrollBar._vertical},getRequest:function(){return this._request||(this._request=new Wd(this)),this._request},getTracker:function(a,b){return new Xd},$_getClassName:function(a){return cls=a?"realpivot-sbar-thumb-pressed":"realpivot-sbar-thumb"}}),Vd=Ga("ScrollBarCorner",Na,{init:function(a){this._super(a,"realpivot-sbar-corner")}}),Wd=Ga("ScrollThumbRequest",Yc,{init:function(a){this._super(),this._thumb=a},thumb:function(){return this._thumb},scrollBar:function(){return this._thumb.scrollBar()},cursor:function(){return dc.POINTER},isSelectable:function(){return!1}}),Xd=Ga("ScrollThumbTracker",dd,{init:function(a,b,c){this._super(a.scrollBar().grid(),"scrollThumbTracker"),this._request=a,this._thumb=a.thumb(),this._scrollBar=a.scrollBar(),this._vertical=this._scrollBar.isVertical();var d=this._scrollBar.containerToClient(b,c);this._scrollBar.isVertical()?this._offset=d.y-this._thumb.top():this._offset=d.x-this._thumb.left()},destroy:function(){this._request=null,this._thumb=null,this._scrollBar=null,this._super()},isStartWhenCreated:function(){return!0},_doStart:function(a,b){return this._thumb.setPressed(!0),!0},_doDrag:function(a,b){return this.$_doScroll(a,b,Qd.THUMB_TRACK)},_doCompleted:function(a,b){return this.$_doScroll(a,b,Qd.THUMB_END)},_doCanceled:function(a,b){},_doEnded:function(){this._thumb.setPressed(!1)},$_doScroll:function(a,b,c){var d=this._scrollBar._maxPosition-this._scrollBar._min+1,e=this._scrollBar._buttonSize,f=this._scrollBar.containerToClient(a,b);if(this._scrollBar.isVertical()){var g=this._scrollBar.height()-2*e-this._thumb.height();if(0>=g)return;f.y-=this._offset,f.y=(f.y-e)*d/g,this._scrollBar._doScroll(c,0,ja(f.y))}else{var g=this._scrollBar.width()-2*e-this._thumb.width();if(0>=g)return;f.x-=this._offset,f.x=(f.x-e)*d/g,this._scrollBar._doScroll(c,0,ja(f.x))}return!0}}),Yd=Ga("PivotView",La,{init:function(a){this._super(),this._container=a,this._setupView=null,this._container.appendChild(this._element),this.setParentElement(this._container),this._element.className="realpivot",this._css.position="relative",this._eventHandlers={},this._eventNodes=[],this._activeTool=this._createDefaultTool(),this._displayOptions=new od,this._summaryOptions=new pd,this._headerOptions=new qd,this._tmpDisplayOptions=new od,this._tmpSummaryOptions=new pd,this._tmpHeaderOptions=new qd,this._noreadyView=new sd(this),this.addChild(this._noreadyView),this._emptyView=new rd(this),this.addChild(this._emptyView),this._bodyContainer=new Ma,this.addChild(this._bodyContainer),this._rowContainer=new Ma,this.addChild(this._rowContainer),this._colContainer=new Ma,this.addChild(this._colContainer),this._bodyView=new xd(this),this._bodyContainer.addChild(this._bodyView),this._rowView=new wd(this),this._rowContainer.addChild(this._rowView),this._columnView=new vd(this),this._colContainer.addChild(this._columnView),this._headerView=new td(this),this.addChild(this._headerView),this._layerView=new Od(this),this.addChild(this._layerView),this._scrollContainer=new Rd(this),this.addChild(this._scrollContainer),this._maskView=new Pd,this.addChild(this._maskView),this._tooltipManager=new ac(this._element),this._progressManager=new $b(this._element),this._contextDefItems=[{text:"About RealPivot",callback:this._aboutMenuHandler}],this._contextItems=[],this._contextMenuManager=new cc(this._element,this._contextDefItems),this._registerListners(),this._layouted=!1,this._offsetX=0,this._offsetY=0;var b=this._element;do b.offsetLeft&&(this._offsetX+=b.offsetLeft),b.offsetTop&&(this._offsetY+=b.offsetTop);while(b=b.offsetParent);this._orgColumnWidths=[],this._orgRowHeights=[],this._columnPoints=[],this._rowPoints=[],this._columnLevelHeights=[],this._rowLevelWidths=[],this._titleHeight=0,this._columnHeight=0,this._colsWidth=0,this._rowsHeight=0,this._centralPt=new Ub,this.resetSize()},destroy:function(){this._removeListenerAll(),xa.freeAndNull(this._tooltipManager),xa.freeAndNull(this._progressManager),xa.freeAndNull(this._displayOptions),xa.freeAndNull(this._summaryOptions),xa.freeAndNull(this._headerOptions),this._centralPt=null,this._container=null,this._dataSource=null,this._setupView=null,this._super()},displayOptions:null,headerOptions:null,summaryOptions:null,tmpDisplayOptions:null,tmpHeaderOptions:null,tmpSummaryOptions:null,dataSource:null,setupView:function(){return this._setupView},setSetupView:function(a){this._setupView=a},headerView:function(){return this._headerView},columnView:function(){return this._columnView},rowView:function(){return this._rowView},bodyView:function(){return this._bodyView},columnPoints:function(){return this._columnPoints},rowPoints:function(){return this._rowPoints},titleHeight:function(){return this._titleHeight},columnWidth:function(){return this._colsWidth},columnHeight:function(){return this._columnHeight},rowWidth:function(){return this._rowWidth},rowHeight:function(){return this._rowsHeight},columnLevelHeight:function(a){return this._columnLevelHeights[a]},rowLevelWidth:function(a){return this._rowLevelWidths[a]},columnLevelHeights:function(){return this._columnLevelHeights},rowLevelWidths:function(){return this._rowLevelWidths},tooltipManager:function(){return this._tooltipManager},contextMenuManager:function(){return this._contextMenuManager},getColumnDepth:function(){return this._columnLevelHeights.length},getRowDepth:function(){return this._rowLevelWidths.length},getLeafColumnCount:function(){return this._columnPoints.length-1},getLeafRowCount:function(){return this._rowPoints.length-1},getVisibleColumnCount:function(){return this._columnView.getVisibleLeafCount()},getVisibleRowCount:function(){return this._rowView.getVisibleLeafCount()},getColumnLevelSumHeight:function(a,b){a=ma(a,0),b=la(b,this._columnLevelHeights.length-1);for(var c=0,d=a;b>=d;d++)c+=this._columnLevelHeights[d];return c},getRowLevelSumWidth:function(a,b){a=ma(a,0),b=la(b,this._rowLevelWidths.length-1);for(var c=0,d=a;b>=d;d++)c+=this._rowLevelWidths[d];return c},valueLabelVisible:function(){return this._dataSource.fieldManager().valueCount()>1},leftPos:function(){return this._scrollContainer.leftPos()},topPos:function(){return this._scrollContainer.topPos()},setOrgColumnWidth:function(a,b){var c=D(a.getCellIndex().columns());(vfield=a.valueField())&&(c[Pa.ATTR_VFIELD]=vfield.name());for(var d=this._orgColumnWidths.length;d--;){var e=this._orgColumnWidths[d];if(p(e,c,"width"))return void(e.width=b)}c.width=b,this._orgColumnWidths.push(c)},setOrgRowHeight:function(a,b){for(var c=D(a.getCellIndex().rows()),d=this._orgRowHeights.length;d--;){var e=this._orgRowHeights[d];if(p(e,c,"height"))return void(e.height=b)}c.height=b,this._orgRowHeights.push(c)},changeColumnLevelHeight:function(a,b){c("changeColumnLevelHeight "+a+b),this._headerView.changeTitleSize(0,b),this._columnView.changeHeight(a,b),this._rowContainer.shift(0,b),this._bodyContainer.shift(0,b),this._centralPt.y+=b,this._updateScroll();var d=this._columnLevelHeights[a]+b;this._columnLevelHeights[a]=d},changeRowLevelWidth:function(a,b){c("changeRowLevelHeight "+a+b),this._headerView.changeTitleSize(b,0),this._rowView.changeWidth(a,b),this._colContainer.shift(b,0),this._bodyContainer.shift(b,0),this._centralPt.x+=b,this._updateScroll();var d=this._rowLevelWidths[a]+b;this._rowLevelWidths[a]=d},_registerListners:function(){var a=this._element;this._addListener(T,"resize",this._resizeHandler.bind(this),!1),this._addListener(T,"keydown",this._keyDownHandler.bind(this),!1),this._addListener(T,"keyup",this._keyUpHandler.bind(this),!1),this._addListener(T,"keypress",this._keyPressHandler.bind(this),!1),this._addListener(a,"click",this._clickHandler.bind(this),!1),this._addListener(a,"dblclick",this._dblclickHandler.bind(this),!1),this._addListener(T,"mousedown",this._globalMouseDownHandler.bind(this),!1),this._addListener(a,"mousedown",this._mouseDownHandler.bind(this),!1),this._addListener(T,"mousemove",this._mouseMoveHandler.bind(this),!1),this._addListener(T,"mouseup",this._mouseUpHandler.bind(this),!1),this._addListener(a,"mouseenter",this._mouseEnterHandler.bind(this),!1),this._addListener(a,"mouseleave",this._mouseLeaveHandler.bind(this),!1),this._addListener(a,"mouseover",this._mouseOverHandler.bind(this),!1),this._addListener(a,"touchstart",this._touchStartHandler.bind(this),!1),this._addListener(a,"touchmove",this._touchMoveHandler.bind(this),!1),this._addListener(a,"touchend",this._touchEndHandler.bind(this),!1),this._addListener(a,"touchcancel",this._touchCancelHandler.bind(this),!1),this._addListener(a,"touchleave",this._touchLeaveHandler.bind(this),!1),qa?this._addListener(a,"DOMMouseScroll",this._mouseScrollHandler.bind(this),!1):this._addListener(a,"mousewheel",this._mouseWheelHandler.bind(this),!1)},_addListener:function(a,b,c,d){a in this._eventHandlers||(this._eventHandlers[a]={}),b in this._eventHandlers[a]||(this._eventHandlers[a][b]=[]),this._eventHandlers[a][b].push([c,d]),Ib.addEventListener(a,b,c,d),this._eventNodes.indexOf(a)<0&&this._eventNodes.push(a)},_removeListenerAll:function(){for(var a=this._eventNodes,b=0,c=a.length;c>b;b++){var d=a[b];if(d in this._eventHandlers){var e=this._eventHandlers[d];for(var f in e){for(var g=e[f],h=g.length;h--;){var i=g[h];Ib.removeEventListener(d,f,i[0],i[1]),delete g[h]}delete e[f]}delete e,delete this._eventHandlers[d]}delete a[b]}},_createDefaultTool:function(){return new jd(this)},$_initLabelPoints:function(a,b,c,d,e,f,g,h,i){d&&f&&h(b,c,!0,g,i);for(var j=0,k=a.length;k>j;j++){var l=a[j],m=b.concat(l.name),n=c.concat(l.value);l.hasOwnProperty("childs")?this.$_initLabelPoints(l.childs,m,n,e,e,f,g,h,i):h(m,n,!1,g,i)}d&&!f&&h(b,c,!0,g,i)},$_addColumnPoints:function(a,b,c,d,e){for(var g=this._columnPoints.length,h=this._columnPoints[g-1],i=0;i<e.length;i++){var j=this.$_findOrgColumnWidth(a.concat(Pa.ATTR_VFIELD),b.concat(e[i]),c);f(j)||(j=d),this._columnPoints.push(h+j),h+=j}},$_addRowPoints:function(a,b,c,d){var e=this._rowPoints.length,g=this._rowPoints[e-1],h=this.$_findOrgRowHeight(a,b,c);f(h)||(h=d),this._rowPoints.push(g+h)},$_findOrgColumnWidth:function(a,b,c){for(var d={},e=a.length;e--;)d[a[e]]=b[e];for(c&&(d[Pa.ATTR_ISSUM]=!0),e=this._orgColumnWidths.length;e--;){var f=this._orgColumnWidths[e];if(p(d,f,"width"))return f.width}return null},$_findOrgRowHeight:function(a,b,c){for(var d={},e=a.length;e--;)d[a[e]]=b[e];c&&(d[Pa.ATTR_ISSUM]=!0);for(var e=this._orgRowHeights.length;e--;){var f=this._orgRowHeights[e];if(p(d,f,"height"))return f.height}return null},$_calcLabelPoints:function(){var a=this._dataSource,b=this._displayOptions,c=b.columnWidth(),d=b.columnHeight(),e=b.rowHeight(),f=b.rowLabelWidth(),g=b.rowGroupWidth(),h=this._summaryOptions,j=h.columnPosition()==kd.FIRST,k=h.rowPosition()==kd.FIRST,l=h.isColumnVisible(),m=h.isColumnGroupVisible(),n=h.isRowVisible(),o=h.isRowGroupVisible(),p=a.fieldManager(),q=p.getValueNames(),r=q.length,s=p.columnCount(),t=p.rowCount(),u=this._columnDepth=ma(s+(r>1?1:0),l?1:0),v=this._rowDepth=ma(t,n?1:0);for(this._columnPoints=[0],this._rowPoints=[0],this.$_initLabelPoints(a._columnLabels,[],[],l,m,j,c,this.$_addColumnPoints.bind(this),q),this.$_initLabelPoints(a._rowLabels,[],[],n,o,k,e,this.$_addRowPoints.bind(this)),this._columnHeight=0,this._columnLevelHeights.length=u,i=0;i<u;i++)this._columnLevelHeights[i]=d,this._columnHeight+=this._columnLevelHeights[i];for(this._rowWidth=0,this._rowLevelWidths.length=v,i=0;i<v;i++)this._rowLevelWidths[i]=i==v-1?f:g,this._rowWidth+=this._rowLevelWidths[i]},_updateScroll:function(a){if(!a){var a=this.clientRect();a.inflate(0,0,-this._spaceWidth,-this._spaceHeight)}this._scrollContainer.updateScroll(a,this._colsWidth,this._rowsHeight,this._centralPt.x,this._centralPt.y)},_doLayoutContent:function(){var a=this._dataSource,b=a.fieldManager(),c=this._tmpHeaderOptions,d=this._tmpDisplayOptions,e=d.isShowProgress(),f=d.maxStableCellCount();if(!(f>0&&this._dataSource.getBodyCount()>f)||confirm(RealPivotMessages.manyCellConfirmMessage)){var g=this.clientRect(),h=this._layerView;this._scrollContainer.setLeftPos(0),this._scrollContainer.setTopPos(0),this._colContainer.removeChild(this._columnView),this._rowContainer.removeChild(this._rowView),this._bodyContainer.removeChild(this._bodyView),this._columnView._clearCells(),this._rowView._clearCells(),this._bodyView._clearCells(),h.setRect(g);var i=g.clone();if(i.inflate(0,0,-this._spaceWidth,-this._spaceHeight),a.isEmpty())this._emptyView.setVisible(!1),this._noreadyView.setVisible(!0),i.inflate(-1,-1),this._noreadyView.setRectI(i),this._noreadyView.layoutContent();else if(a.isDataEmpty())this._noreadyView.setVisible(!1),this._emptyView.setVisible(!0),i.inflate(-1,-1),this._emptyView.setRectI(i),this._emptyView.layoutContent();else{this._noreadyView.setVisible(!1),this._emptyView.setVisible(!1),this.$_calcLabelPoints();var j=this._titleHeight=c.isTitleVisible()||c.isColumnHeadVisible()?c.titleHeight():0,k=2*j-this._columnHeight;k>0&&(this._columnHeight+=k,this._columnLevelHeights[this._columnLevelHeights.length-1]+=k),this._centralPt.set(this._rowWidth,j+this._columnHeight);var l=this._colsWidth=this._columnPoints[this._columnPoints.length-1],m=this._rowsHeight=this._rowPoints[this._rowPoints.length-1];this._updateScroll(i),this._scrollContainer.isHscrollable()&&(i.height-=this._scrollContainer.scrollBarSize()),this._scrollContainer.isVscrollable()&&(i.width-=this._scrollContainer.scrollBarSize());var n=i.width-this._centralPt.x,o=i.height-this._centralPt.y;this._rowContainer.setBounds(0,this._centralPt.y,i.width,o),this._colContainer.setBounds(this._centralPt.x,j,n,i.height),this._columnView.setBounds(0,0,l,this._centralPt.y-j),this._columnView.setLabels(a._columnLabels),this._columnView.setDepth(this._columnDepth),this._columnView.setValues(b.getValues()),this._rowView.setBounds(0,0,this._centralPt.x,m),this._rowView.setLabels(a._rowLabels),this._rowView.setDepth(this._rowDepth);var p=i.clone();p.height=this._centralPt.y,this._headerView.setColumnFields(b.getColumns()),this._headerView.setRowFields(b.getRows()),this._headerView.setValueFields(b.getValues()),this._headerView.setRectI(p),this._headerView.layoutContent(),this._bodyContainer.setBounds(this._centralPt.x,this._centralPt.y,n,o);var q=new Sb(0,0,l,m);this._bodyView.setRectI(q),this._bodyView.setColumnView(this._columnView),this._bodyView.setRowView(this._rowView),this._bodyView.setValueFields(b.getValues()),this._bodyView.setValues(a._values),this._bodyView.setSummaries(a._summaries),e?(this.showProgress((this._columnPoints.length-1)*(this._rowPoints.length-1),RealPivotMessages.progressMessage),this._columnView.layoutContent(),this._rowView.layoutContent(),this.increaseProgress(this._columnPoints.length+this._rowPoints.length)):(this._columnView.layoutContent(),this._rowView.layoutContent()),setTimeout(function(){this._bodyView.layoutContent(function(){setTimeout(function(){this._bodyContainer.addChild(this._bodyView),this._colContainer.addChild(this._columnView),this._rowContainer.addChild(this._rowView),this._layouted=!0}.bind(this))}.bind(this));var a=this._scrollContainer.clientWidth(),b=this._scrollContainer.clientHeight();this._colContainer.resize(a-this._centralPt.x,b),this._rowContainer.resize(a,b-this._centralPt.y),this._headerView.setWidth(a)}.bind(this),100)}setTimeout(function(){})}},_doRender:function(a){},draw:function(){this._tmpDisplayOptions.assign(this._displayOptions),this._tmpSummaryOptions.assign(this._summaryOptions),this._tmpHeaderOptions.assign(this._headerOptions),this.layoutContent()},setDataSource:function(a){ba(a instanceof Xc,"dataSource must be PivotDataProvider"),this._dataSource=a,a.addListener(this)},onPivotDataRefreshed:function(){this._layouted&&this.layoutContent()},getOptions:function(){return{display:this.getDisplayOptions(),summary:this.getSummaryOptions(),header:this.getHeaderOptions()}},setOptions:function(a){a.display&&this.setDisplayOptions(a.display),a.summary&&this.setSummaryOptions(a.summary),a.header&&this.setHeaderOptions(a.header)},getDisplayOptions:function(){return this._displayOptions.proxy()},setDisplayOptions:function(a){
this._displayOptions.assign(a)},getSummaryOptions:function(){return this._summaryOptions.proxy()},setSummaryOptions:function(a){this._summaryOptions.assign(a)},getHeaderOptions:function(){return this._headerOptions.proxy()},setHeaderOptions:function(a){this._headerOptions.assign(a)},_changeClientSize:function(a,b){this._colsWidth+=a,this._rowsHeight+=b,this._updateScroll();var c=this._scrollContainer.clientWidth()-this._centralPt.x,d=this._scrollContainer.clientHeight()-this._centralPt.y;this._colContainer.resize(c+this._centralPt.x,d),this._rowContainer.resize(c,d+this._centralPt.y),this._bodyContainer.resize(c,d)},setCursor:function(a){this._css.cursor=a},resetSize:function(){var a=this._container.getBoundingClientRect();this._calcOuterSpace(),this.setBounds(0,0,a.width-this._spaceWidth,a.height-this._spaceHeight);var b=this._container.getBoundingClientRect();if((a.width!=b.width||a.height!=b.height)&&(b.width-=this._spaceWidth,b.height-=this._spaceHeight,a=b,this.setBounds(0,0,a.width-this._spaceWidth,a.height-this._spaceHeight)),this._layouted){var c=this._layerView.getChild(0);c&&c.resize(a.width,a.height),this._updateScroll();var d=this._scrollContainer.clientWidth(),e=this._scrollContainer.clientHeight(),f=d-this._centralPt.x,g=e-this._centralPt.y;this._headerView.setWidth(d),this._colContainer.resize(f,e),this._rowContainer.resize(d,g),this._bodyContainer.resize(f,g)}},scrollTo:function(a,b){0!=a&&(this._columnView.offset(-a,0),this._bodyView.offset(-a,0)),0!=b&&(this._rowView.offset(0,-b),this._bodyView.offset(0,-b))},sort:function(a){var b=this._dataSource.fieldManager(),c=b.getColumns(),d=b.getRows(),e=b.getValues(),f=a.comparer?a.comparer:wa;b.clearSort(),a.column&&this.$_sortView(Lc.COLUMN,a.column,this._columnView,this._rowView,c,e,f),a.row&&this.$_sortView(Lc.ROW,a.row,this._rowView,this._columnView,d,e,f),this._headerView.layoutContent()},"export":function(a){(new le)["export"](this,a)},$_sortView:function(a,b,c,d,e,f,g){if(b.method==Qc.LABEL){var h=b.labels;ba(h,"[sort] No 'labels' attribute in config.");for(var i=[],j=0,k=e.length;k>j;j++){var l=Rc.ASCENDING;if(h)for(var m=e[j].name(),n=0,o=h.length;o>n;n++)if(h[n].name==m){l=h[n].direction,e[j].setSortDir(l);break}i.push(l)}c.sortByLabel(i,g)}else{var p=!b.conditions||b.conditions.length<d.depth(),q=b.fieldName,e=this._dataSource.fieldManager(),l=b.direction?b.direction:Rc.ASCENDING;e.setValueSort(a,q,l,b.conditions);var r=d.findCell(b.conditions,q,p);c.sortByRef(r,q,l,g)}},showMask:function(){this._maskView.show()},hideMask:function(){this._maskView.hide()},showProgress:function(a,b){this._progressManager.show(b,!1),this._progressMin=0,this._progressCurr=0,this._progressMax=a,this._progressManager.setProperties(this._progressMin,a,this._progressCurr,b,!0)},completeProgress:function(){this._progressManager.setProperties(this._progressMin,this._progressMax,this._progressMax,null,!0)},increaseProgress:function(a){this._progressCurr+=a,this._progressManager.setProperties(this._progressMin,this._progressMax,this._progressCurr,null,!0)},closeProgress:function(){this._progressManager.close()},addLayerElement:function(a){return a&&!this._layerView.contains(a)?(this._layerView.addChild(a),!0):!1},removeLayerElement:function(a){return this._layerView.contains(a)?(this._layerView.removeChild(a),!0):!1},toOffset:function(a){var b=this._element,c=b.getBoundingClientRect();return a.mouseX=a.clientX-c.left,a.mouseY=a.clientY-c.top,a},toScreen:function(a){return a.x+=this._offsetX,a.y+=this._offsetY,a},toScreenPt:function(a){a.x+=this._offsetX,a.y+=this._offsetY},isPopuped:function(){return this._setupView&&this._setupView.isActive()||this._contextMenuManager&&this._contextMenuManager.isVisible()},getContextMenu:function(a){return this._contextItems.slice()},setContextMenu:function(a){a&&m(a)?(this._contextItems=a.slice(),this._contextMenuManager.setItems(this._contextDefItems.concat({text:"-"}).concat(this._contextItems))):(this._contextItems=[],this._contextMenuManager.setItems(this._contextDefItems))},_aboutMenuHandler:function(){alert("RealPivot version "+RealPivotClass.getVersion())},_fireClick:function(a){if(a instanceof Cd||a instanceof Jd){var b=a.getCellIndex();this.fireEvent(Yd.CLICK,a instanceof Cd?a.type():"body",b)}},_fireDblClick:function(a){if(a instanceof Cd||a instanceof Jd){var b=a.getCellIndex();this.fireEvent(Yd.DBL_CLICK,a instanceof Cd?a.type():"body",b)}},_fireShowTooltip:function(a,b){return this.fireObjectEvent(Yd.SHOW_TOOLTIP,a,b)},_fireShowLabelTooltip:function(a,b){return this.fireObjectEvent(Yd.SHOW_LABEL_TOOLTIP,a,b)},_resizeHandler:function(a){this.resetSize()},_keyDownHandler:function(a){if(this._activeTool){oa&&a.metaKey||!oa&&a.ctrlKey;this._activeTool.keyDown(a.keyCode,a.ctrlKey,a.shiftKey,a.altKey)}},_keyUpHandler:function(a){if(this._activeTool){oa&&a.metaKey||!oa&&a.ctrlKey;this._activeTool.keyUp(a.keyCode,a.ctrlKey,a.shiftKey,a.altKey)}},_keyPressHandler:function(a){this._activeTool&&this._activeTool.keyPress(a.keyCode)},_clickHandler:function(a){this._activeTool&&this._activeTool.click(this.toOffset(a))},_dblclickHandler:function(a){this._activeTool&&this._activeTool.dblclick(this.toOffset(a))},_globalMouseDownHandler:function(a){if(this._contextMenuManager.isVisible()){for(var b=a.target;b&&!b.menuItem&&"realpivot-title-menu"!=b.className;)b=b.parentNode;b||this._contextMenuManager.close()}},_mouseDownHandler:function(a){this._activeTool&&this._activeTool.mouseDown(this.toOffset(a))},_mouseMoveHandler:function(a){this._activeTool&&this._activeTool.mouseMove(this.toOffset(a))},_mouseUpHandler:function(a){this._activeTool&&this._activeTool.mouseUp(this.toOffset(a))},_mouseEnterHandler:function(a){this._activeTool&&this._activeTool.mouseEnter(this.toOffset(a))},_mouseLeaveHandler:function(a){this._activeTool&&this._activeTool.mouseLeave(this.toOffset(a))},_mouseOverHandler:function(a){this._activeTool&&this._activeTool.mouseLeave(this.toOffset(a))},_mouseWheelHandler:function(a){this._activeTool&&this._activeTool.mouseWheel(this.toOffset(a))&&B(a)},_mouseScrollHandler:function(a){this._activeTool&&(a.wheelDelta=3*-a.detail,this._activeTool.mouseWheel(this.toOffset(a))&&B(a))},_touchStartHandler:function(a){this._activeTool&&this._activeTool.touchStart(a)},_touchMoveHandler:function(a){this._activeTool&&this._activeTool.touchMove(a)},_touchEndHandler:function(a){this._activeTool&&this._activeTool.touchEnd(a)},_touchCancelHandler:function(a){this._activeTool&&this._activeTool.touchCancel(a)},_touchLeaveHandler:function(a){this._activeTool&&this._activeTool.touchEnd(a)}});Yd.CLICK="onPivotViewClick",Yd.DBL_CLICK="onPivotViewDblClick",Yd.SHOW_TOOLTIP="onPivotViewTooltip",Yd.SHOW_LABEL_TOOLTIP="onPivotViewLabelTooltip";var Zd=Ga("PivotSectionField",La,{init:function(a,b,c){this._super(),this._owner=a,this._section=b,this._dataField=c,this._name=c.name(),this.setCssClass("realpivot-setup-field"),this.$_setDraggable(!0)},destroy:function(){this._dataField=null,this.$_setDraggable(!1),this._super()},name:null,dataField:null,section:null,_createElements:function(){var a=this._dataField.getFieldHeader(),b=U.createElement("span");b.className="realpivot-setup-field",b.innerText=a,this._element.appendChild(b)},$_setDraggable:function(a){var b=this._element;a?(b.draggable=!0,Ib.addEventListener(b,"dragstart",this.$_dragStart.bind(this),!1),Ib.addEventListener(b,"dragend",this.$_dragEnd.bind(this),!1)):(Ib.removeEventListener(b,"dragstart",this.$_dragStart.bind(this),!1),Ib.removeEventListener(b,"dragend",this.$_dragEnd.bind(this),!1))},$_dragStart:function(a){this._owner.setDragField(this)},$_dragEnd:function(a){this._owner.setDragField(null)}}),$d=Ga("PivotSectionLabelField",Zd,{init:function(a,b,c){this._super(a,b,c),Ib.addEventListener(this._element,"click",this.$_click.bind(this),!1)},destroy:function(){Ib.removeEventListener(this._element,"click",this.$_click.bind(this),!1),this._super()},sortDir:Rc.ASCENDING,_createElements:function(){this._super(),this._sortImg=U.createElement("div"),this._setSortDir(this._dataField.sortDir()),this._element.appendChild(this._sortImg)},_setSortDir:function(a){a=a==Rc.DESCENDING?Rc.DESCENDING:Rc.ASCENDING,this._sortDir=a,this._sortImg.className="realpivot-setup-field-sort-"+(a==Rc.ASCENDING?"asc":a==Rc.DESCENDING?"desc":"none")},$_click:function(a){var b=this._sortDir,c=b==Rc.ASCENDING?Rc.DESCENDING:b==Rc.ASCENDING;this._setSortDir(c)}}),_d=Ga("PivotSectionLabelField",Zd,{init:function(a,b,c){this._super(a,b,c),this._expression=c.expression(),this._numberFormat=c.numberFormat(),this.$_assignFrom(this._owner.dataProvider().fieldManager())},destroy:function(){Ib.removeEventListener(this._expressionSelect,"change",this.$_expressionChange.bind(this),!1),this._super()},expression:null,columnSort:!1,rowSort:!1,columnSortDir:Rc.NONE,rowSortDir:Rc.NONE,columnSortConditions:null,rowSortConditions:null,numberFormat:null,_createElements:function(){this._super();var a=this._configButton=U.createElement("button");a.className="realpivot-setup btn-default btn-small realpivot-setup-field-value",a.innerText=RealPivotMessages.setupPanel.valueConfigText,Ib.addEventListener(a,"click",this.$_configButtonClick.bind(this),!1),this._element.appendChild(a);var b=this._expressionSelect=U.createElement("select");b.className="realpivot-setup realpivot-setup-field-value";for(type in Mc){var c=U.createElement("option");c.value=Mc[type],c.text=RealPivotMessages.valueTypeTexts[Mc[type]],b.appendChild(c)}Ib.addEventListener(b,"change",this.$_expressionChange.bind(this),!1),b.value=this._expression,this._element.appendChild(b)},$_assignFrom:function(a){var b=this._dataField.name(),c=a.getValueSort(Lc.COLUMN);c&&c.fieldName==b?(this._columnSort=!0,this._columnSortDir=c.direction,this._columnSortConditions=E(c.conditions)):this._columnSort=!1;var c=a.getValueSort(Lc.ROW);c&&c.fieldName==b?(this._rowSort=!0,this._rowSortDir=c.direction,this._rowSortConditions=E(c.conditions)):this._rowSort=!1},$_expressionChange:function(a){this._expression=a.currentTarget.value},$_configButtonClick:function(a){this._owner._showValueConfigView(this)}}),ae=Ga("PivotSectionLabelField",Zd,{init:function(a,b,c,d){this._super(a,b,c),this._filterItem=d,d&&(this._type=d.type(),this._values=d.values(),this._criteria=d.criteria())},destroy:function(){this._filterItem=null,Ib.removeEventListener(this._filterButton,"click",this.$_filterImgClick.bind(this),!1),this._super()},filterItem:null,type:Oc.ALL,values:null,criteria:null,_createElements:function(){this._super();var a=this._filterButton=U.createElement("div");a.className="realpivot-setup-field-filter",Ib.addEventListener(a,"click",this.$_filterImgClick.bind(this),!1),this._element.appendChild(a)},$_filterImgClick:function(a){this._owner._showFilterView(this)}}),be=Ga("PivotSetupSection",La,{init:function(a,b,c,d){this._super(),this._owner=a,this._type=b,this._countGet=c,this._itemGet=d,this._dragging=!1,this._dragField=null,this._dragAction=md.NONE,this._showCaret=!1,this.setCssClass(b==ld.NONE?"realpivot-setup-section-merged":"realpivot-setup-section"),this.$_setDraggable(!0),this.$_createCaret()},destroy:function(){this._itemGet=null,this.$_setDraggable(!1),this._super()},type:ld.NONE,buildItems:function(){this.$_clearItems();for(var a=this._countGet(),b=0;a>b;b++){var c=this._itemGet(b),d=this.$_createField(c);this.addChild(d)}},removeField:function(a){this.removeChild(a),xa.freeAndNull(a)},$_clearItems:function(){for(var a=this._childs.length;a--;)xa.freeAndNull(this._childs[a]);this._childs=[]},$_createField:function(a){var b;switch(this._type){case ld.COLUMN:case ld.ROW:b=new $d(this._owner,this,a);break;case ld.VALUE:b=new _d(this._owner,this,a);break;case ld.FILTER:b=a instanceof Uc?new ae(this._owner,this,a.field(),a):new ae(this._owner,this,a,null);break;default:b=new Zd(this._owner,this,a)}return b._createElements(),b},$_existField:function(a){for(var b=this._childs.length;b--;)if(this._childs[b].dataField()==a)return!0;return!1},$_getDragPosition:function(a){for(var b=0,c=this._childs.length;c>b;b++){var d=this._childs[b]._element;if(d.offsetTop+ja(d.offsetHeight/2)>a)return b}return-1},$_createCaret:function(){var a=this._dragCaret=U.createElement("div");a.className="realpivot-setup-field-dragcaret";var b=U.createElement("div");b.className="realpivot-setup-field-dragcaret-rarrow",a.appendChild(b);var c=U.createElement("div");c.className="realpivot-setup-field-dragcaret-larrow",a.appendChild(c)},$_drawDragCaret:function(a){-1==a?this._element.appendChild(this._dragCaret):this._element.insertBefore(this._dragCaret,this._childs[a]._element),this._showCaret=!0},$_removeDragCaret:function(){this._showCaret&&(this._element.removeChild(this._dragCaret),this._showCaret=!1)},$_setDraggable:function(a){a?(Ib.addEventListener(U,"dragenter",this.$_dragEnter.bind(this),!1),Ib.addEventListener(U,"dragleave",this.$_dragLeave.bind(this),!1),Ib.addEventListener(U,"dragover",this.$_dragOver.bind(this),!1),Ib.addEventListener(U,"drop",this.$_drop.bind(this),!1)):(Ib.removeEventListener(U,"dragenter",this.$_dragEnter.bind(this),!1),Ib.removeEventListener(U,"dragleave",this.$_dragLeave.bind(this),!1),Ib.removeEventListener(U,"dragover",this.$_dragOver.bind(this),!1),Ib.removeEventListener(U,"drop",this.$_drop.bind(this),!1))},$_checkDragAction:function(a,b){if(a.type()!=ld.NONE&&this._type==ld.NONE)this._dragAction=md.REMOVE;else if(a.type()==ld.NONE&&this._type!=ld.NONE){var c=b.dataField(),d=c.isLabelEnable(),e=c.isValueEnable(),f=c.isFilterEnable();(d&&(this._type==ld.COLUMN||this._type==ld.ROW)||e&&this._type==ld.VALUE||f&&this._type==ld.FILTER)&&(this.$_existField(c)||(this._dragAction=md.ADD))}else this==a&&this._type!=ld.NONE&&(this._dragAction=md.MOVE)},$_dragEnter:function(a){if(!this._dragging&&(a.target==this._element||Ib.isAncestorOf(this._element,a.target))){c("section drag enter section="+this._type);var b=this._owner.dragField();this.$_checkDragAction(b.section(),b),this._offsetY=this._owner._element.offsetTop,this._dragging=!0}},$_dragOver:function(a){if(this._dragging)if(this._dragAction!=md.NONE){if(a.preventDefault(),this._dragAction!=md.REMOVE){var b=this.$_getDragPosition(a.clientY-this._offsetY);b!=this._caretIndex&&(this.$_removeDragCaret(),this.$_drawDragCaret(b),this._caretIndex=b,c("section drag over offset = "+(event.clientY-this._offsetY)+", position = "+b),this._owner._css.cursor="move !important")}}else this._caretIndex=-1},$_dragLeave:function(a){this._dragging&&a.relatedTarget==this._element&&!Ib.isAncestorOf(this._element,a.target)&&(c("section drag leave"),this.$_removeDragCaret(),Ib.removeStyleProperty(this._owner._element,"cursor"),this._dragging=!1,this._dragAction=md.NONE)},$_drop:function(a){if(a.target==this._element||Ib.isAncestorOf(this._element,a.target)){a.preventDefault(),this.$_removeDragCaret();var b=this._owner.dragField();switch(this._dragAction){case md.ADD:var c=this.$_createField(b.dataField());-1==this._caretIndex?this.addChild(c):this.insertChildAt(c,this._caretIndex);break;case md.REMOVE:var d=b.section();d.removeField(b),this._owner.setDragField(null);break;case md.MOVE:this.moveChildTo(b,this._caretIndex)}Ib.removeStyleProperty(this._owner._element,"cursor"),this._dragAction=md.NONE,this._dragging=!1}}}),ce=Ga("PivotSetupFilterSection",be,{init:function(a,b,c,d,e){this._super(a,b,d,e),this._operationGet=c},destroy:function(){this._super()},filterOp:Pc.AND,buildItems:function(){this._super(),this._filterOp=this._operationGet()}}),de=Ga("PivotFilterSetupView",La,{init:function(a,b){this._super(),this.setCssClass("realpivot-filter-setup"),this._owner=a,this._dataProvider=b,this._allCheck=null,this._exprCheck=null,this._itemCheckes=[],this._numberData=!1,this.$_createElements()},destroy:function(){Ib.removeEventListener(this._allCheck,"click",this.$_allCheckClick.bind(this),!1),Ib.removeEventListener(this._exprCheck,"click",this.$_exprCheckClick.bind(this),!1),Ib.removeEventListener(this._exprText,"change",this.$_exprTextChange.bind(this),!1),Ib.removeEventListener(this._applyButton,"click",this.$_applyButtonClick.bind(this),!1),Ib.removeEventListener(this._cancelButton,"click",this.$_cancelButtonClick.bind(this),!1),this.$_clearItems(),this._super()},type:Oc.ALL,values:null,criteria:null,$_createElements:function(){var a,b,c,d,e=RealPivotMessages.setupPanel.filter,f=this._headDiv=U.createElement("div");f.className="realpivot-filter-setup-head",f.innerText=e.headerText,this._element.appendChild(f);var g=U.createElement("div");g.className="realpivot-filter-setup-body";var h=U.createElement("div");h.className="realpivot-filter-setup-box",a=U.createElement("div"),a.className="realpivot-filter-setup-item",c=this._allCheck=U.createElement("input"),c.type="checkbox",c.value="all",Ib.addEventListener(c,"click",this.$_allCheckClick.bind(this),!1),c.className="realpivot-filter-setup-checkbox",a.appendChild(c),b=U.createElement("span"),b.className="realpivot-filter-setup-item",b.innerText=e.allText,a.appendChild(b),h.appendChild(a),g.appendChild(h);var i=U.createElement("div");i.className="realpivot-filter-setup-box",a=U.createElement("div"),c=this._exprCheck=U.createElement("input"),c.type="checkbox",c.value="expr",Ib.addEventListener(c,"click",this.$_exprCheckClick.bind(this),!1),c.className="realpivot-filter-setup-checkbox",a.appendChild(c),d=this._exprText=U.createElement("input"),d.type="text",d.placeholder="value > 0",d.className="realpivot-filter-setup-textbox",Ib.addEventListener(d,"change",this.$_exprTextChange.bind(this),!1),a.appendChild(d),a.className="realpivot-filter-setup-item",i.appendChild(a),g.appendChild(i);var j=this._itemList=U.createElement("div");j.className="realpivot-filter-setup-list-box",g.appendChild(j),this._element.appendChild(g);var k=U.createElement("div");k.className="realpivot-filter-setup-foot";var l=this._applyButton=U.createElement("button");l.className="btn-primary realpivot-setup",l.innerText=e.applyButtonText,Ib.addEventListener(l,"click",this.$_applyButtonClick.bind(this),!1),k.appendChild(l);var m=this._cancelButton=U.createElement("button");m.className="btn-default realpivot-setup",m.innerText=e.cancelButtonText,Ib.addEventListener(m,"click",this.$_cancelButtonClick.bind(this),!1),k.appendChild(m),this._element.appendChild(k)},$_clearItems:function(){for(var a=this._itemCheckes.length;a--;)Ib.removeEventListener(this._itemCheckes[a],"click",this.$_listCheckClick.bind(this),!1);this._itemCheckes=[];for(var b=this._itemList;b.firstChild;)b.removeChild(b.firstChild)},$_clearItemCheck:function(){for(var a=this._itemCheckes.length;a--;)this._itemCheckes[a].checked=!1},$_buildItems:function(a,b){var c,d,e,f=this._itemList,g=a.values(),h=this._dataProvider.getDistinctValues(a.dataField(),[],[],!1,Rc.ASCENDING),i=h.length;if(i>0){"number"==typeof h[0].value&&(this._numberData=!0);for(var j=0;i>j;j++)c=U.createElement("div"),c.className="realpivot-filter-setup-item",d=U.createElement("input"),d.type="checkbox",d.value=h[j].value,d.checked=b&&g.indexOf(h[j].value)>-1,Ib.addEventListener(d,"click",this.$_listCheckClick.bind(this),!1),d.className="realpivot-filter-setup-checkbox",c.appendChild(d),this._itemCheckes.push(d),e=U.createElement("span"),e.className="realpivot-filter-setup-item",e.innerText=h[j].label||h[j].value,c.appendChild(e),f.appendChild(c)}},$_assignValue:function(a){this._headDiv.innerText=RealPivotMessages.setupPanel.filter.headerText+" ("+a.dataField().getFieldHeader()+")";var b=a.type();this._allCheck.checked=!1,this._exprCheck.checked=!1,this._exprText.value="",b==Oc.ALL?this._allCheck.checked=!0:b==Oc.EXPRESSION&&(this._exprCheck.checked=!0,this._exprText.value=a.criteria()),this.$_buildItems(a,b==Oc.ITEMS)},show:function(a){this._owner._showMask(),this._field=a,this.$_clearItems(),this.$_assignValue(a),this._owner._element.appendChild(this._element)},close:function(){this._owner._element.removeChild(this._element),this._owner._hideMask()},$_applyFilter:function(){var a=this._field;if(this._allCheck.checked)a.setType(Oc.ALL);else if(this._exprCheck.checked)a.setType(Oc.EXPRESSION),a.setCriteria(this._exprText.value);else{for(var b=[],c=0,d=this._itemCheckes.length;d>c;c++){var e=this._itemCheckes[c];e.checked&&b.push(this._numberData?parseFloat(e.value):e.value)}b.length>0?(a.setType(Oc.ITEMS),a.setValues(b)):a.setType(Oc.ALL)}},$_allCheckClick:function(a){this._exprCheck.checked=!1,this.$_clearItemCheck()},$_exprCheckClick:function(a){this._allCheck.checked=!1,this.$_clearItemCheck()},$_exprTextChange:function(a){this._allCheck.checked=!1,this._exprCheck.checked=!1},$_listCheckClick:function(a){this._allCheck.checked=!1,this._exprCheck.checked=!1},$_applyButtonClick:function(a){this.$_applyFilter(),this.close()},$_cancelButtonClick:function(a){this.close()}}),ee=Ga("PivotSortSetupView",La,{init:function(a,b){this._super(),this.setCssClass("realpivot-value-setup"),this._owner=a,this._dataProvider=b,this._fieldManager=b.fieldManager(),this._selectes=[],this.$_createElements()},destroy:function(){Ib.removeEventListener(this._colSelect,"change",this.$_colSelectChange.bind(this),!1),Ib.removeEventListener(this._rowSelect,"change",this.$_rowSelectChange.bind(this),!1),Ib.removeEventListener(this._applyButton,"click",this.$_applyButtonClick.bind(this),!1),Ib.removeEventListener(this._cancelButton,"click",this.$_cancelButtonClick.bind(this),!1),this.$_removeItems(),this._dataProvider=null,this._fieldManager=null,this._owner=null,this._super()},$_createElements:function(){var a,b,c,d,e,f=RealPivotMessages.setupPanel.value,g=this._headDiv=U.createElement("div");g.className="realpivot-value-setup-head",g.innerText=f.headerText,this._element.appendChild(g);var h=U.createElement("div");h.className="realpivot-value-setup-body",d=U.createElement("div"),d.className="realpivot-value-setup-group",a=U.createElement("span"),a.className="realpivot-setup realpivot-value-setup-group",a.innerText=f.columnGroupText,d.appendChild(a),this._colSelect=b=U.createElement("select"),b.className="realpivot-setup",Ib.createOptions(b,[!1,!0],[f.selectNoConfigText,f.selectConfigText]),Ib.addEventListener(b,"change",this.$_colSelectChange.bind(this),!1),d.appendChild(b),this._colList=e=U.createElement("div"),e.className="realpivot-value-setup-group-body",e.style.display="none",d.appendChild(e),h.appendChild(d),d=U.createElement("div"),d.className="realpivot-value-setup-group",a=U.createElement("span"),a.className="realpivot-setup realpivot-value-setup-group",a.innerText=f.rowGroupText,d.appendChild(a),this._rowSelect=b=U.createElement("select"),b.className="realpivot-setup",Ib.createOptions(b,[!1,!0],[f.selectNoConfigText,f.selectConfigText]),b.value=!1,Ib.addEventListener(b,"change",this.$_rowSelectChange.bind(this),!1),d.appendChild(b),this._rowList=e=U.createElement("div"),e.className="realpivot-value-setup-group-body",e.style.display="none",d.appendChild(e),h.appendChild(d),d=U.createElement("div"),d.className="realpivot-value-setup-group",a=U.createElement("span"),a.className="realpivot-setup realpivot-value-setup-group",a.innerText=f.formatGroupText,d.appendChild(a),b=this._formatSelect=U.createElement("select"),b.className="realpivot-setup",numberFormats=RealPivotMessages.numberFormatList;for(var i=0,j=numberFormats.length;j>i;i++)c=U.createElement("option"),numberFormats[i].value&&(c.value=numberFormats[i].value),c.text=numberFormats[i].labelText,b.appendChild(c);d.appendChild(b),h.appendChild(d),this._element.appendChild(h);var k=U.createElement("div");k.className="realpivot-value-setup-foot";var l=this._applyButton=U.createElement("button");l.className="btn-primary realpivot-setup",l.innerText=RealPivotMessages.setupPanel.applyButtonText,Ib.addEventListener(l,"click",this.$_applyButtonClick.bind(this),!1),k.appendChild(l);var m=this._cancelButton=U.createElement("button");m.className="btn-default realpivot-setup",m.innerText=RealPivotMessages.setupPanel.cancelButtonText,Ib.addEventListener(m,"click",this.$_cancelButtonClick.bind(this),!1),k.appendChild(m),this._element.appendChild(k)},show:function(a){this._owner._showMask(),this._field=a,this.$_assignValue(a),this._owner._element.appendChild(this._element)},close:function(){this._owner._element.removeChild(this._element),this._owner._hideMask()},$_initSelectOptions:function(a){for(var b=a.options.length;--b>1;)a.remove(b);if(0==a.options.length){var c=RealPivotMessages.setupPanel.value;Ib.createOptions(a,a.$$parent?["",ee.SUM_OPTION_VALUE]:[ee.SUM_OPTION_VALUE],a.$$parent?[c.emptyUpperOptionText,c.summaryOptionText]:[c.summaryOptionText])}},$_buildSelectOptions:function(a,b,c,d){for(var e,f=this._dataProvider.getDistinctValues(b,c,d,!1,Rc.ASCENDING),g=0,h=f.length;h>g;g++)e=U.createElement("option"),e.value=f[g].value,e.text=f[g].label||f[g].value,a.appendChild(e)},$_removeItems:function(){for(var a=this._selectes.length;a--;)Ib.removeEventListener(this._selectes[a],"change",this.$_valueSelectChange.bind(this),!1),this._selectes[a]=null;this._selectes=[],Ib.clearChildren(this._colList),Ib.clearChildren(this._rowList)},$_buildItems:function(a,b,c,d){var e,f,g,h,i,j=[],k=RealPivotMessages.setupPanel.value;e=U.createElement("div"),e.className="realpivot-value-setup-item",f=U.createElement("span"),f.className="realpivot-value-setup-item",f.innerText=k.sortDirectionText,e.appendChild(f),g=U.createElement("select"),g.className="realpivot-setup realpivot-value-setup-item",Ib.createOptions(g,[Rc.ASCENDING,Rc.DESCENDING],[k.sortAscendingText,k.sortDescendingText]),this._selectes.push(g);var l=a==this._colList;l?this._colSortSelect=g:this._rowSortSelect=g,e.appendChild(g),a.appendChild(e);for(var m=0,n=b.length;n>m;m++)e=U.createElement("div"),e.className="realpivot-value-setup-item",i=b[m].dataField(),f=U.createElement("span"),f.className="realpivot-value-setup-item",f.innerText=i.getFieldHeader(),e.appendChild(f),g=U.createElement("select"),g.className="realpivot-setup realpivot-value-setup-item",g.$$field=i,g.$$parent=h,Ib.addEventListener(g,"change",this.$_valueSelectChange.bind(this),!1),this._selectes.push(g),this.$_initSelectOptions(g),c&&c[m]?(this.$_buildSelectOptions(g,i,j,c),g.value=c[m]):0==m&&(this.$_buildSelectOptions(g,i,j,[]),g.value=ee.SUM_OPTION_VALUE),0==m&&(l?this._colFirstSelect=g:this._rowFirstSelect=g),h=g,e.appendChild(g),a.appendChild(e),j.push(i)},$_assignValue:function(a){var b=a.dataField(),c=this._owner._columnSection._childs,d=this._owner._rowSection._childs;if(this._headDiv.innerText=RealPivotMessages.setupPanel.value.headerText+" ("+b.getFieldHeader()+")",this.$_removeItems(),a.isColumnSort()){this._colSelect.value="true";for(var e=a.columnSortConditions(),f=[],g=0,h=e.length;h>g;g++)f.push(e[g].value);this.$_buildItems(this._colList,d,f),this._colSortSelect.value=a.columnSortDir()}else this._colSelect.value="false",this.$_buildItems(this._colList,d,null);if(Ib.fireEvent(this._colSelect,"change"),a.isRowSort()){this._rowSelect.value="true";for(var e=a.rowSortConditions(),f=[],g=0,h=e.length;h>g;g++)f.push(e[g].value);this.$_buildItems(this._rowList,c,f),this._rowSortSelect.value=a.rowSortDir()}else this._rowSelect.value="false",this.$_buildItems(this._rowList,c,null);Ib.fireEvent(this._rowSelect,"change");var i=a.numberFormat();i&&(this._formatSelect.value=i,this._formatSelect.value||(Ib.createOptions(this._formatSelect,[i],[RealPivotMessages.userDefinedFormatText+" "+i]),this._formatSelect.value=i))},$_makeCondition:function(a){for(var b=this._selectes.indexOf(a),c=[],d=b,e=this._selectes.length;e>d;d++){var a=this._selectes[d];if(""==a.value||a.value==ee.SUM_OPTION_VALUE||d!=b&&a.$$parent!=this._selectes[d-1])break;var f={};f.name=a.$$field.name(),f.value=a.value,c.push(f)}return c},$_applyValueConfig:function(){var a=this._field,b="true"==this._colSelect.value;if(a.setColumnSort(b),b){a.setColumnSortDir(this._colSortSelect.value);var c=this.$_makeCondition(this._colFirstSelect);a.setColumnSortConditions(c)}if(b="true"==this._rowSelect.value,a.setRowSort(b),b){a.setRowSortDir(this._rowSortSelect.value);var c=this.$_makeCondition(this._rowFirstSelect);a.setRowSortConditions(c)}var d=this._formatSelect.value;d=d?d:null,a.setNumberFormat(d)},$_colSelectChange:function(a){var b="true"==this._colSelect.value;this._colList.style.display=b?"":"none",this._colSort=b},$_rowSelectChange:function(a){var b="true"==this._rowSelect.value;this._rowList.style.display=b?"":"none",this._rowSort=b},$_valueSelectChange:function(a){var b,c=a.currentTarget,d=this._selectes.indexOf(c);if(d<this._selectes.length-1&&this._selectes[d+1].$$parent==c&&(b=this._selectes[d+1]),b){var e=c.value&&c.value!=ee.SUM_OPTION_VALUE?ee.SUM_OPTION_VALUE:"";if(b.value!=e&&(b.value=e,Ib.fireEvent(b,"change")),this.$_initSelectOptions(b),c.value&&c.value!=ee.SUM_OPTION_VALUE){for(var f=[],g=[];c;)f.splice(0,0,c.$$field),g.splice(0,0,c.value),c=c.$$parent;this.$_buildSelectOptions(b,b.$$field,f,g)}}},$_applyButtonClick:function(a){this.$_applyValueConfig(),this.close()},$_cancelButtonClick:function(a){this.close()}},{SUM_OPTION_VALUE:"$$$SUM"}),fe=Ga("PivotSetupView",La,{init:function(a,b){this._super(),this._container=a,this._pivotView=b,this._dataProvider=this._pivotView.dataSource(),this._columnSection=null,this._rowSection=null,this._valueSection=null,this._filterSection=null,this._fieldSection=null,this._applyButton=null,this._cancelButton=null,this.$_createElements(),this._maskView=new Pd,this.addChild(this._maskView),this._filterView=new de(this,this._dataProvider),this._valueConfigView=new ee(this,this._dataProvider),this._active=!1,this._dragField=null},destroy:function(){this._container=null,this._pivotView=null,this._active&&this.close(),Ib.addEventListener(this._applyButton,"click",this.$_applyButtonClick.bind(this),!1),Ib.addEventListener(this._cancelButton,"click",this.$_cancelButtonClick.bind(this),!1),xa.freeAndNull(this._filterView),xa.freeAndNull(this._valueConfigView),this._super()},dragField:null,dataProvider:function(){return this._dataProvider},isActive:function(){return this._active},show:function(a,b){var c=this._element;if(this._filterOpSelect.value=this._dataProvider.filterManager().operation(),this._columnSection.buildItems(),this._valueSection.buildItems(),this._rowSection.buildItems(),this._filterSection.buildItems(),this._fieldSection.buildItems(),this._pivotView.showMask(),this._container.appendChild(c),arguments.length<1){a=ma(0,ja((this._pivotView.width()-c.offsetWidth)/2)),b=ma(0,ja((this._pivotView.height()-c.offsetHeight)/2));var d=this._container.style.position;"fixed"!=d&&"absolute"!=d&&(a+=this._container.offsetLeft,b+=this._container.offsetTop)}c.style.left=a+"px",c.style.top=b+"px",this._active=!0},close:function(){var a=this._element;a&&a.parentNode&&(this._container.removeChild(a),this._pivotView.hideMask(),this._active=!1)},_showFilterView:function(a){this._filterView.show(a)},_showValueConfigView:function(a){this._valueConfigView.show(a)},_showMask:function(){this._maskView.show()},_hideMask:function(){this._maskView.hide()},$_createElements:function(a){var b=this._dataProvider,c=b.fieldManager(),d=b.filterManager(),e=this._element=U.createElement("div");e.className="realpivot-setup",e.style.position="absolute";var f=U.createElement("div");f.className="realpivot-setup-head",f.innerText=RealPivotMessages.setupPanel.headerText,e.appendChild(f);var g=U.createElement("div");g.className="realpivot-setup-table";var h=U.createElement("div");h.className="realpivot-setup-row";var i=U.createElement("div");i.className="realpivot-setup-cell";var j=U.createElement("div");j.className="realpivot-setup-section-title",j.innerText=RealPivotMessages.setupPanel.fieldSectionText,i.appendChild(j),this._fieldSection=new be(this,ld.NONE,c.fieldCount.bind(c),c.getField.bind(c)),this.addChild(this._fieldSection,i),h.appendChild(i);var k=U.createElement("div");k.className="realpivot-setup-cell";var l=U.createElement("div");l.className="realpivot-setup-section-title",l.innerText=RealPivotMessages.setupPanel.columnSectionText,k.appendChild(l),this._columnSection=new be(this,ld.COLUMN,c.columnCount.bind(c),c.getColumn.bind(c)),
this.addChild(this._columnSection,k);var m=U.createElement("div");m.className="realpivot-setup-section-title",m.innerText=RealPivotMessages.setupPanel.valueSectionText,k.appendChild(m),this._valueSection=new be(this,ld.VALUE,c.valueCount.bind(c),c.getValue.bind(c)),this.addChild(this._valueSection,k),h.appendChild(k);var n=U.createElement("div");n.className="realpivot-setup-cell";var o=U.createElement("div");o.className="realpivot-setup-section-title",o.innerText=RealPivotMessages.setupPanel.rowSectionText,n.appendChild(o),this._rowSection=new be(this,ld.ROW,c.rowCount.bind(c),c.getRow.bind(c)),this.addChild(this._rowSection,n);var p=U.createElement("div");p.className="realpivot-setup-section-title",p.innerText=RealPivotMessages.setupPanel.filterSectionText;var q=this._filterOpSelect=U.createElement("select");q.className="realpivot-setup realpivot-setup-field-filter";var r=U.createElement("option");r.value="and",r.innerText="AND",q.appendChild(r),r=U.createElement("option"),r.value="or",r.innerText="OR",q.appendChild(r),p.appendChild(q),n.appendChild(p),this._filterSection=new ce(this,ld.FILTER,d.operation.bind(d),d.count.bind(d),d.getFilter.bind(d)),this.addChild(this._filterSection,n),h.appendChild(n),g.appendChild(h),e.appendChild(g);var s=U.createElement("div");s.className="realpivot-setup-foot";var t=this._applyButton=U.createElement("button");t.className="btn-primary realpivot-setup",t.innerText=RealPivotMessages.setupPanel.applyButtonText,Ib.addEventListener(t,"click",this.$_applyButtonClick.bind(this),!1),s.appendChild(t);var u=this._cancelButton=U.createElement("button");u.className="btn-default realpivot-setup",u.innerText=RealPivotMessages.setupPanel.cancelButtonText,Ib.addEventListener(u,"click",this.$_cancelButtonClick.bind(this),!1),s.appendChild(u),e.appendChild(s)},$_applySetup:function(){var a,b,c,d=[],e=[],f=[],g=[],h=null,i=null;for(a=0,b=this._columnSection.childCount();b>a;a++)c=this._columnSection.getChild(a),d.push({name:c.name(),direction:c.sortDir()});for(a=0,b=this._rowSection.childCount();b>a;a++)c=this._rowSection.getChild(a),e.push({name:c.name(),direction:c.sortDir()});for(a=0,b=this._valueSection.childCount();b>a;a++)c=this._valueSection.getChild(a),c.dataField().setNumberFormat(c.numberFormat()),f.push({name:c.name(),expression:c.expression()}),c.isColumnSort()&&!h&&(h={},h.method=Qc.VALUE,h.fieldName=c.name(),h.direction=c.columnSortDir(),h.conditions=c.columnSortConditions()),c.isRowSort()&&!i&&(i={},i.method=Qc.VALUE,i.fieldName=c.name(),i.direction=c.rowSortDir(),i.conditions=c.rowSortConditions());for(a=0,b=this._filterSection.childCount();b>a;a++){c=this._filterSection.getChild(a);var j=c.type(),k={name:c.name()};j==Oc.EXPRESSION?k.criteria=c.criteria():j==Oc.ITEMS?k.values=c.values():k.values=Oc.ALL,g.push(k)}this._dataProvider.setPivotFields({columns:d,rows:e,values:f,filter:{operation:this._filterOpSelect.value,conditions:g},sort:{column:h,row:i}})},$_applyButtonClick:function(a){this.$_applySetup(),this.close()},$_cancelButtonClick:function(a){this.close()}}),ge=function(a){this.colIndex=0,this.rowIndex=0,this.colSpan=0,this.rowSpan=0,this.valueType="s",this.cell=a},he=Ga("ExportCellArray",null,{init:function(a,b){this._super(),this._grid=a,this._columnCells=[],this._rowCells=[],this._dataCells=[],this.$_parse(a,b)},destroy:function(){this._grid=null,this._rows=null,this._super()},grid:function(){return this._grid},colCount:function(){return this._columnCells.length&&this._columnCells[0].length},rowHeaderCount:function(){return this._rowCells.length&&this._rowCells[0].length},columnHeaderCount:function(){return this._columnCells.length},dataRowCount:function(){return this._dataCells.length},getColumnHeader:function(a,b){return!this._columnCells[a],this._columnCells[a][b]},getRowHeader:function(a,b){return!this._rowCells[a],this._rowCells[a][b]},getCell:function(a,b){return!this._dataCells[a],this._dataCells[a][b]},setColumnHeader:function(a,b,c){!this._columnCells[a],this._columnCells[a][b]=c},setRowHeader:function(a,b,c){!this._rowCells[a],this._rowCells[a][b]=c},setCell:function(a,b,c){!this._dataCells[a],this._dataCells[a][b]=c},$_parse:function(a,b){var c,d=a.getColumnDepth(),e=a.getRowDepth(),f=b?a.getLeafRowCount():a.getVisibleRowCount(),g=b?a.getLeafColumnCount():a.getVisibleColumnCount();for(this._columnCells=[],c=d;c--;)this._columnCells.push([]);for(this._rowCells=[],this._dataCells=[],c=f;c--;)this._rowCells.push([]),this._dataCells.push([]);this.$_parseColumnCells(a,this._columnCells,a.valueLabelVisible()?d-1:d,b),this.$_parseRowCells(a,this._rowCells,e,b),this.$_parseDataCells(a,this._dataCells,f,g,b)},$_parseColumnCells:function(a,b,c,d){for(var e=a.columnView().rootElement().getLowers(),f=0,g=0,h=e.length;h>g;g++){var i=e[g];f+=this.$_addColumnGroup(b,i,f,0,c,d)}},$_parseRowCells:function(a,b,c,d){for(var e=a.rowView().rootElement().getLowers(),f=0,g=0,h=e.length;h>g;g++){var i=e[g];f+=this.$_addRowGroup(b,i,0,f,c,d)}},$_parseDataCells:function(a,b,c,d,e){for(var f,g,h,i=r=0;r<c;){if(f=g=0,h=a.bodyView().getCells(i,0),e||h.rowLabel().isVisible()){for(;d>g;)h=a.bodyView().getCells(i,f),(e||h.columnLabel().isVisible())&&(this.$_addCell(b,g,r,1,1,h),g++),f++;r++}i++}},$_addCell:function(a,b,c,d,e,f){var g,h,i;for(g=0;e>g;g++)for(h=0;d>h;h++)i=new ge(f),i.colIndex=h,i.colSpan=d,i.rowIndex=g,i.rowSpan=e,a[c+g][b+h]=i},$_addColumnGroup:function(a,b,c,d,e,f){var g=0,h=b instanceof Id?e-b.level():1;if(f||!(b instanceof Dd)||b.expanded)for(var i,j=f?b.getLowers():b.getVisibleLowers(!0,!0),k=c,l=d+h,m=0,n=j.length;n>m;m++){var o=j[m];if(o.hasLower())i=this.$_addColumnGroup(a,o,k,l,e,f),k+=i,g+=i;else{var p=o instanceof Id&&!o.isValueLabel()?e-l:1;this.$_addCell(a,k,l,1,p,o),g++,k++}}return 0==g&&(g=1),this.$_addCell(a,c,d,g,h,b),g},$_addRowGroup:function(a,b,c,d,e,f){var g=0,h=b instanceof Id?e-b.level():1;if(f||!(b instanceof Dd)||b.expanded)for(var i,j=f?b.getLowers():b.getVisibleLowers(!0,!0),k=d,l=c+h,m=0,n=j.length;n>m;m++){var o=j[m];if(o.hasLower())i=this.$_addRowGroup(a,o,l,k,e,f),k+=i,g+=i;else{var p=o instanceof Id&&!o.isValueLabel()?e-l:1;this.$_addCell(a,l,k,p,1,j[m]),g++,k++}}return 0==g&&(g=1),this.$_addCell(a,c,d,h,g,b),g}}),ie=7,je=Ga("DocumentTitle",null,{init:function(a){"string"==typeof a?(this._message=a,this._visible=!0,this._spaceTop=0,this._spaceBottom=0,this._height=-1):"object"==typeof a&&(this._message=a.message,this._visible=a.hasOwnProperty("visible")?a.visible:!0,this._spaceTop=a.spaceTop?isNaN(parseInt(a.spaceTop))?0:parseInt(a.spaceTop):0,this._spaceBottom=a.spaceBottom?isNaN(parseInt(a.spaceBottom))?0:parseInt(a.spaceBottom):0,this._height=a.height?isNaN(parseInt(a.height))?-1:parseInt(a.height):-1)},proxy:function(){var a={message:this._message,visible:this._visible};return this._styles&&(a.styles=this._styles.toProxy()),a},message:null,visible:!0,spaceTop:0,spaceBottom:0,height:-1}),ke=Ga("GridExportOptions",null,{init:function(a){this._super(),this._datetimeWriter=null,a&&this.assign(a)},target:"remote",url:void 0,fileName:null,expandAll:!0,documentTitle:null,documentSubtitle:null,documentTail:null,numberFormat:void 0,showProgress:!1,progressMessage:null,applyCssStyle:!0,done:null,start:0,count:-1,setFileName:function(a){a=A(a),a&&a.indexOf(".")<0&&(a+=".xlsx"),this._fileName=a},setNumberFormat:function(a){a!=this._numberFormat&&(this._numberFormat=a)},setDocumentTitle:function(a){this._documentTitle=a?new je(a):null},setDocumentSubtitle:function(a){this._documentSubtitle=a?new je(a):null},setDocumentTail:function(a){this._documentTail=a?new je(a):null}}),le=Ga("GridExcelExporter",null,{init:function(){this._super()},destroy:function(){},"export":function(a,b){function d(a){var d=(new Date).getTime();f=d-f,c("E X C E L: buildBook "+f),f=d;var g=e.book.createParts();d=(new Date).getTime(),f=d-f,c("E X C E L: createParts "+f),f=d;var h=[];for(var i in g)h.push({key:i,body:g[i]});a.$_export(h,b),d=(new Date).getTime(),f=d-f,c("E X C E L: zip "+f),f=d,b._done&&"function"==typeof b._done&&b._done(),a.destroy&&a.destroy(),e.book&&e.book.destroy&&e.book.destroy(),e.colArr&&(e.colArr=null),e=null}if(a){b=b instanceof ke?b:new ke(b);var e={grid:a,book:new Hb,options:b,colArr:new he(a,b.isExpandAll()),numberFormatId:0,textFormatId:49,showProgress:b.isShowProgress(),progressMessage:b.progressMessage()||"Exporting...",progressMax:0,prepareProgress:10,setProgress:function(b){a.setExportProgress(this.progressMax,b+this.prepareProgress,this.progressMessage)}};e.colCount=e.colArr.colCount()+e.colArr.rowHeaderCount();var f=(new Date).getTime(),g=this;this.$_buildBook(e,function(){d(g)})}},$_buildBook:function(a,b){var c=a.grid;a.start=a.options.start()>0?a.options.start():0;var d=a.options.count(),e=a.colArr.dataRowCount();a.count>0?a.start+d>e?e-a.start:d:e-a.start,a.last=a.start+e,this.$_prepareFormats(a),this.$_buildColumns(a);for(var f=0,g=0,h=0;h<a.colArr.columnHeaderCount();h++)for(var i=0;i<a.colArr.colCount();i++){a.colArr.getColumnHeader(h,i)}if(f+=this.$_buildDocumentTitle(a,f,g),f+=this.$_buildHeader(a,f,g),a.showProgress){c.beginExportProgress(a.progressMessage),a.progressMax=e+a.prepareProgress,a.progressStep=Math.max(ja(e/10),1),a.setProgress(0);var j=this;f+=this.$_buildItemsAsync(a,f,g,function(){f=a.row,f+=j.$_buildDocumentTail(a,f,g),c.endExportProgress(),b()})}else f+=this.$_buildItems(a,f,g),f+=this.$_buildDocumentTail(a,f,g),b()},$_prepareFormats:function(a){var b=a.options,c=a.book,d=b.numberFormat();"number"==typeof d||ja(d)>0?a.numberFormatId=ja(d):d&&(a.numberFormatId=c.addNumberFormat(ExcelFormatConverter.convertNumberFormat(d)))},$_createStyles:function(a,b,c,d,e,f){var g;if(d&&d.length>0&&(g=ExcelFormatConverter.convertNumberFormat(d)),g){e&&(g='"'+e+'"'+g),f&&(g=g+'"'+f+'"');var h=a.addNumberFormat(g)}var i=h||c?new Db:null;if(h&&(i.formatId=h),c){var j=new Bb,k=getComputedStyle(b._element),l=k.backgroundImage,m="linear-gradient(",n=l.indexOf(m);if(n>-1){j.gradient="linear";var o,p,q=xa.splitEscape(l.slice(n+m.length,l.length-1));q.length>2?(o=new Jb(q[1]),p=new Jb(q[2]),deg=parseInt(q[0])):(o=new Jb(q[0]),p=new Jb(q[1]),deg=180),j.color=o.toColorHex(),j.color2=p.toColorHex(),j.tint=1-o._a,j.degree=deg+270+""}else{j.patternType="solid";var r=new Jb(k.backgroundColor);j.color=r.toColorHex(),j.tint=1-r._a}a.addFill(j);var s=new Cb;s.right=new Pb(k.borderRight),s.bottom=new Pb(k.borderBottom),s.left=new Pb(k.borderLeft),s.top=new Pb(k.borderTop),a.addBorder(s),font=new Ab,font.name=k.fontFamily;var t=parseInt(k.fontSize);switch(k.fontSize.indexOf("pt")>0?t=ka(t/.75):k.fontSize.indexOf("em")>0?t=ka(12*t/.75):k.fontSize.indexOf("%")>0&&(t=ka(t/100*12/.75)),font.size=72*t/96,font.color=new Jb(k.color).toColorHex(),font.bold="bold"==k.fontWeight||parseInt(k.fontWeight)>600,font.italic="italic"==k.fontStyle,a.addFont(font),i.fill=j,i.border=s,i.font=font,k.justifyContent){case"center":i.horzAlign=Db.ALIGN_CENTER;break;case"flex-end":i.horzAlign=Db.ALIGN_FAR;break;default:i.horzAlign=Db.ALIGN_NEAR}switch(k.alignItems){case"center":i.vertAlign=Db.VALIGN_CENTER;break;case"flex-end":i.vertAlign=Db.VALIGN_FAR;break;default:i.vertAlign=Db.VALIGN_NEAR}}return i},$_addStyle:function(a,b,c,d,e,f){var g=this.$_createStyles(a,b,c,d,e,f);return a.addStyle(g),g},$_buildColumns:function(a){var b,c,d=a.grid,e=(a.options,a.book,a.colArr),f=1,g=[],h=e.rowHeaderCount();for(b=0;h>b;b++)c=new Fb,c.index=f++,c.width=ka(d.rowLevelWidth(b)/ie),g.push(c);var i=e.colCount();for(b=0;i>b;b++){var j=e.getCell(0,b);c=new Fb,c.index=f++,c.width=ka(j.cell.width()/ie),g.push(c)}a.book.sheet().setColumns(g)},$_buildDocumentTitle:function(a,b,c){var d,e,f=(a.grid,a.options),g=a.book,h=g.sheet(),i=a.colCount,j=b;if((e=f.documentTitle())&&e._visible){j+=e.spaceTop();var k=e.message();h.addText(j,c,k,null,e.height()),h.addMerge(j,c,1,i);for(var l=1;i>l;l++)h.addBlank(j,c+l,d);j++,j+=e.spaceBottom()}if((e=f.documentSubtitle())&&e._visible){j+=e.spaceTop();var k=e.message();h.addText(j,c,k,null,e.height()),h.addMerge(j,c,1,i);for(var l=1;i>l;l++)h.addBlank(j,c+l,d);j++,j+=e.spaceBottom()}return j-b},$_buildDocumentTail:function(a,b,c){var d,e,f=(a.grid,a.options),g=a.book,h=g.sheet(),i=a.colCount,j=b;if((e=f.documentTail())&&e._visible){j+=e.spaceTop();var k=e.message();h.addText(j,c,k,d,e.height()),h.addMerge(j,c,1,i);for(var l=1;i>l;l++)h.addBlank(j,c+l,d);j++,j+=e.spaceBottom()}return j-b},$_buildHeader:function(a,b,c){var d,e,f,g,h,i,j,k,l=a.grid,m=a.book,n=m.sheet(),o=a.colArr,p=o.colCount(),q=o.columnHeaderCount(),r=o.rowHeaderCount(),s=a.options.isApplyCssStyle();for(n.addMerge(b,c,q,r),j=this.$_addStyle(m,l.headerView().getTitleCell(),s),d=0;q>d;d++)for(e=0;r>e;e++)n.addBlank(b+d,c+e,j);for(c+=r,d=0;q>d;d++)for(f=b+d,e=0;p>e;e++)h=o.getColumnHeader(d,e),i=h.cell,j=this.$_addStyle(m,i,s),g=e+c,h.colIndex>0||h.rowIndex>0?n.addBlank(f,g,j):(k=xa.removeTags(i.text()),k&&k.match(ya)&&(j.wrapText=!0),n.addText(f,g,k,j),(h.rowSpan>1||h.colSpan>1)&&n.addMerge(f,g,h.rowSpan,h.colSpan));return q},$_buildRow:function(a,b,c,d){var e,f,g,h,i,j,k,l,m=(a.grid,a.book),n=m.sheet(),o=a.colArr,p=o.colCount(),q=o.rowHeaderCount(),r=a.options.isApplyCssStyle();for(e=0;q>e;e++)if(g=o.getRowHeader(d,e),h=g.cell,f=e+c,j=this.$_addStyle(m,h,r),g.colIndex>0||g.rowIndex>0)n.addBlank(b,f,j);else{var l=h.text();l&&l.match(ya)&&(j.wrapText=!0),n.addText(b,f,l,j),(g.rowSpan>1||g.colSpan>1)&&n.addMerge(b,f,g.rowSpan,g.colSpan)}for(c+=q,e=0;p>e;e++)if(g=o.getCell(d,e),h=g.cell,f=e+c,g.colIndex>0||g.rowIndex>0)j=this.$_addStyle(m,h,r),n.addBlank(b,f,j);else if(i=h.valueField(),j=this.$_addStyle(m,h,r,i.numberFormat(),i.prefix(),i.suffix()),"number"==h.valueField().getDataType())k=h.value().value,n.addNumber(b,f,k,j);else{var l=h.text();n.addText(b,f,l,j)}return 1},$_buildItems:function(a,b,c){for(var d=(a.grid,b),e=a.start;e<a.last;e++)d+=this.$_buildRow(a,d,c,e);return d-b},$_buildItemsAsync:function(a,b,c,d){var e=a.options.isIndicatorDataRow(a.grid);try{this.$_buildItemAsync(a,b,c,e,a.start,d)}catch(f){throw a.grid.endExportProgress(),f}},$_buildItemAsync:function(a,b,c,d,e,f){for(var g=e+Math.min(a.progressStep,a.last-e),h=e;g>h;h++)b+=this.$_buildRow(a,b,c,h);if(a.row=b,a.setProgress(g-a.start),e=g,e>=a.last)f();else{var i=this;setTimeout(function(){i.$_buildItemAsync(a,b,c,d,e,f)},0)}},$_export:function(a,b){function c(a){if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,e);else if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(a,e);else{var b=document.createElement("a");document.body.appendChild(b);var c=URL.createObjectURL(a);b.href=c,b.download=e,b.click(),document.body.removeChild(b)}}function d(a){var c=b.url(),d='<form name="tempForm" action="'+c+'" method="post">';d+='<input type="hidden" name="fileName" value = "'+e+'"/>',d+='<input type="hidden" name="data" value = "'+a+'"/>',d+='<input id="submitBtn" type="submit"/>',d+="</form>";var f=document.createElement("div");f.innerHTML=d,document.body.appendChild(f),document.getElementById("submitBtn").click(),document.body.removeChild(f)}var e=b.fileName()||"realgrid.xlsx",f="local"==b.target();if(JSZip.support.blob||!f){for(var g=(navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&navigator.userAgent.toLowerCase().indexOf("edge/")<0,new JSZip),h=0;h<a.length;h++){var i=a[h].body;i=i.replace(/ xmlns=""/g,"").replace(/xmlns=""/g,""),g.file(a[h].key,i)}f?g.generateAsync?g.generateAsync({type:"blob",compression:"DEFLATE"}).then(function(a){c(a)}):c(g.generate({type:"blob",compression:"DEFLATE"})):g.generateAsync?g.generateAsync({type:"base64",compression:"DEFLATE"}).then(function(a){d(a)}):d(g.generate({type:"base64",compression:"DEFLATE"}))}else alert("not supported on this browser")}}),me="dkdl";(function(){return""})();return Ca()?{PivotDataProvider:Xc,PivotView:Yd,PivotSetupView:fe,getVersion:W}:null}(this),RealPivot=function(a){"string"==typeof a&&(a=document.getElementById(a)),this._provider=new RealPivotClass.PivotDataProvider,this._view=new RealPivotClass.PivotView(a),this._view.setDataSource(this._provider),this._view.addListener(this),this._setupView=new RealPivotClass.PivotSetupView(a,this._view),this._view.setSetupView(this._setupView),this.destroy=function(){this._setupView.destroy(),this._setupView=null,this._view.destroy(),this._view=null,this._provider.destroy(),this._provider=null},this.getVersion=function(){return RealPivotClass.getVersion()},this.setDataProvider=function(a){this._provider.setDataSource(a)},this.setFieldMapping=function(a){this._provider.setFieldMapping(a)},this.setPivotFields=function(a){this._provider.setPivotFields(a)},this.getOptions=function(){return this._view.getOptions()},this.setOptions=function(a){this._view.setOptions(a)},this.getDisplayOptions=function(){return this._view.getDisplayOptions()},this.setDisplayOptions=function(a){this._view.setDisplayOptions(a)},this.getSummaryOptions=function(){return this._view.getSummaryOptions()},this.setSummaryOptions=function(a){this._view.setSummaryOptions(a)},this.getHeaderOptions=function(){return this._view.getHeaderOptions()},this.setHeaderOptions=function(a){this._view.setHeaderOptions(a)},this.buildPivot=function(){this._provider.buildPivotData()},this.drawView=function(){this._view.draw()},this.showSetupView=function(a,b){this._setupView.show(a,b)},this.resetSize=function(){this._view.resetSize()},this.sort=function(a){this._view.sort(a)},this.filter=function(a){this._provider.filter(a),this._provider.buildPivotData()},this.exportGrid=function(a){this._view["export"](a)},this.setContextMenu=function(a){this._view.setContextMenu(a)},this.getContextMenu=function(a){return this._view.getContextMenu()},this.onPivotViewClick=function(a,b,c){this.onClick&&this.onClick(a,b,c)},this.onPivotViewDblClick=function(a,b,c){this.onDblClick&&this.onDblClick(a,b,c)},this.onPivotViewTooltip=function(a,b,c){return this.onTooltip?this.onTooltip(a,b,c):c},this.onPivotViewLabelTooltip=function(a,b,c){return this.onLabelTooltip?this.onLabelTooltip(a,b,c):c}};